global proc shelf_CK_TOOLS () {
    global string $gBuffStr;
    global string $gBuffStr0;
    global string $gBuffStr1;


    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "List the objects in the scene" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "Outliner" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "Outl" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.2 
        -image "menuIconWindow.png" 
        -image1 "menuIconWindow.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "OutlinerWindow" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "Edit the attributes of the selected object(s)" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "Attribute Spread Sheet" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "SpSh" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.25 
        -image "menuIconWindow.png" 
        -image1 "menuIconWindow.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "SpreadSheetEditor" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "Namespace Editor" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "Namespace Editor" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "NE" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.25 
        -image "menuIconWindow.png" 
        -image1 "menuIconWindow.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "NamespaceEditor" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "Texture coordinate mapping view" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "UV Texture Editor" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "UTE" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.25 
        -image "menuIconWindow.png" 
        -image1 "menuIconWindow.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "TextureViewWindow" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "Edit animation curves" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "Graph Editor" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "GE" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.25 
        -image "menuIconWindow.png" 
        -image1 "menuIconWindow.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "GraphEditor" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "Display and edit connections in shading networks" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "Hypershade" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "Hshd" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.25 
        -image "menuIconWindow.png" 
        -image1 "menuIconWindow.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "HypershadeWindow" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "#encoding:utf-8\n#material converter\nimport maya.cmds as mc\nimport pymel.core as pm\nimport sys\nimport json\nscriptPath = mc.internalVar(usd = 1)\nDW_MaterialManagerPath = scriptPath + r'DW_MaterialManager'\nDW_MaterialManagerPath = DW_MaterialManagerPath.replace(r'/','\\\\')\nif DW_MaterialManagerPath not in sys.path:\n    sys.path.insert(0,DW_MaterialManagerPath)\n    \nimport UI\nreload(UI)\nUI.UI()" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "#encoding:utf-8\n#material converter\nimport maya.cmds as mc\nimpor..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "DW" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "pythonFamily.png" 
        -image1 "pythonFamily.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "#encoding:utf-8\n#material converter\nimport maya.cmds as mc\nimport pymel.core as pm\nimport sys\nimport json\nmc.about(windows = 1)\nscriptPath = mc.internalVar(usd = 1)\nDW_MaterialManagerPath = scriptPath + r'DW_MaterialManager'\n\n# if the systerm is windows,then use \\\\ replace /\nif mc.about(windows = 1):\n\tDW_MaterialManagerPath = DW_MaterialManagerPath.replace(r'/','\\\\')\nelse:\n\tpass\n\t\nif DW_MaterialManagerPath not in sys.path:\n    sys.path.insert(0,DW_MaterialManagerPath)\n\ntry:\n    import UI\n    \nexcept:\n    mc.error('the DW_MaterialManager folder is placed wrong,the right path is : {0}'.format(scriptPath))\n    \nreload(UI)\nUI.UI()" 
        -sourceType "python" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "Reverse the normals of the selected faces" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "Reverse" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.25 
        -image "polyNormal.png" 
        -image1 "polyNormal.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "ReversePolygonNormals" 
        -sourceType "mel" 
        -doubleClickCommand "ReversePolygonNormalsOptions" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "FileTextureManager" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "FileTextureManager" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "FM" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.2 
        -image "zoom.png" 
        -image1 "zoom.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "FileTextureManager" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "Edit the references for the current scene" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "Reference Editor" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "RE" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.25 
        -image "menuIconFile.png" 
        -image1 "menuIconFile.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "ReferenceEditor" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "Display Face Normals" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "Face Normals" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "FN" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.25 
        -image "menuIconDisplay.png" 
        -image1 "menuIconDisplay.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "ToggleFaceNormalDisplay" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "Select an object(s)" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "Center Pivot" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "CP" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.25 
        -image "menuIconModify.png" 
        -image1 "menuIconModify.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "CenterPivot" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "Select an object(s)" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "Freeze Transformations" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "FT" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.25 
        -image "menuIconModify.png" 
        -image1 "menuIconModify.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "FreezeTransformations" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "global proc redShiftText(){\n    \n\n    string $tt = `getAttr \"defaultRenderGlobals.imageFilePrefix\"`;\n   \n//    string $redshiftAov[] = {\"rsAov_WorldPosition\", \"rsAov_VolumeLighting,rsAov_VolumeFogTint\",\"rsAov_VolumeFogEmission\",\n//                            \"rsAov_TranslucencyLightingRaw\",\"rsAov_TranslucencyGIRaw1\",\"rsAov_TranslucencyFilter\",\n//                            \"rsAov_TotalTranslucencyLightingRaw\",\"rsAov_TotalDiffuseLightingRaw\",\"rsAov_SubSurfaceScatter\",\n//                            \"rsAov_SpecularLighting\",\"rsAov_Shadows\",\"rsAov_RefractionsRaw\"};\n                            \n    string $rsw = `attributeExists \"filePrefix\" rsAov_WorldPosition`;\n    string $rsvl = `attributeExists \"filePrefix\" rsAov_VolumeLighting`;\n    string $rsvft = `attributeExists \"filePrefix\" rsAov_VolumeFogTint`;\n    string $vfe = `attributeExists \"filePrefix\" rsAov_VolumeFogEmission`;\n    string $tlr = `attributeExists \"filePrefix\" rsAov_TranslucencyLightingRaw`;\n    string $tg = `attributeExists \"filePrefix\" rsAov_TranslucencyGIRaw`;\n    string $tf = `attributeExists \"filePrefix\" rsAov_TranslucencyFilter`;\n    string $ttl = `attributeExists \"filePrefix\" rsAov_TotalTranslucencyLightingRaw`;\n    string $tdl = `attributeExists \"filePrefix\" rsAov_TotalDiffuseLightingRaw`;\n    string $sss = `attributeExists \"filePrefix\" rsAov_SubSurfaceScatter`;\n    string $sl = `attributeExists \"filePrefix\" rsAov_SpecularLighting`;\n    string $s = `attributeExists \"filePrefix\" rsAov_Shadows`;\n    string $rr = `attributeExists \"filePrefix\" rsAov_RefractionsRaw`;\n    string $rf = `attributeExists \"filePrefix\" rsAov_RefractionsFilter`;\n    string $r = `attributeExists \"filePrefix\" rsAov_Refractions`;\n    string $rc = `attributeExists \"filePrefix\" rsAov_Reflections`;\n    string $pm = `attributeExists \"filePrefix\" rsAov_PuzzleMatte`;\n    string $sp = `attributeExists \"filePrefix\" rsAov_Object_SpacePositions`;\n    string $sbn = `attributeExists \"filePrefix\" rsAov_Object_SpaceBumpNormals`;\n    string $oid = `attributeExists \"filePrefix\" rsAov_ObjectID`;\n    string $n = `attributeExists \"filePrefix\" rsAov_Normals`;\n    string $mv = `attributeExists \"filePrefix\" rsAov_MotionVectors`;\n    string $m = `attributeExists \"filePrefix\" rsAov_Matte`;\n    string $gir = `attributeExists \"filePrefix\" rsAov_GlobalIlluminationRaw`;\n    string $gi = `attributeExists \"filePrefix\" rsAov_GlobalIllumination`;\n    string $e = `attributeExists \"filePrefix\" rsAov_Emission`;\n    string $dlr = `attributeExists \"filePrefix\" rsAov_DiffuseLightingRaw`;\n    string $dl = `attributeExists \"filePrefix\" rsAov_DiffuseLighting`;\n    string $df = `attributeExists \"filePrefix\" rsAov_DiffuseFilter`;\n    string $d = `attributeExists \"filePrefix\" rsAov_Depth`;\n    string $cr = `attributeExists \"filePrefix\" rsAov_CausticsRaw`;\n    string $c = `attributeExists \"filePrefix\" rsAov_Caustics`;\n    string $bn = `attributeExists \"filePrefix\" rsAov_BumpNormals`;\n    string $ao = `attributeExists \"filePrefix\" rsAov_AmbientOcclusion`;\n    string $rlf = `attributeExists \"filePrefix\" rsAov_ReflectionsFilter`;\n    string $rlr = `attributeExists \"filePrefix\" rsAov_ReflectionsRaw`;\n    \n\n    if ($rsw == 1) {\n       \n    setAttr -type \"string\" rsAov_WorldPosition.filePrefix $tt;\n\n    }\n     \n    if ($rsvl == 1) {\n       \n    setAttr -type \"string\" rsAov_VolumeLighting.filePrefix $tt;\n\n    }\n\n    if ($rsvft == 1) {\n       \n    setAttr -type \"string\" rsAov_VolumeFogTint.filePrefix $tt;\n\n    }\n     \n    if ($vfe == 1) {\n       \n    setAttr -type \"string\" rsAov_VolumeFogEmission.filePrefix $tt;\n\n    }\n\n    if ($tlr == 1) {\n       \n    setAttr -type \"string\" rsAov_TranslucencyLightingRaw.filePrefix $tt;\n\n    }\n     \n    if ($tg == 1) {\n       \n    setAttr -type \"string\" rsAov_TranslucencyGIRaw.filePrefix $tt;\n\n    }\n\n    if ($tf == 1) {\n       \n    setAttr -type \"string\" rsAov_TranslucencyFilter.filePrefix $tt;\n\n    }\n     \n    if ($ttl == 1) {\n       \n    setAttr -type \"string\" rsAov_TotalTranslucencyLightingRaw.filePrefix $tt;\n\n    }\n    \n    if ($tdl == 1) {\n       \n    setAttr -type \"string\" rsAov_TotalDiffuseLightingRaw.filePrefix $tt;\n\n    }\n     \n    if ($sss == 1) {\n       \n    setAttr -type \"string\" rsAov_SubSurfaceScatter.filePrefix $tt;\n\n    }\n    \n    if ($sl == 1) {\n       \n    setAttr -type \"string\" rsAov_SpecularLighting.filePrefix $tt;\n\n    }\n     \n    if ($s == 1) {\n       \n    setAttr -type \"string\" rsAov_Shadows.filePrefix $tt;\n\n    }\n    \n    if ($rr == 1) {\n       \n    setAttr -type \"string\" rsAov_RefractionsRaw.filePrefix $tt;\n\n    }\n     \n    if ($rf == 1) {\n       \n    setAttr -type \"string\" rsAov_RefractionsFilter.filePrefix $tt;\n\n    }\n\n    if ($r == 1) {\n       \n    setAttr -type \"string\" rsAov_Refractions.filePrefix $tt;\n\n    }\n     \n    if ($rc == 1) {\n       \n    setAttr -type \"string\" rsAov_Reflections.filePrefix $tt;\n\n    }\n    \n    if ($pm == 1) {\n       \n    setAttr -type \"string\" rsAov_PuzzleMatte.filePrefix $tt;\n\n    }\n     \n    if ($sp == 1) {\n       \n    setAttr -type \"string\" rsAov_Object_SpacePositions.filePrefix $tt;\n\n    }\n    \n    if ($sbn == 1) {\n       \n    setAttr -type \"string\" rsAov_Object_SpaceBumpNormals.filePrefix $tt;\n\n    }\n     \n    if ($oid == 1) {\n       \n    setAttr -type \"string\" rsAov_ObjectID.filePrefix $tt;\n\n    }\n    \n    if ($n == 1) {\n       \n    setAttr -type \"string\" rsAov_Normals.filePrefix $tt;\n\n    }\n    \n    if ($mv == 1) {\n       \n    setAttr -type \"string\" rsAov_MotionVectors.filePrefix $tt;\n\n    }\n     \n    if ($m == 1) {\n       \n    setAttr -type \"string\" rsAov_Matte.filePrefix $tt;\n\n    }\n    \n    if ($gir == 1) {\n       \n    setAttr -type \"string\" rsAov_GlobalIlluminationRaw.filePrefix $tt;\n\n    }\n     \n    if ($gi == 1) {\n       \n    setAttr -type \"string\" rsAov_GlobalIllumination.filePrefix $tt;\n\n    }\n    \n    if ($e == 1) {\n       \n    setAttr -type \"string\" rsAov_Emission.filePrefix $tt;\n\n    }\n    \n    if ($dlr == 1) {\n       \n    setAttr -type \"string\" rsAov_DiffuseLightingRaw.filePrefix $tt;\n\n    }\n     \n    if ($dl == 1) {\n       \n    setAttr -type \"string\" rsAov_DiffuseLighting.filePrefix $tt;\n\n    }\n    \n    if ($df == 1) {\n       \n    setAttr -type \"string\" rsAov_DiffuseFilter.filePrefix $tt;\n\n    }\n     \n    if ($d == 1) {\n       \n    setAttr -type \"string\" rsAov_Depth.filePrefix $tt;\n\n    }\n    \n    if ($cr == 1) {\n       \n    setAttr -type \"string\" rsAov_CausticsRaw.filePrefix $tt;\n\n    }\n     \n    if ($c == 1) {\n       \n    setAttr -type \"string\" rsAov_Caustics.filePrefix $tt;\n\n    }\n    \n    if ($bn == 1) {\n       \n    setAttr -type \"string\" rsAov_BumpNormals.filePrefix $tt;\n\n    }\n     \n    if ($ao == 1) {\n       \n    setAttr -type \"string\" rsAov_AmbientOcclusion.filePrefix $tt;\n    \n    }\n    \n    if ($rlf == 1) {\n       \n    setAttr -type \"string\" rsAov_ReflectionsFilter.filePrefix $tt;\n\n    }\n     \n    if ($rlr == 1) {\n       \n    setAttr -type \"string\" rsAov_ReflectionsRaw.filePrefix $tt;\n    \n    }\n}\n\n\nif(`window -ex redShift01`){\n    \n    deleteUI redShift01;\n    \n}\nwindow -t \"RS_AOV命名格式工具\" -widthHeight 300 100 redShift01;\n\ncolumnLayout -adjustableColumn true -rowSpacing 1;\ntext -backgroundColor 0.2 0.2 0.2 \"此工具会自动读取file name prefix下格式\";\n\nseparator;\nseparator;\n\nbutton -backgroundColor 0.965 0.5 0.188 -l \"执行\" -c \"redShiftText\";\n\n\nwindow -edit -widthHeight 220 50 redShift01;\nshowWindow redShift01;\n" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "global proc redShiftText(){\n    \n\n    string $tt = `getAttr \"def..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "RS_AOV" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.2 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "global proc redShiftText(){\n    \n\n    string $tt = `getAttr \"defaultRenderGlobals.imageFilePrefix\"`;\n   \n//    string $redshiftAov[] = {\"rsAov_WorldPosition\", \"rsAov_VolumeLighting,rsAov_VolumeFogTint\",\"rsAov_VolumeFogEmission\",\n//                            \"rsAov_TranslucencyLightingRaw\",\"rsAov_TranslucencyGIRaw1\",\"rsAov_TranslucencyFilter\",\n//                            \"rsAov_TotalTranslucencyLightingRaw\",\"rsAov_TotalDiffuseLightingRaw\",\"rsAov_SubSurfaceScatter\",\n//                            \"rsAov_SpecularLighting\",\"rsAov_Shadows\",\"rsAov_RefractionsRaw\"};\n                            \n    string $rsw = `attributeExists \"filePrefix\" rsAov_WorldPosition`;\n    string $rsvl = `attributeExists \"filePrefix\" rsAov_VolumeLighting`;\n    string $rsvft = `attributeExists \"filePrefix\" rsAov_VolumeFogTint`;\n    string $vfe = `attributeExists \"filePrefix\" rsAov_VolumeFogEmission`;\n    string $tlr = `attributeExists \"filePrefix\" rsAov_TranslucencyLightingRaw`;\n    string $tg = `attributeExists \"filePrefix\" rsAov_TranslucencyGIRaw`;\n    string $tf = `attributeExists \"filePrefix\" rsAov_TranslucencyFilter`;\n    string $ttl = `attributeExists \"filePrefix\" rsAov_TotalTranslucencyLightingRaw`;\n    string $tdl = `attributeExists \"filePrefix\" rsAov_TotalDiffuseLightingRaw`;\n    string $sss = `attributeExists \"filePrefix\" rsAov_SubSurfaceScatter`;\n    string $sl = `attributeExists \"filePrefix\" rsAov_SpecularLighting`;\n    string $s = `attributeExists \"filePrefix\" rsAov_Shadows`;\n    string $rr = `attributeExists \"filePrefix\" rsAov_RefractionsRaw`;\n    string $rf = `attributeExists \"filePrefix\" rsAov_RefractionsFilter`;\n    string $r = `attributeExists \"filePrefix\" rsAov_Refractions`;\n    string $rc = `attributeExists \"filePrefix\" rsAov_Reflections`;\n    string $pm = `attributeExists \"filePrefix\" rsAov_PuzzleMatte`;\n    string $sp = `attributeExists \"filePrefix\" rsAov_Object_SpacePositions`;\n    string $sbn = `attributeExists \"filePrefix\" rsAov_Object_SpaceBumpNormals`;\n    string $oid = `attributeExists \"filePrefix\" rsAov_ObjectID`;\n    string $n = `attributeExists \"filePrefix\" rsAov_Normals`;\n    string $mv = `attributeExists \"filePrefix\" rsAov_MotionVectors`;\n    string $m = `attributeExists \"filePrefix\" rsAov_Matte`;\n    string $gir = `attributeExists \"filePrefix\" rsAov_GlobalIlluminationRaw`;\n    string $gi = `attributeExists \"filePrefix\" rsAov_GlobalIllumination`;\n    string $e = `attributeExists \"filePrefix\" rsAov_Emission`;\n    string $dlr = `attributeExists \"filePrefix\" rsAov_DiffuseLightingRaw`;\n    string $dl = `attributeExists \"filePrefix\" rsAov_DiffuseLighting`;\n    string $df = `attributeExists \"filePrefix\" rsAov_DiffuseFilter`;\n    string $d = `attributeExists \"filePrefix\" rsAov_Depth`;\n    string $cr = `attributeExists \"filePrefix\" rsAov_CausticsRaw`;\n    string $c = `attributeExists \"filePrefix\" rsAov_Caustics`;\n    string $bn = `attributeExists \"filePrefix\" rsAov_BumpNormals`;\n    string $ao = `attributeExists \"filePrefix\" rsAov_AmbientOcclusion`;\n    string $rlf = `attributeExists \"filePrefix\" rsAov_ReflectionsFilter`;\n    string $rlr = `attributeExists \"filePrefix\" rsAov_ReflectionsRaw`;\n    \n\n    if ($rsw == 1) {\n       \n    setAttr -type \"string\" rsAov_WorldPosition.filePrefix $tt;\n\n    }\n     \n    if ($rsvl == 1) {\n       \n    setAttr -type \"string\" rsAov_VolumeLighting.filePrefix $tt;\n\n    }\n\n    if ($rsvft == 1) {\n       \n    setAttr -type \"string\" rsAov_VolumeFogTint.filePrefix $tt;\n\n    }\n     \n    if ($vfe == 1) {\n       \n    setAttr -type \"string\" rsAov_VolumeFogEmission.filePrefix $tt;\n\n    }\n\n    if ($tlr == 1) {\n       \n    setAttr -type \"string\" rsAov_TranslucencyLightingRaw.filePrefix $tt;\n\n    }\n     \n    if ($tg == 1) {\n       \n    setAttr -type \"string\" rsAov_TranslucencyGIRaw.filePrefix $tt;\n\n    }\n\n    if ($tf == 1) {\n       \n    setAttr -type \"string\" rsAov_TranslucencyFilter.filePrefix $tt;\n\n    }\n     \n    if ($ttl == 1) {\n       \n    setAttr -type \"string\" rsAov_TotalTranslucencyLightingRaw.filePrefix $tt;\n\n    }\n    \n    if ($tdl == 1) {\n       \n    setAttr -type \"string\" rsAov_TotalDiffuseLightingRaw.filePrefix $tt;\n\n    }\n     \n    if ($sss == 1) {\n       \n    setAttr -type \"string\" rsAov_SubSurfaceScatter.filePrefix $tt;\n\n    }\n    \n    if ($sl == 1) {\n       \n    setAttr -type \"string\" rsAov_SpecularLighting.filePrefix $tt;\n\n    }\n     \n    if ($s == 1) {\n       \n    setAttr -type \"string\" rsAov_Shadows.filePrefix $tt;\n\n    }\n    \n    if ($rr == 1) {\n       \n    setAttr -type \"string\" rsAov_RefractionsRaw.filePrefix $tt;\n\n    }\n     \n    if ($rf == 1) {\n       \n    setAttr -type \"string\" rsAov_RefractionsFilter.filePrefix $tt;\n\n    }\n\n    if ($r == 1) {\n       \n    setAttr -type \"string\" rsAov_Refractions.filePrefix $tt;\n\n    }\n     \n    if ($rc == 1) {\n       \n    setAttr -type \"string\" rsAov_Reflections.filePrefix $tt;\n\n    }\n    \n    if ($pm == 1) {\n       \n    setAttr -type \"string\" rsAov_PuzzleMatte.filePrefix $tt;\n\n    }\n     \n    if ($sp == 1) {\n       \n    setAttr -type \"string\" rsAov_Object_SpacePositions.filePrefix $tt;\n\n    }\n    \n    if ($sbn == 1) {\n       \n    setAttr -type \"string\" rsAov_Object_SpaceBumpNormals.filePrefix $tt;\n\n    }\n     \n    if ($oid == 1) {\n       \n    setAttr -type \"string\" rsAov_ObjectID.filePrefix $tt;\n\n    }\n    \n    if ($n == 1) {\n       \n    setAttr -type \"string\" rsAov_Normals.filePrefix $tt;\n\n    }\n    \n    if ($mv == 1) {\n       \n    setAttr -type \"string\" rsAov_MotionVectors.filePrefix $tt;\n\n    }\n     \n    if ($m == 1) {\n       \n    setAttr -type \"string\" rsAov_Matte.filePrefix $tt;\n\n    }\n    \n    if ($gir == 1) {\n       \n    setAttr -type \"string\" rsAov_GlobalIlluminationRaw.filePrefix $tt;\n\n    }\n     \n    if ($gi == 1) {\n       \n    setAttr -type \"string\" rsAov_GlobalIllumination.filePrefix $tt;\n\n    }\n    \n    if ($e == 1) {\n       \n    setAttr -type \"string\" rsAov_Emission.filePrefix $tt;\n\n    }\n    \n    if ($dlr == 1) {\n       \n    setAttr -type \"string\" rsAov_DiffuseLightingRaw.filePrefix $tt;\n\n    }\n     \n    if ($dl == 1) {\n       \n    setAttr -type \"string\" rsAov_DiffuseLighting.filePrefix $tt;\n\n    }\n    \n    if ($df == 1) {\n       \n    setAttr -type \"string\" rsAov_DiffuseFilter.filePrefix $tt;\n\n    }\n     \n    if ($d == 1) {\n       \n    setAttr -type \"string\" rsAov_Depth.filePrefix $tt;\n\n    }\n    \n    if ($cr == 1) {\n       \n    setAttr -type \"string\" rsAov_CausticsRaw.filePrefix $tt;\n\n    }\n     \n    if ($c == 1) {\n       \n    setAttr -type \"string\" rsAov_Caustics.filePrefix $tt;\n\n    }\n    \n    if ($bn == 1) {\n       \n    setAttr -type \"string\" rsAov_BumpNormals.filePrefix $tt;\n\n    }\n     \n    if ($ao == 1) {\n       \n    setAttr -type \"string\" rsAov_AmbientOcclusion.filePrefix $tt;\n    \n    }\n    \n    if ($rlf == 1) {\n       \n    setAttr -type \"string\" rsAov_ReflectionsFilter.filePrefix $tt;\n\n    }\n     \n    if ($rlr == 1) {\n       \n    setAttr -type \"string\" rsAov_ReflectionsRaw.filePrefix $tt;\n    \n    }\n}\n\n\nif(`window -ex redShift01`){\n    \n    deleteUI redShift01;\n    \n}\nwindow -t \"RS_AOV命名格式工具\" -widthHeight 300 100 redShift01;\n\ncolumnLayout -adjustableColumn true -rowSpacing 1;\ntext -backgroundColor 0.2 0.2 0.2 \"此工具会自动读取file name prefix下格式\";\n\nseparator;\nseparator;\n\nbutton -backgroundColor 0.965 0.5 0.188 -l \"执行\" -c \"redShiftText\";\n\n\nwindow -edit -widthHeight 220 50 redShift01;\nshowWindow redShift01;\n" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "//Coded by Tiancg\nglobal proc tjh_Arnold_AOV_creator_Main(){\tstring $srcPath = `whatIs \"tjh_Arnold_AOV_creator_Main\"`;\tint $size = size($srcPath) ;\t$srcPath = `substring $srcPath 25 $size`;\t$srcPath = dirname( $srcPath );\tstring $mayaVer=`about -v`;\tstring $ver[];\tint $number=`tokenize $mayaVer \".\" $ver`;\tstring $plug_ins=\"linkDll_\"+$ver[0]+\".mll\";\tif(!` pluginInfo -query -l $plug_ins `)loadPlugin -qt ($srcPath+\"/lib/\"+$plug_ins);\tstring $dstScriptPath = `internalVar -userAppDir` + \"scripts/\"; sysFile -copy ($dstScriptPath+\"tjh_Arnold_AOV_creator.dll\") ($srcPath+\"/lib/\"+\"tjh_Arnold_AOV_creator.dll\"); linkDll ($dstScriptPath+\"tjh_Arnold_AOV_creator.dll\");tjh_Arnold_AOV_creator;}tjh_Arnold_AOV_creator_Main;" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "//Coded by Tiancg\nglobal proc tjh_Arnold_AOV_creator_Main(){\tstr..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "AR_AOV" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "//Coded by Tiancg\nglobal proc tjh_Arnold_AOV_creator_Main(){\tstring $srcPath = `whatIs \"tjh_Arnold_AOV_creator_Main\"`;\tint $size = size($srcPath) ;\t$srcPath = `substring $srcPath 25 $size`;\t$srcPath = dirname( $srcPath );\tstring $mayaVer=`about -v`;\tstring $ver[];\tint $number=`tokenize $mayaVer \".\" $ver`;\tstring $plug_ins=\"linkDll_\"+$ver[0]+\".mll\";\tif(!` pluginInfo -query -l $plug_ins `)loadPlugin -qt ($srcPath+\"/lib/\"+$plug_ins);\tstring $dstScriptPath = `internalVar -userAppDir` + \"scripts/\"; sysFile -copy ($dstScriptPath+\"tjh_Arnold_AOV_creator.dll\") ($srcPath+\"/lib/\"+\"tjh_Arnold_AOV_creator.dll\"); linkDll ($dstScriptPath+\"tjh_Arnold_AOV_creator.dll\");tjh_Arnold_AOV_creator;}tjh_Arnold_AOV_creator_Main;" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "//Coded by Tiancg\nglobal proc tjh_batch_attr_set_Main(){\tstring $srcPath = `whatIs \"tjh_batch_attr_set_Main\"`;\tint $size = size($srcPath) ;\t$srcPath = `substring $srcPath 25 $size`;\t$srcPath = dirname( $srcPath );\tstring $mayaVer=`about -v`;\tstring $ver[];\tint $number=`tokenize $mayaVer \".\" $ver`;\tstring $plug_ins=\"linkDll_\"+$ver[0]+\".mll\";\tif(!` pluginInfo -query -l $plug_ins `)loadPlugin -qt ($srcPath+\"/lib/\"+$plug_ins);\tstring $dstScriptPath = `internalVar -userAppDir` + \"scripts/\"; sysFile -copy ($dstScriptPath+\"tjh_batch_attr_set.dll\") ($srcPath+\"/lib/\"+\"tjh_batch_attr_set.dll\"); linkDll ($dstScriptPath+\"tjh_batch_attr_set.dll\");tjh_batch_attr_set;}tjh_batch_attr_set_Main;" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "//Coded by Tiancg\nglobal proc tjh_batch_attr_set_Main(){\tstring ..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "M_Attr" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "//Coded by Tiancg\nglobal proc tjh_batch_attr_set_Main(){\tstring $srcPath = `whatIs \"tjh_batch_attr_set_Main\"`;\tint $size = size($srcPath) ;\t$srcPath = `substring $srcPath 25 $size`;\t$srcPath = dirname( $srcPath );\tstring $mayaVer=`about -v`;\tstring $ver[];\tint $number=`tokenize $mayaVer \".\" $ver`;\tstring $plug_ins=\"linkDll_\"+$ver[0]+\".mll\";\tif(!` pluginInfo -query -l $plug_ins `)loadPlugin -qt ($srcPath+\"/lib/\"+$plug_ins);\tstring $dstScriptPath = `internalVar -userAppDir` + \"scripts/\"; sysFile -copy ($dstScriptPath+\"tjh_batch_attr_set.dll\") ($srcPath+\"/lib/\"+\"tjh_batch_attr_set.dll\"); linkDll ($dstScriptPath+\"tjh_batch_attr_set.dll\");tjh_batch_attr_set;}tjh_batch_attr_set_Main;" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "//Coded by Tiancg\nglobal proc tjh_lost_textures_finder_Main(){\tstring $srcPath = `whatIs \"tjh_lost_textures_finder_Main\"`;\tint $size = size($srcPath) ;\t$srcPath = `substring $srcPath 25 $size`;\t$srcPath = dirname( $srcPath );\tstring $mayaVer=`about -v`;\tstring $ver[];\tint $number=`tokenize $mayaVer \".\" $ver`;\tstring $plug_ins=\"linkDll_\"+$ver[0]+\".mll\";\tif(!` pluginInfo -query -l $plug_ins `)loadPlugin -qt ($srcPath+\"/lib/\"+$plug_ins);\tstring $dstScriptPath = `internalVar -userAppDir` + \"scripts/\"; sysFile -copy ($dstScriptPath+\"tjh_lost_textures_finder.dll\") ($srcPath+\"/lib/\"+\"tjh_lost_textures_finder.dll\"); linkDll ($dstScriptPath+\"tjh_lost_textures_finder.dll\");tjh_lost_textures_finder;}tjh_lost_textures_finder_Main;" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "//Coded by Tiancg\nglobal proc tjh_lost_textures_finder_Main(){\ts..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "TEX" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "//Coded by Tiancg\nglobal proc tjh_lost_textures_finder_Main(){\tstring $srcPath = `whatIs \"tjh_lost_textures_finder_Main\"`;\tint $size = size($srcPath) ;\t$srcPath = `substring $srcPath 25 $size`;\t$srcPath = dirname( $srcPath );\tstring $mayaVer=`about -v`;\tstring $ver[];\tint $number=`tokenize $mayaVer \".\" $ver`;\tstring $plug_ins=\"linkDll_\"+$ver[0]+\".mll\";\tif(!` pluginInfo -query -l $plug_ins `)loadPlugin -qt ($srcPath+\"/lib/\"+$plug_ins);\tstring $dstScriptPath = `internalVar -userAppDir` + \"scripts/\"; sysFile -copy ($dstScriptPath+\"tjh_lost_textures_finder.dll\") ($srcPath+\"/lib/\"+\"tjh_lost_textures_finder.dll\"); linkDll ($dstScriptPath+\"tjh_lost_textures_finder.dll\");tjh_lost_textures_finder;}tjh_lost_textures_finder_Main;" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "RS_Proxy" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "//Coded by Tiancg\nglobal proc tjh_redshiftProxy_attributes_assig..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "RS_Proxy" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "//Coded by Tiancg\nglobal proc tjh_redshiftProxy_attributes_assigner_Main(){\tstring $srcPath = `whatIs \"tjh_redshiftProxy_attributes_assigner_Main\"`;\tint $size = size($srcPath) ;\t$srcPath = `substring $srcPath 25 $size`;\t$srcPath = dirname( $srcPath );\tstring $mayaVer=`about -v`;\tstring $ver[];\tint $number=`tokenize $mayaVer \".\" $ver`;\tstring $plug_ins=\"linkDll_\"+$ver[0]+\".mll\";\tif(!` pluginInfo -query -l $plug_ins `)loadPlugin -qt ($srcPath+\"/lib/\"+$plug_ins); linkDll ($srcPath+\"/lib/\"+\"tjh_redshiftProxy_attributes_assigner.dll\");tjh_redshiftProxy_attributes_assigner;}tjh_redshiftProxy_attributes_assigner_Main;" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "import maya.cmds as cmds\n\ndef subdivisionType():\n    \n    sel = cmds.ls(sl=True)\n    subd_type = cmds.intSliderGrp(int_Slider, q=True, v=True)\n    options_type = cmds.optionMenuGrp(subdivision_menu, q=True, v=True)\n    \n    if options_type == \"none\":\n        options_type = 0\n    if options_type == \"catclark\":\n        options_type = 1\n    if options_type == \"linear\":\n        options_type = 2\n    \n    for sels in sel:\n        \n        set_aisIter = cmds.setAttr (sels + \".aiSubdivIterations\", subd_type)\n        set_aistype = cmds.setAttr (sels + \".aiSubdivType\", options_type)\n    \n    \nwindowName = \"aiswindow\"\n\nif cmds.window(windowName, q=True, ex=True):\n    cmds.deleteUI(windowName)\n\n#    Edit windowUI     \nmyWindow = cmds.window(windowName, t=\"SubdivisionSelection\")\ncolumn_layout = cmds.columnLayout(p=myWindow, adj=True, )\n\nsubdivision_menu = cmds.optionMenuGrp(l=\"type\", cw=(1,50), changeCommand=\"subdivisionType()\")\nnone = cmds.menuItem(l=\"none\")\ncatclark = cmds.menuItem(l=\"catclark\")\nlinear = cmds.menuItem(l=\"linear\")\n\nint_Slider = cmds.intSliderGrp(label=\"Iterations\", field=True, minValue=0, maxValue=5, fieldMinValue=0, fieldMaxValue=5, value=0, cw=(1,50), cc=\"subdivisionType()\")\n\ncmds.window(myWindow, e=True, wh=(300,70))\ncmds.showWindow(myWindow)\n" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "import maya.cmds as cmds\n\ndef subdivisionType():\n    \n    sel = ..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "Sdiv" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.2 
        -image "pythonFamily.png" 
        -image1 "pythonFamily.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "import maya.cmds as cmds\n\ndef subdivisionType():\n    \n    sel = cmds.ls(sl=True)\n    subd_type = cmds.intSliderGrp(int_Slider, q=True, v=True)\n    options_type = cmds.optionMenuGrp(subdivision_menu, q=True, v=True)\n    \n    if options_type == \"none\":\n        options_type = 0\n    if options_type == \"catclark\":\n        options_type = 1\n    if options_type == \"linear\":\n        options_type = 2\n    \n    for sels in sel:\n        \n        set_aisIter = cmds.setAttr (sels + \".aiSubdivIterations\", subd_type)\n        set_aistype = cmds.setAttr (sels + \".aiSubdivType\", options_type)\n    \n    \nwindowName = \"aiswindow\"\n\nif cmds.window(windowName, q=True, ex=True):\n    cmds.deleteUI(windowName)\n\n#    Edit windowUI     \nmyWindow = cmds.window(windowName, t=\"SubdivisionSelection\")\ncolumn_layout = cmds.columnLayout(p=myWindow, adj=True, )\n\nsubdivision_menu = cmds.optionMenuGrp(l=\"type\", cw=(1,50), changeCommand=\"subdivisionType()\")\nnone = cmds.menuItem(l=\"none\")\ncatclark = cmds.menuItem(l=\"catclark\")\nlinear = cmds.menuItem(l=\"linear\")\n\nint_Slider = cmds.intSliderGrp(label=\"Iterations\", field=True, minValue=0, maxValue=5, fieldMinValue=0, fieldMaxValue=5, value=0, cw=(1,50), cc=\"subdivisionType()\")\n\ncmds.window(myWindow, e=True, wh=(300,70))\ncmds.showWindow(myWindow)\n" 
        -sourceType "python" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "import maya.cmds as cmds\n\ndef select_type():\n    \n    Mesh = cmds.ls(type=\"mesh\")\n    NBS = cmds.ls(type=\"nurbsSurface\")\n    Locator = cmds.ls(type=\"locator\")\n    Joint = cmds.ls(type=\"joint\")\n    MUL = cmds.ls(type=\"multiplyDivide\")\n    distanceDim = cmds.ls(type=\"distanceDimShape\")\n    parentCon = cmds.ls(type=\"parentConstraint\")\n    orientCon = cmds.ls(type=\"orientConstraint\")\n    pointCon = cmds.ls(type=\"pointConstraint\")\n    amiCon = cmds.ls(type=\"aimConstraint\")\n    scaleCon = cmds.ls(type=\"scaleConstraint\")\n    nurbsCRV = cmds.ls(type=\"nurbsCurve\")\n    ikHand = cmds.ls(type=\"ikHandle\")\n    ikEff = cmds.ls(type=\"ikEffector\")\n    Lattice = cmds.ls(type=\"lattice\")\n    baseLatt = cmds.ls(type=\"baseLattice\")\n    CLU = cmds.ls(type=\"clusterHandle\")\n    \n    options = cmds.optionMenuGrp(objType_menu, q=True, v=True)\n    \n    if options == \"mesh\":\n        cmds.select(Mesh)\n        cmds.pickWalk(d=\"up\")\n\n    if options == \"nurbsSurface\":\n        cmds.select(NBS)\n        cmds.pickWalk(d=\"up\")\n\n    if options == \"joint\":\n        cmds.select(Joint)\n\n    if options == \"locator\":\n        cmds.select(Locator)\n        cmds.pickWalk(d=\"up\")\n        \n    if options == \"ikHandle\":\n        cmds.select(ikHand)\n        \n    if options == \"ikEffector\":\n        cmds.select(ikEff)\n        \n    if options == \"nurbsCurve\":\n        cmds.select(nurbsCRV)\n        cmds.pickWalk(d=\"up\")\n\n    if options == \"parentConstraint\":\n        cmds.select(parentCon)\n\n    if options == \"orientConstraint\":\n        cmds.select(orientCon)\n\n    if options == \"pointConstraint\":\n        cmds.select(pointCon)\n\n    if options == \"scaleConstraint\":\n        cmds.select(scaleCon)\n\n    if options == \"aimConstraint\":\n        cmds.select(amiCon)\n\n    if options == \"distanceDimension\":\n        cmds.select(distanceDim)\n        cmds.pickWalk(d=\"up\")\n        \n    if options == \"lattice\":\n        cmds.select(Lattice)\n        cmds.pickWalk(d=\"up\")\n\n    if options == \"baseLattice\":\n        cmds.select(baseLatt)\n        cmds.pickWalk(d=\"up\")\n        \n    if options == \"cluster\":\n        cmds.select(CLU)\n        cmds.pickWalk(d=\"up\")\n\n#    create windows\nwindowName = \"renameCtrl\"\n\nif cmds.window(windowName, q=True, ex=True):\n    cmds.deleteUI(windowName)\n\n#    Edit windowUI     \nmyWindow = cmds.window(windowName, t=\"选择场景物体类型脚本\")\n\ncolumn_layout = cmds.columnLayout(p=myWindow, adj=True, rowSpacing=6)\n\nobjType_menu = cmds.optionMenuGrp(l=\"物体类型\", cw=(1,50))\nCenter = cmds.menuItem(l=\"mesh\")\nLift = cmds.menuItem(l=\"nurbsSurface\")\nRight = cmds.menuItem(l=\"joint\")\nUp = cmds.menuItem(l=\"locator\")\nDown = cmds.menuItem(l=\"ikHandle\")\nFront = cmds.menuItem(l=\"nurbsCurve\")\nBack = cmds.menuItem(l=\"parentConstraint\", )\nori = cmds.menuItem(l=\"orientConstraint\", )\npoi = cmds.menuItem(l=\"pointConstraint\", )\nscal = cmds.menuItem(l=\"scaleConstraint\", )\nami = cmds.menuItem(l=\"aimConstraint\", )\nikE = cmds.menuItem(l=\"ikEffector\", )\nLatt = cmds.menuItem(l=\"lattice\", )\nBase = cmds.menuItem(l=\"baseLattice\", )\nDist = cmds.menuItem(l=\"distanceDimension\")\nClu = cmds.menuItem(l=\"cluster\")\n\n\ncreate_button = cmds.button(l=\"选择\", c=\"select_type()\")\n\n#    show windowUI\ncmds.window(myWindow, e=True, wh=(200,100))\ncmds.showWindow(myWindow)\n" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "import maya.cmds as cmds\n\ndef select_type():\n    \n    Mesh = cmd..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "SlTy" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.2 
        -image "pythonFamily.png" 
        -image1 "pythonFamily.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "import maya.cmds as cmds\n\ndef select_type():\n    \n    Mesh = cmds.ls(type=\"mesh\")\n    NBS = cmds.ls(type=\"nurbsSurface\")\n    Locator = cmds.ls(type=\"locator\")\n    Joint = cmds.ls(type=\"joint\")\n    MUL = cmds.ls(type=\"multiplyDivide\")\n    distanceDim = cmds.ls(type=\"distanceDimShape\")\n    parentCon = cmds.ls(type=\"parentConstraint\")\n    orientCon = cmds.ls(type=\"orientConstraint\")\n    pointCon = cmds.ls(type=\"pointConstraint\")\n    amiCon = cmds.ls(type=\"aimConstraint\")\n    scaleCon = cmds.ls(type=\"scaleConstraint\")\n    nurbsCRV = cmds.ls(type=\"nurbsCurve\")\n    ikHand = cmds.ls(type=\"ikHandle\")\n    ikEff = cmds.ls(type=\"ikEffector\")\n    Lattice = cmds.ls(type=\"lattice\")\n    baseLatt = cmds.ls(type=\"baseLattice\")\n    CLU = cmds.ls(type=\"clusterHandle\")\n    \n    options = cmds.optionMenuGrp(objType_menu, q=True, v=True)\n    \n    if options == \"mesh\":\n        cmds.select(Mesh)\n        cmds.pickWalk(d=\"up\")\n\n    if options == \"nurbsSurface\":\n        cmds.select(NBS)\n        cmds.pickWalk(d=\"up\")\n\n    if options == \"joint\":\n        cmds.select(Joint)\n\n    if options == \"locator\":\n        cmds.select(Locator)\n        cmds.pickWalk(d=\"up\")\n        \n    if options == \"ikHandle\":\n        cmds.select(ikHand)\n        \n    if options == \"ikEffector\":\n        cmds.select(ikEff)\n        \n    if options == \"nurbsCurve\":\n        cmds.select(nurbsCRV)\n        cmds.pickWalk(d=\"up\")\n\n    if options == \"parentConstraint\":\n        cmds.select(parentCon)\n\n    if options == \"orientConstraint\":\n        cmds.select(orientCon)\n\n    if options == \"pointConstraint\":\n        cmds.select(pointCon)\n\n    if options == \"scaleConstraint\":\n        cmds.select(scaleCon)\n\n    if options == \"aimConstraint\":\n        cmds.select(amiCon)\n\n    if options == \"distanceDimension\":\n        cmds.select(distanceDim)\n        cmds.pickWalk(d=\"up\")\n        \n    if options == \"lattice\":\n        cmds.select(Lattice)\n        cmds.pickWalk(d=\"up\")\n\n    if options == \"baseLattice\":\n        cmds.select(baseLatt)\n        cmds.pickWalk(d=\"up\")\n        \n    if options == \"cluster\":\n        cmds.select(CLU)\n        cmds.pickWalk(d=\"up\")\n\n#    create windows\nwindowName = \"renameCtrl\"\n\nif cmds.window(windowName, q=True, ex=True):\n    cmds.deleteUI(windowName)\n\n#    Edit windowUI     \nmyWindow = cmds.window(windowName, t=\"选择场景物体类型脚本\")\n\ncolumn_layout = cmds.columnLayout(p=myWindow, adj=True, rowSpacing=6)\n\nobjType_menu = cmds.optionMenuGrp(l=\"物体类型\", cw=(1,50))\nCenter = cmds.menuItem(l=\"mesh\")\nLift = cmds.menuItem(l=\"nurbsSurface\")\nRight = cmds.menuItem(l=\"joint\")\nUp = cmds.menuItem(l=\"locator\")\nDown = cmds.menuItem(l=\"ikHandle\")\nFront = cmds.menuItem(l=\"nurbsCurve\")\nBack = cmds.menuItem(l=\"parentConstraint\", )\nori = cmds.menuItem(l=\"orientConstraint\", )\npoi = cmds.menuItem(l=\"pointConstraint\", )\nscal = cmds.menuItem(l=\"scaleConstraint\", )\nami = cmds.menuItem(l=\"aimConstraint\", )\nikE = cmds.menuItem(l=\"ikEffector\", )\nLatt = cmds.menuItem(l=\"lattice\", )\nBase = cmds.menuItem(l=\"baseLattice\", )\nDist = cmds.menuItem(l=\"distanceDimension\")\nClu = cmds.menuItem(l=\"cluster\")\n\n\ncreate_button = cmds.button(l=\"选择\", c=\"select_type()\")\n\n#    show windowUI\ncmds.window(myWindow, e=True, wh=(200,100))\ncmds.showWindow(myWindow)\n" 
        -sourceType "python" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "setAttr defaultRenderGlobals.currentRenderer -type \"string\" \"redshift\";\nfile -r \"P:/PT/Lighting/check_LGT_RS_DGKJ.ma\";\n" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "setAttr defaultRenderGlobals.currentRenderer -type \"string\" \"red..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "RS_check" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "setAttr defaultRenderGlobals.currentRenderer -type \"string\" \"redshift\";\nfile -r \"M:/BLK/Lighting/Lookdev_Light_RS.ma\";\n" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "file -r \"P:/PT/DB/CH/FIX/C_Fatty.mb\";\nfile -r \"P:/PT/DB/CH/FIX/C_Houye.mb\";\nfile -r \"P:/PT/DB/CH/FIX/C_Mum.mb\";\nfile -r \"P:/PT/DB/CH/FIX/C_TATA.mb\";\nfile -r \"P:/PT/DB/CH/FIX/C_Mum.mb\";\nfile -r \"P:/PT/DB/CH/FIX/C_XiaoQ_Skin.mb\";\nfile -r \"P:/PT/DB/CH/FIX/C_Shasha.mb\";" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "file -r \"P:/PT/DB/CH/FIX/C_Fatty.mb\";\nfile -r \"P:/PT/DB/CH/FIX/C..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "studioLGT" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.2 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "setAttr defaultRenderGlobals.currentRenderer -type \"string\" \"arnold\";\nfile -r \"P:/PT/Lighting/Studio_Lighting_Tutorial.ma\";\nsetAttr \"defaultArnoldRenderOptions.use_existing_tiled_textures\" 1;" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "file -r \"P:/MB/Lighting/CheckLGT.ma\";\nsetAttr \"defaultArnoldRenderOptions.use_existing_tiled_textures\" 1;" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "file -r \"P:/MB/Lighting/CheckLGT.ma\";\nsetAttr \"defaultArnoldRend..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "checkLGT" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "setAttr defaultRenderGlobals.currentRenderer -type \"string\" \"arnold\";\nfile -r \"P:/MB/Lighting/CheckLGT.ma\";\nsetAttr \"defaultArnoldRenderOptions.use_existing_tiled_textures\" 1;\n" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "/////////////////////////////////////////////////////////////////////////////////////////////////////////////\n// WATER DROPS 1.0                                                                                         //\n// By Mariano Antico                                                                                       //\n// Barraca Post                                                                                            //\n// www.barraca.com.ar                                                                                      //\n// www.marianoantico.blogspot.com                                                                          //\n// Last Updated: June 14, 2011.                                                                            //\n// All Rights Reserved .                                                                                   //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n// INTERFAZ\n\nif (`window -ex Drops`) {\n  deleteUI -window Drops;\n}\nif (`window -ex GotasFijasOk`) {\n    deleteUI -window GotasFijasOk;\n}\nwindow -s 0 -t \"Water Drops 1.0 by Mariano Antico\" /*-minimizeButton false  -maximizeButton false*/ Drops;\n    menuBarLayout menuWater;\n        menu -l \"File\" -en true m1;\n        menuItem -l \"Reset values\" -en true -c \"resetValues()\";\n        menu -l \"Window\" -en true m2;\n        menuItem -l \"Expression Editor\" -en true -c \"ExpressionEditor;\";\n        menuItem -l \"Dynamic Relationships\" -en true -c \"DynamicRelationshipEditor;\";\n        menu -l \"Help\" -en true m3;\n        menuItem -l \"About\" -en true -c \"aboutHelp()\";\n        separator;\n\n//SEED SECTION\n\n    rowColumnLayout -numberOfColumns 1 -columnWidth 1 245;\n        text -font \"boldLabelFont\" -l \"CREATE SEED EXPRESSION:\";\n        separator -style \"none\" -h 2;\n    rowColumnLayout -numberOfColumns 2 -columnWidth 1 120 -columnWidth 2 120;       \n        text -font \"plainLabelFont\" -l \"SEED:\"; textField -font \"plainLabelFont\" -tx \"12345\" -ec \"updateSeed()\" seedTF;\n        separator -style \"none\" -h 2;separator -style \"none\" -h 2;       \n    setParent ..; \n    rowColumnLayout -numberOfColumns 3 -columnWidth 1 80 -columnWidth 2 80 -columnWidth 3 80;    \n        button -l \"Create Seed\" -c \"updateSeed()\"; button -l \"Random Seed\" -c \"randomSeed()\"; button -l \"Delete Seed\" -c \"deleteSeed()\";\n        separator -style \"none\" -h 2;separator -style \"none\" -h 2;separator -style \"none\" -h 2;           \n    setParent ..;        \n\n    rowColumnLayout -numberOfColumns 1;       \n        separator;\n        text -font \"boldLabelFont\" -l \"CREATE WATER DROPS:\";\n        separator -style \"none\" -h 2;\n        separator;\n\n//DRIVER WATER DROPS SECTION\n\n        separator -style \"none\" -h 5;\n        text -font \"boldLabelFont\" -l \"CREATE DRIVER WATER DROPS:\";\n        separator -style \"none\" -h 5;\n    rowColumnLayout -numberOfColumns 2 -columnWidth 1 120 -columnWidth 2 120;\n        text -font \"plainLabelFont\" -l \"NUMBER OF DROPS:\"; textField -font \"plainLabelFont\" -tx \"10\" count2TF;\n        text -font \"plainLabelFont\" -l \"PARTICLES RATE:\"; textField -font \"plainLabelFont\" -tx \"250\" -ec \"updateParticleRate2()\" frameRate2TF;\n        text -font \"plainLabelFont\" -l \"INITIAL STATE FRAME:\"; textField -font \"plainLabelFont\" -tx \"20\" -ec \"updateFrameEnd2()\" frameEnd2TF;\n        text -font \"plainLabelFont\" -l \"RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.200\" -ec \"updateRadius2()\" radius2TF;\n        text -font \"plainLabelFont\" -l \"RANDOM RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.250\" -ec \"updateRandomRadius2()\" randomRadius2TF;\n    setParent ..;\n    \n    rowColumnLayout -numberOfColumns 3 -columnWidth 1 120 -columnWidth 2 60 -columnWidth 3 60;    \n        text -font \"plainLabelFont\" -l \"GOAL U:\"; textField -font \"plainLabelFont\" -tx \"0\" goalU1TF;  textField -font \"plainLabelFont\" -tx \"1\" goalU2TF;\n        text -font \"plainLabelFont\" -l \"GOAL V:\"; textField -font \"plainLabelFont\" -tx \"0\" goalV1TF;  textField -font \"plainLabelFont\" -tx \"1\" goalV2TF;\n        text -font \"plainLabelFont\" -l \"RANDOM VELOCITY:\"; textField -font \"plainLabelFont\" -tx \"1\" velocity1TF;  textField -font \"plainLabelFont\" -tx \"2\" velocity2TF;\n        text -font \"plainLabelFont\" -l \"START OFFSET:\"; textField -font \"plainLabelFont\" -tx \"0\" ageOffset1TF;  textField -font \"plainLabelFont\" -tx \"12\" ageOffset2TF;\n\n    setParent ..; \n    \n    rowColumnLayout -numberOfColumns 2 -columnWidth 1 120 -columnWidth 2 120;        \n        text -font \"plainLabelFont\" -l \"# OF RANDOM MOVES:\"; textField -font \"plainLabelFont\" -tx \"6\" movesTF;\n        separator -style \"none\" -h 3;separator -style \"none\" -h 3;        \n    setParent ..; \n    rowColumnLayout -numberOfColumns 3 -columnWidth 1 80 -columnWidth 2 80 -columnWidth 3 80;\n        button -l \"Create Driver\" -c \"createDrops()\"; button -l \"Select Driver\" -c \"selectDriver()\"; button -l \"Driver Visibility\" -c \"toogleVisibleDriver()\";\n    setParent ..; \n\n//WATER SWEAT SECTION  \n\n    rowColumnLayout -numberOfColumns 1;\n        separator;   \n        separator -style \"none\" -h 5;\n        text -font \"boldLabelFont\" -l \"CREATE SWEAT:\";\n\n   rowColumnLayout -numberOfColumns 2 -columnWidth 1 120 -columnWidth 2 120;\n        separator -style \"none\" -h 5;separator -style \"none\" -h 5;\n        text -font \"plainLabelFont\" -l \"RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.100\" -ec \"updateRadius()\" radiusTF;\n        text -font \"plainLabelFont\" -l \"RANDOM RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.250\" -ec \"updateRandomRadius()\" randomRadiusTF;\n        text -font \"plainLabelFont\" -l \"PARTICLES RATE:\"; textField -font \"plainLabelFont\" -tx \"250\" -ec \"updateParticleRate()\" frameRateTF;\n        text -font \"plainLabelFont\" -l \"INITIAL STATE FRAME:\"; textField -font \"plainLabelFont\" -tx \"100\" -ec \"updateFrameEnd()\" frameEndTF;\n        separator -style \"none\" -h 5;separator -style \"none\" -h 5;\n    setParent ..; \n    rowColumnLayout -numberOfColumns 3 -columnWidth 1 80 -columnWidth 2 80 -columnWidth 3 80;\n        button -l \"Create Sweat\" -c \"createParts()\"; button -l \"Select Sweat\" -c \"selectSweat()\"; button -l \"Sweat Visibility\" -c \"toogleVisibleSweat()\";\n    setParent ..; \n\n//WATER DROPS SECTION  \n\n    rowColumnLayout -numberOfColumns 1;\n        separator;   \n        separator -style \"none\" -h 5;\n        text -font \"boldLabelFont\" -l \"CREATE WATER DROPS:\";\n\n   rowColumnLayout -numberOfColumns 2 -columnWidth 1 120 -columnWidth 2 120;\n        separator -style \"none\" -h 5;separator -style \"none\" -h 5;\n        text -font \"plainLabelFont\" -l \"RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.250\" -ec \"updateRadius3()\" radius3TF;\n        text -font \"plainLabelFont\" -l \"RANDOM RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.060\" -ec \"updateRandomRadius3()\" randomRadius3TF;\n        text -font \"plainLabelFont\" -l \"PARTICLES RATE:\"; textField -font \"plainLabelFont\" -tx \"100\" -ec \"updateParticleRate3()\" frameRate3TF;\n        text -font \"plainLabelFont\" -l \"INITIAL STATE FRAME:\"; textField -font \"plainLabelFont\" -tx \"3\" -ec \"updateFrameEnd3()\" frameEnd3TF;\n        separator -style \"none\" -h 5;separator -style \"none\" -h 5;\n    setParent ..; \n    rowColumnLayout -numberOfColumns 3 -columnWidth 1 80 -columnWidth 2 80 -columnWidth 3 80;\n        button -l \"Create Drops\" -c \"createWater()\"; button -l \"Select Drops\" -c \"selectWater()\"; button -l \"Drops Visibility\" -c \"toogleVisibleWater()\";\n    setParent ..; \n\n//WATER TRAILS SECTION  \n\n    rowColumnLayout -numberOfColumns 1;\n        separator;   \n        separator -style \"none\" -h 5;\n        text -font \"boldLabelFont\" -l \"CREATE WATER TRAILS:\";\n\n   rowColumnLayout -numberOfColumns 2 -columnWidth 1 120 -columnWidth 2 120;\n        separator -style \"none\" -h 5;separator -style \"none\" -h 5;\n        text -font \"plainLabelFont\" -l \"RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.060\" -ec \"updateRadius4()\" radius4TF;\n        text -font \"plainLabelFont\" -l \"RANDOM RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.850\" -ec \"updateRandomRadius4()\" randomRadius4TF;\n        text -font \"plainLabelFont\" -l \"PARTICLES RATE:\"; textField -font \"plainLabelFont\" -tx \"10\" -ec \"updateParticleRate4()\" frameRate4TF;\n        separator -style \"none\" -h 5;separator -style \"none\" -h 5;\n    setParent ..; \n    rowColumnLayout -numberOfColumns 3 -columnWidth 1 80 -columnWidth 2 80 -columnWidth 3 80;\n        button -l \"Create Trails\" -c \"createTrails()\"; button -l \"Select Trails\" -c \"selectTrails()\"; button -l \"Trails Visibility\" -c \"toogleVisibleTrails()\";\n    setParent ..;\n    \n//TOOLS\n\n   rowColumnLayout -numberOfColumns 2 -columnWidth 1 120 -columnWidth 2 120;\n        separator -style \"none\" -h 2;separator -style \"none\" -h 2;\n        separator; separator;\n        separator -style \"none\" -h 2;separator -style \"none\" -h 2;\n        button -l \"OBJECT DROPS\" -c \"createObjectWater()\"; button -l \"OBJECT TRAILS\" -c \"createObjectTrails()\";\n        button -l \"REFRESH VALUES\" -c \"refreshValues()\"; button -l \"SET INITIAL STATE\" -c \"initialState()\"; \n    setParent ..; \n    rowColumnLayout -numberOfColumns 3 -columnWidth 1 80 -columnWidth 2 80 -columnWidth 3 80; \n        button -l \"COLLIDE ON\" -c \"collideOn()\"; button -l \"COLLIDE OFF\" -c \"collideOff()\"; button -l \"CACHE\" -c \"cacheParts()\";\n    setParent ..;          \n       \nshowWindow;\n\n\n\n//PROCEDIMIENTOS\n\ncycleCheck -e off;\n\n// Select Driver\n\nglobal proc selectDriver(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"Driver nParticles doesn`t exist.\";\n    } else {\n        int $i = 0;\n        select -cl;\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"driver\" $obj`){\n                select -add $obj;\n            }\n        }\n        pickWalk -d up;\n    }\n}\n\n// Select Sweat\n\nglobal proc selectSweat(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"Sweat nParticles doesn`t exist.\";\n    } else {\n        int $i = 0;\n        select -cl;\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"sweat\" $obj`){\n                select -add $obj;\n            }\n        }\n        pickWalk -d up;\n    }\n}\n\n// Select Water Drops\n\nglobal proc selectWater(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"Water Drops nParticles doesn`t exist.\";\n    } else {\n        int $i = 0;\n        select -cl;\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"water\" $obj`){\n                select -add $obj;\n            }\n        }\n        pickWalk -d up;\n    }\n}\n\n// Select Trails\n\nglobal proc selectTrails(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"Trails nParticles doesn`t exist.\";\n    } else {\n        int $i = 0;\n        select -cl;\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"trail\" $obj`){\n                select -add $obj;\n            }\n        }\n        pickWalk -d up;\n    }\n}\n\n\n// Toogle visibility sweat\n\nglobal proc toogleVisibleSweat(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"sweat\" $obj`){\n                select -r $obj;\n                string $objnPart[] = `pickWalk -d up`;\n                if (`getAttr ($objnPart[0] + \".visibility\")`){\n                    setAttr ($objnPart[0] + \".visibility\") 0;\n                } else {\n                    setAttr ($objnPart[0] + \".visibility\") 1;\n                }                    \n            }\n        }\n    }\n}\n\n// Toogle visibility driver\n\nglobal proc toogleVisibleDriver(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"driver\" $obj`){\n                select -r $obj;\n                string $objnPart[] = `pickWalk -d up`;\n                if (`getAttr ($objnPart[0] + \".visibility\")`){\n                    setAttr ($objnPart[0] + \".visibility\") 0;\n                } else {\n                    setAttr ($objnPart[0] + \".visibility\") 1;\n                }                    \n            }\n        }\n    }\n}\n\n// Toogle visibility water drop\n\nglobal proc toogleVisibleWater(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"water\" $obj`){\n                select -r $obj;\n                string $objnPart[] = `pickWalk -d up`;\n                if (`getAttr ($objnPart[0] + \".visibility\")`){\n                    setAttr ($objnPart[0] + \".visibility\") 0;\n                } else {\n                    setAttr ($objnPart[0] + \".visibility\") 1;\n                }                    \n            }\n        }\n    }\n}\n\n// Toogle visibility trails\n\nglobal proc toogleVisibleTrails(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"trail\" $obj`){\n                select -r $obj;\n                string $objnPart[] = `pickWalk -d up`;\n                if (`getAttr ($objnPart[0] + \".visibility\")`){\n                    setAttr ($objnPart[0] + \".visibility\") 0;\n                } else {\n                    setAttr ($objnPart[0] + \".visibility\") 1;\n                }                    \n            }\n        }\n    }\n}\n\n// Cache\n\nglobal proc cacheParts(){\n    nClothCacheOpt;\n}\n\nglobal proc cacheParts2(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\"){\n                select -r $obj;\n                doCreateNclothCache 4 { \"2\", \"1\", \"10\", \"OneFilePerFrame\", \"1\", \"\",\"0\",\"\",\"0\", \"add\", \"0\", \"1\", \"1\",\"0\",\"1\" } ;\n            }\n        }\n    }\n}\n\n// Set initial state\n\nglobal proc initialState(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\"){\n                select -r $obj;\n                setNClothStartState;\n                performSetNClothStartState 1;\n            }\n        }\n    }\n}\n\n// Collide ON\n\nglobal proc collideOn(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\"){\n                setAttr ($obj + \".collide\") 1;\n            }\n        }\n    }\n}\n\n// Collide OFF\n\nglobal proc collideOff(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\"){\n                setAttr ($obj + \".collide\") 0;\n            }\n        }\n    }\n}\n\n// Group\n\nglobal proc grupo(string $object){\n    if (`objExists Water_Drops_Dynamics_GRP`) {\n        string $parientes[] = `listRelatives -parent $object`;\n        if (size($parientes) == 0){        \n            parent $object Water_Drops_Dynamics_GRP ;            \n        } else {       \n            for ($each in $parientes){\n                if (`gmatch $each \"*Water_Drops_Dynamics_GRP*\"`){\n                } else {\n                    parent $object Water_Drops_Dynamics_GRP ;                \n                }\n            }\n        }\n    } else {\n        string $Grupo = `CreateEmptyGroup`;\n        string $Grupo = `rename Water_Drops_Dynamics_GRP`;\n        parent $object Water_Drops_Dynamics_GRP ;\n    }\n}\n\n// create Seed\n\nglobal proc createSeed(){\n    float $seedNum = `textField -q -tx seedTF`;\n    string $seedExp = \"if (frame == 0){\\n\";\n        $seedExp += \"    seed \";\n        $seedExp += $seedNum;\n        $seedExp += \";\\n\";\n        $seedExp += \"}\\n\";\n    string $seedExpression = `expression -s $seedExp -n \"Seed_Exp\"`;          \n}\n\n// delete Seed\n\nglobal proc deleteSeed(){\n    if (`objExists Seed_Exp`){\n        delete Seed_Exp;\n    }\n}\n\n// update Seed\n\nglobal proc updateSeed(){\n    if (`objExists Seed_Exp`){\n        deleteSeed();\n        createSeed(); \n    } else {\n        createSeed(); \n    }   \n}\n\n// random Seed\n\nglobal proc randomSeed(){\n    if (`objExists Seed_Exp`){\n        deleteSeed();\n        int $seedRandom = rand(99999);\n        string $seedExp = \"if (frame == 0){\\n\";\n            $seedExp += \"    seed \";\n            $seedExp += $seedRandom;\n            $seedExp += \";\\n\";\n            $seedExp += \"}\\n\";\n        string $seedExpression = `expression -s $seedExp -n \"Seed_Exp\"`;  \n        textField -e -tx $seedRandom seedTF;\n    } else {\n        int $seedRandom = rand(99999);\n        string $seedExp = \"if (frame == 0){\\n\";\n            $seedExp += \"    seed \";\n            $seedExp += $seedRandom;\n            $seedExp += \";\\n\";\n            $seedExp += \"}\\n\";\n        string $seedExpression = `expression -s $seedExp -n \"Seed_Exp\"`;  \n        textField -e -tx $seedRandom seedTF;\n    }   \n}\n\n// reset values menu\n\nglobal proc resetValues(){\n\n    textField -e -tx \"10\" count2TF;\n    textField -e -tx \"250\" frameRate2TF;\n    textField -e -tx \"20\" frameEnd2TF;\n    textField -e -tx \"0.200\" radius2TF;\n    textField -e -tx \"0.250\" randomRadius2TF;\n\n    textField -e -tx \"0\" goalU1TF;textField -e -tx \"1\" goalU2TF;\n    textField -e -tx \"0\" goalV1TF;textField -e -tx \"1\" goalV2TF;\n    textField -e -tx \"1\" velocity1TF;textField -e -tx \"2\" velocity2TF;\n    textField -e -tx \"0\" ageOffset1TF;textField -e -tx \"12\" ageOffset2TF;\n    textField -e -tx \"6\" movesTF;\n \n    textField -e -tx \"250\" frameRateTF;\n    textField -e -tx \"20\" frameEndTF;\n    textField -e -tx \"0.100\" radiusTF;\n    textField -e -tx \"0.250\" randomRadiusTF;\n    \n    textField -e -tx \"100\" frameRate3TF;\n    textField -e -tx \"3\" frameEnd3TF;\n    textField -e -tx \"0.250\" radius3TF;\n    textField -e -tx \"0.060\" randomRadius3TF;\n    \n    textField -e -tx \"10\" frameRate4TF;\n    textField -e -tx \"0.060\" radius4TF;\n    textField -e -tx \"0.850\" randomRadius4TF;       \n    \n}\n\n// about menu\n\nglobal proc aboutHelp(){\n    showHelp -absolute \"http://www.marianoantico.blogspot.com/\";\n}\n\n// refresh values\n\nglobal proc refreshValues(){\n    float $frameEnd = `playbackOptions -q -max`;\n    textField -e -tx $frameEnd frameEndTF;\n    textField -e -tx $frameEnd frameEnd2TF;\n    string $Gotas[] = `ls -dag Water_Drops_Dynamics_GRP`;\n    if (size($Gotas) == 0 ){\n        warning \"select an Emitter or Particles.\";\n    } else {   \n        for ($obj in $Gotas){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"pointEmitter\" && `attributeExists \"sweat\" $obj`){\n                float $frameRate = `getAttr ($obj + \".rate\")`;\n                textField -e -tx $frameRate frameRateTF;\n            } else if ($nodeType == \"nParticle\" && `attributeExists \"sweat\" $obj`){\n                float $randRadiusUno = `getAttr ($obj + \".radiusScaleRandomize\")`;\n                textField -e -tx $randRadiusUno randomRadiusTF;\n                float $radiusUno = `getAttr ($obj + \".radius\")`;\n                textField -e -tx $radiusUno radiusTF;\n            } else if ($nodeType == \"pointEmitter\" && `attributeExists \"driver\" $obj`){\n                float $frameRate = `getAttr ($obj + \".rate\")`;\n                textField -e -tx $frameRate frameRate2TF;\n            } else if ($nodeType == \"nParticle\" && `attributeExists \"driver\" $obj`){\n                float $randRadiusUno = `getAttr ($obj + \".radiusScaleRandomize\")`;\n                textField -e -tx $randRadiusUno randomRadius2TF;\n                float $radiusUno = `getAttr ($obj + \".radius\")`;\n                textField -e -tx $radiusUno radius2TF;\n            } \n        }\n    }\n}\n \n// update Radius Sweat\n\nglobal proc updateRadius(){\n    string $sel[] = `ls -sl -dag`;\n    float $radiusUno = `textField -q -tx radiusTF`; \n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"sweat\" $obj`){\n            setAttr ($obj + \".radius\") $radiusUno;\n        }\n    }\n}\n\n// update Radius driver\n\nglobal proc updateRadius2(){\n    string $sel[] = `ls -sl -dag`;\n    float $radiusUno = `textField -q -tx radius2TF`; \n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"driver\" $obj`){\n            setAttr ($obj + \".radius\") $radiusUno;\n        }\n    }\n}\n\n// update Radius water\n\nglobal proc updateRadius3(){\n    string $sel[] = `ls -sl -dag`;\n    float $radiusUno = `textField -q -tx radius3TF`; \n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"water\" $obj`){\n            setAttr ($obj + \".radius\") $radiusUno;\n        }\n    }\n}\n\n// update Radius trails\n\nglobal proc updateRadius4(){\n    string $sel[] = `ls -sl -dag`;\n    float $radiusUno = `textField -q -tx radius4TF`; \n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"trail\" $obj`){\n            setAttr ($obj + \".radius\") $radiusUno;\n        }\n    }\n}\n\n\n// update random Radius Sweat\n\nglobal proc updateRandomRadius(){\n    string $sel[] = `ls -sl -dag`;\n    float $randRadiusUno = `textField -q -tx randomRadiusTF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"sweat\" $obj`){\n            setAttr ($obj + \".radiusScaleRandomize\") $randRadiusUno;\n        }                                 \n    }   \n}\n\n// update random Radius driver\n\nglobal proc updateRandomRadius2(){\n    string $sel[] = `ls -sl -dag`;\n    float $randRadiusUno = `textField -q -tx randomRadius2TF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"driver\" $obj`){\n            setAttr ($obj + \".radiusScaleRandomize\") $randRadiusUno;\n        }                                 \n    }   \n}\n\n// update random Radius water\n\nglobal proc updateRandomRadius3(){\n    string $sel[] = `ls -sl -dag`;\n    float $randRadiusUno = `textField -q -tx randomRadius3TF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"water\" $obj`){\n            setAttr ($obj + \".radiusScaleRandomize\") $randRadiusUno;\n        }                                 \n    }   \n}\n\n// update random Radius trails\n\nglobal proc updateRandomRadius4(){\n    string $sel[] = `ls -sl -dag`;\n    float $randRadiusUno = `textField -q -tx randomRadius4TF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"trail\" $obj`){\n            setAttr ($obj + \".radiusScaleRandomize\") $randRadiusUno;\n        }                                 \n    }   \n}\n\n// update Particle Rate Sweat\n\nglobal proc updateParticleRate(){\n    string $sel[] = `ls -sl -dag`;\n    float $frameRate = `textField -q -tx frameRateTF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"pointEmitter\" && `attributeExists \"sweat\" $obj`){\n            setAttr ($obj + \".rate\") $frameRate;\n        }                                 \n    }   \n}\n\n// update Particle Rate Driver\n\nglobal proc updateParticleRate2(){\n    string $sel[] = `ls -sl -dag`;\n    float $frameRate = `textField -q -tx frameRate2TF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"pointEmitter\" && `attributeExists \"driver\" $obj`){\n            setAttr ($obj + \".rate\") $frameRate;\n        }                                 \n    }   \n}\n\n// update Particle Rate water\n\nglobal proc updateParticleRate3(){\n    string $sel[] = `ls -sl -dag`;\n    float $frameRate = `textField -q -tx frameRate3TF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"pointEmitter\" && `attributeExists \"water\" $obj`){\n            setAttr ($obj + \".rate\") $frameRate;\n        }                                 \n    }   \n}\n\n// update Particle Rate trails\n\nglobal proc updateParticleRate4(){\n    string $sel[] = `ls -sl -dag`;\n    float $frameRate = `textField -q -tx frameRate4TF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"pointEmitter\" && `attributeExists \"trail\" $obj`){\n            setAttr ($obj + \".rate\") $frameRate;\n        }                                 \n    }   \n}\n\n// update Frame End Sweat\n\nglobal proc updateFrameEnd(){\n    int $frameEndGotasFijas = `textField -q -tx frameEndTF`;\n    playbackOptions -aet $frameEndGotasFijas -max $frameEndGotasFijas;  \n}\n\n// update Frame End Driver\n\nglobal proc updateFrameEnd2(){\n    int $frameEndGotasFijas = `textField -q -tx frameEnd2TF`;\n    playbackOptions -aet $frameEndGotasFijas -max $frameEndGotasFijas;  \n}\n\n// update Frame End water\n\nglobal proc updateFrameEnd3(){\n    int $frameEndGotasFijas = `textField -q -tx frameEnd3TF`;\n    playbackOptions -aet $frameEndGotasFijas -max $frameEndGotasFijas;  \n}\n\n//Apply gotas Fijas\n\nglobal proc gotasFijasApply(string $nParticles, string $emitter, string $object){\n    if (`window -ex GotasFijasOk`) {\n      deleteUI -window GotasFijasOk;\n    }\n    if (`objExists Gotas_Fijas_Exp`){\n       delete Gotas_Fijas_Exp;\n    }\n    select -r $nParticles;\n    string $gotasFijasPartsRename = `rename ($object + \"_Sweat_nParticles\")`;\n    select -r $emitter;\n    string $gotasFijasEmitter[] = `ls -sl`;\n    string $gotasFijasEmitterRename = `rename ($object + \"_Sweat_Emitter\")`;\n    emitter -e -r 0 $gotasFijasEmitterRename;\n    select -r $gotasFijasPartsRename;\n    setNClothStartState;\n    performSetNClothStartState 1;\n    currentTime -edit 0;\n    select -r $object;\n}\n\n//Cancel gotas Fijas\n\nglobal proc gotasFijasCancel(){\n    if (`window -ex GotasFijasOk`) {\n        deleteUI -window GotasFijasOk;\n    }\n    currentTime -edit 0;\n}\n\n//Create Sweat Particles\n\nglobal proc createParts(){\n    string $fileNew = \"\";    \n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select an object.\";\n    } else {\n        if (`objExists Gotas_Fijas_Exp`){\n            delete Gotas_Fijas_Exp;\n        }\n        if (`objExists Driver_Gotas_Exp`){\n            delete Driver_Gotas_Exp;\n        }\n        if (`objExists Trails_Exp`){\n            delete Trails_Exp;\n        }\n        if (`objExists Water_Drops_Exp`){\n            delete Water_Drops_Exp;\n        }        \n        select -r $selObjShort[0];\n        grupo($selObjShort[0]);\n        float $radiusUno = `textField -q -tx radiusTF`;\n        float $randRadiusUno = `textField -q -tx randomRadiusTF`;\n        float $frameRate = `textField -q -tx frameRateTF`;\n        int $frameEndGotasFijas = `textField -q -tx frameEndTF`;\n        NParticleMenu MayaWindow|mainNParticleMenu;       \n        updateNParticleStyleMenu \"Water\";\n        string $emisorUno[] = `emitter -type surf -r $frameRate -sro 0 -nuv 0 -cye none -cyi 1 -spd 0 -srn 0 -nsp 0 -tsp 0 -mxd 0 -mnd 0 -dx 1 -dy 0 -dz 0 -sp 0 -n ($selObjShort[0] + \"_Sweat_Creation_Emitter\")`;\n        setAttr ($emisorUno[1] + \".enableTextureRate\") 1;\n        addAttr -h 0 -ln \"sweat\" -at double $emisorUno[1];\n        string $particulasUno[] = `nParticle -n ($selObjShort[0] + \"_Sweat_Creation_nParticles\")`;\n        addAttr -h 0 -ln \"sweat\" -at double $particulasUno[1];     \n        connectDynamic -em $emisorUno[0] $particulasUno[0];\n        grupo($particulasUno[0]);\n\n        string $nucleus[] = `listConnections -d 1 -s 1 ($particulasUno[0] + \".currentState\")`;\n\n        setAttr ($nucleus[0] + \".gravity\") 0;\n        event -name \"Die_Event\" -die 1 -count 0 $particulasUno[0];\n        setAttr ($particulasUno[0] + \".radiusScaleSPH\") 0;\n        setAttr ($particulasUno[0] + \".radius\") $radiusUno;\n        setAttr ($particulasUno[0] + \".radiusScaleInput\") 5;\n        setAttr ($particulasUno[0] + \".radiusScaleRandomize\") $randRadiusUno;\n\n        string $fileNew = `shadingNode -asTexture file -n ($selObjShort[0] + \"_Sweat_Texture_Rate_File\")`;\n        string $place2dNew = `shadingNode -asUtility place2dTexture`;\n        connectAttr -f ($place2dNew + \".coverage\") ($fileNew + \".coverage\");\n        connectAttr -f ($place2dNew + \".translateFrame\") ($fileNew + \".translateFrame\");\n        connectAttr -f ($place2dNew + \".rotateFrame\") ($fileNew + \".rotateFrame\");\n        connectAttr -f ($place2dNew + \".mirrorU\") ($fileNew + \".mirrorU\");\n        connectAttr -f ($place2dNew + \".mirrorV\") ($fileNew + \".mirrorV\");\n        connectAttr -f ($place2dNew + \".stagger\") ($fileNew + \".stagger\");\n        connectAttr -f ($place2dNew + \".wrapU\") ($fileNew + \".wrapU\");\n        connectAttr -f ($place2dNew + \".wrapV\") ($fileNew + \".wrapV\");\n        connectAttr -f ($place2dNew + \".repeatUV\") ($fileNew + \".repeatUV\");\n        connectAttr -f ($place2dNew + \".offset\") ($fileNew + \".offset\");\n        connectAttr -f ($place2dNew + \".rotateUV\") ($fileNew + \".rotateUV\");\n        connectAttr -f ($place2dNew + \".noiseUV\") ($fileNew + \".noiseUV\");\n        connectAttr -f ($place2dNew + \".vertexUvOne\") ($fileNew + \".vertexUvOne\");\n        connectAttr -f ($place2dNew + \".vertexUvTwo\") ($fileNew + \".vertexUvTwo\");\n        connectAttr -f ($place2dNew + \".vertexUvThree\") ($fileNew + \".vertexUvThree\");\n        connectAttr -f ($place2dNew + \".vertexCameraOne\") ($fileNew + \".vertexCameraOne\");\n        connectAttr -f ($place2dNew + \".outUV\") ($fileNew + \".uv\");\n        connectAttr -f ($place2dNew + \".outUvFilterSize\") ($fileNew + \".uvFilterSize\");\n        string $DirName = `workspace -q -fullName`;\n        string $openFileName[] = `fileDialog2  -caption \"Please select a texture rate map.\" -fileMode 1 -startingDirectory $DirName -fileFilter \"*.*\"`;\n        setAttr -type \"string\" ($fileNew + \".fileTextureName\") (substituteAllString($openFileName[0], ($DirName + \"/\"), \"\"));\n        connectAttr -f ($fileNew + \".outColor\") ($emisorUno[1] + \".textureRate\");\n\n        currentTime -edit 0;\n        if ($frameEndGotasFijas > (`playbackOptions -q -max`)){\n            playbackOptions -aet $frameEndGotasFijas -max $frameEndGotasFijas;\n        }        \n\n        string $gotasFijasVentana = \"if (frame == \";\n            $gotasFijasVentana += $frameEndGotasFijas;\n            $gotasFijasVentana += \"){\\n\";\n            $gotasFijasVentana += \"    play -state off;\\n\";\n            $gotasFijasVentana += (\"    select \" + $particulasUno[0] + \";\\n\");\n            $gotasFijasVentana += \"    if (`window -ex GotasFijasOk`) {\\n\";\n            $gotasFijasVentana += \"        deleteUI -window GotasFijasOk;\\n\";\n            $gotasFijasVentana += \"    }\\n\";\n            $gotasFijasVentana += \"    window -s 0 -t \\\"SWEAT\\\" -w 350 -h 250 -minimizeButton false  -maximizeButton false GotasFijasOk;\\n\";\n            $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"            text -font \\\"boldLabelFont\\\" -l \\\"APPLY INITIAL STATE?\\\";\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 5 -columnWidth 1 10 -columnWidth 2 80 -columnWidth 3 10 -columnWidth 4 80 -columnWidth 5 10;\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"            global proc Aplicar(){\\n\";\n            $gotasFijasVentana += (\"                gotasFijasApply(\\\"\" + $particulasUno[0] + \"\\\",\\\"\" + $emisorUno[1] + \"\\\",\\\"\" + $selObjShort[0] + \"\\\");\\n\");\n            $gotasFijasVentana += \"            }\\n\";\n            $gotasFijasVentana += \"            button -l \\\"APPLY\\\" -c \\\"Aplicar()\\\";\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";            \n            $gotasFijasVentana += \"            button -l \\\"CANCEL\\\" -c\\\"gotasFijasCancel()\\\";\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"    showWindow;\\n\";\n            $gotasFijasVentana += \"}\\n\";\n\n        string $play = `expression -s $gotasFijasVentana -n \"Gotas_Fijas_Exp\"`;\n        play -forward true;\n    }\n}\n\n//Apply Driver gotas \n\nglobal proc driverGotasApply(string $nParticles, string $emitter, string $object){\n    if (`window -ex GotasFijasOk`) {\n      deleteUI -window GotasFijasOk;\n    }\n    if (`objExists Driver_Gotas_Exp`){\n       delete Driver_Gotas_Exp;\n    }\n    select -r $nParticles;\n    string $DriverPartsRename = `rename ($object + \"_Driver_Drops_nParticles\")`;\n    select -r $emitter;\n    string $DriverEmitterRename = `rename ($object + \"_Driver_Drops_Emitter\")`;\n    emitter -e -r 0 $DriverEmitterRename;\n    select -r $DriverPartsRename;\n    string $PartisShape[] = `ls -dag $DriverPartsRename`;\n    setNClothStartState;\n    performSetNClothStartState 1;\n    currentTime -edit 0;\n    setAttr ($DriverPartsRename + \".collide\") 1;\n    string $GotasCaenMoveExpression = \"\";    \n    int $moves = `textField -q -tx movesTF`;\n    for ($i=0; $i< ($moves + 1);$i++){\n        int $randExpressions = rand(2.99);           \n        int $j = $i + 1;\n        float $velocity1 = `textField -q -tx velocity1TF`;\n        float $velocity2 = `textField -q -tx velocity2TF`;\n        float $randFreno = rand(($velocity1*.005),($velocity2*.005));\n        float $randXMove = rand(0.0002,0.0009);\n        float $randCaida = rand(0.0025,0.0085);\n        float $randTimes = rand(0.0055,0.0095);\n        float $randMultiply = rand(8,12);\n        float $randNoiseX = rand(.12,.35);\n\n        if ($randExpressions == 0){    \n\n            $GotasCaenMoveExpression += (\"if (\" + $PartisShape[1] + \".randMov > \" + $i + \" && \" +  $PartisShape[1] + \".randMov < \" + $j + \"){\\n\");\n            $GotasCaenMoveExpression += (\"    if (frame > \" + $PartisShape[1] + \".startOffset){\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalV -= abs(sin(time*(noise(time/\" + $PartisShape[1] + \".randSin)*\" + $randMultiply + \"))*\" + $randFreno +\");\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalU += (sin(time*(gauss(time/\" + $PartisShape[1] + \".randSin)*\" + $randNoiseX + \"))*\" + $randXMove + \");\\n\");\n            $GotasCaenMoveExpression += (\"        if (\" + $PartisShape[1] + \".goalV < \" + $randCaida + \"){\\n\");\n           \t$GotasCaenMoveExpression +=\t(\"            if (\" + $PartisShape[1] + \".goalPP > 0.06){\\n\");\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] +\t\".goalPP -= 0.05;\\n\");\n            $GotasCaenMoveExpression += \"            } else {\\n\";\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".goalPP = 0.1;\\n\");\n//            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".lifespanPP = 0;\\n\");\n            $GotasCaenMoveExpression += \"            }\\n\";\n            $GotasCaenMoveExpression += \"        }\\n\";\n            $GotasCaenMoveExpression += \"    }\\n\";\n            $GotasCaenMoveExpression += \"}\\n\";\n        \n        } else if ($randExpressions == 1){    \n\n            $GotasCaenMoveExpression += (\"if (\" + $PartisShape[1] + \".randMov > \" + $i + \" && \" +  $PartisShape[1] + \".randMov < \" + $j + \"){\\n\");\n            $GotasCaenMoveExpression += (\"    if (frame > \" + $PartisShape[1] + \".startOffset){\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalV -= abs(sin(time/\" + $PartisShape[1] + \".randSin)*\" + $randFreno +\");\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalU += (noise(time)/\" + $PartisShape[1] + \".randSin)*\" + $randXMove + \";\\n\");\n            $GotasCaenMoveExpression += (\"        if (\" + $PartisShape[1] + \".goalV < \" + $randCaida + \"){\\n\");\n           \t$GotasCaenMoveExpression +=\t(\"            if (\" + $PartisShape[1] + \".goalPP > 0.06){\\n\");\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] +\t\".goalPP -= 0.05;\\n\");\n            $GotasCaenMoveExpression += \"            } else {\\n\";\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".goalPP = 0.1;\\n\");\n//            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".lifespanPP = 0;\\n\");\n            $GotasCaenMoveExpression += \"            }\\n\";\n            $GotasCaenMoveExpression += \"        }\\n\";\n            $GotasCaenMoveExpression += \"    }\\n\";\n            $GotasCaenMoveExpression += \"}\\n\";\n        \n        } else if ($randExpressions == 2){    \n\n            $GotasCaenMoveExpression += (\"if (\" + $PartisShape[1] + \".randMov > \" + $i + \" && \" +  $PartisShape[1] + \".randMov < \" + $j + \"){\\n\");\n            $GotasCaenMoveExpression += (\"    if (frame > \" + $PartisShape[1] + \".startOffset){\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalV -= abs(( sin(time/\" + $PartisShape[1] + \".randSin)*cos(sin(time/\" + $PartisShape[1] + \".randSin*3.14))/atan(3.14/\" + $PartisShape[1] + \".randSin))*\" + $randFreno + \");\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalU += (noise(time)/\" + $PartisShape[1] + \".randSin*\" + ($randFreno*.1) + \");\\n\");\n            $GotasCaenMoveExpression += (\"        if (\" + $PartisShape[1] + \".goalV < \" + $randCaida + \"){\\n\");\n           \t$GotasCaenMoveExpression +=\t(\"            if (\" + $PartisShape[1] + \".goalPP > 0.06){\\n\");\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] +\t\".goalPP -= 0.05;\\n\");\n            $GotasCaenMoveExpression += \"            } else {\\n\";\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".goalPP = 0.1;\\n\");\n//            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".lifespanPP = 0;\\n\");\n            $GotasCaenMoveExpression += \"            }\\n\";\n            $GotasCaenMoveExpression += \"        }\\n\";\n            $GotasCaenMoveExpression += \"    }\\n\";\n            $GotasCaenMoveExpression += \"}\\n\";\n\n        } else if ($randExpressions == 3){    \n\n            $GotasCaenMoveExpression += (\"if (\" + $PartisShape[1] + \".randMov > \" + $i + \" && \" +  $PartisShape[1] + \".randMov < \" + $j + \"){\\n\");\n            $GotasCaenMoveExpression += (\"    if (frame > \" + $PartisShape[1] + \".startOffset){\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalV -= abs(sin(time*(noise(time/\" + $PartisShape[1] + \".randSin)*\" + $randMultiply + \"))*\" + $randFreno +\");\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalU += (sin(time*(gauss(time/\" + $PartisShape[1] + \".randSin)*\" + $randNoiseX + \"))*\" + $randXMove + \");\\n\");\n            $GotasCaenMoveExpression += (\"        if (\" + $PartisShape[1] + \".goalV < \" + $randCaida + \"){\\n\");\n           \t$GotasCaenMoveExpression +=\t(\"            if (\" + $PartisShape[1] + \".goalPP > 0.06){\\n\");\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] +\t\".goalPP -= 0.05;\\n\");\n            $GotasCaenMoveExpression += \"            } else {\\n\";\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".goalPP = 0.1;\\n\");\n//            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".lifespanPP = 0;\\n\");\n            $GotasCaenMoveExpression += \"            }\\n\";\n            $GotasCaenMoveExpression += \"        }\\n\";\n            $GotasCaenMoveExpression += \"    }\\n\";\n            $GotasCaenMoveExpression += \"}\\n\";\n\n        } \n    }\n    dynExpression -s $GotasCaenMoveExpression -rbd $PartisShape[1];\n}\n\n//Cancel driver gotas\n\nglobal proc driverGotasCancel(){\n    if (`window -ex GotasFijasOk`) {\n        deleteUI -window GotasFijasOk;\n    }\n    currentTime -edit 0;\n}\n\n//Create Driver Drops Particles\n\nglobal proc createDrops(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select a goal object.\";\n    } else {\n        if (`objExists Gotas_Fijas_Exp`){\n            delete Gotas_Fijas_Exp;\n        }\n        if (`objExists Driver_Gotas_Exp`){\n            delete Driver_Gotas_Exp;\n        }\n        if (`objExists Trails_Exp`){\n            delete Trails_Exp;\n        }\n        if (`objExists Water_Drops_Exp`){\n            delete Water_Drops_Exp;\n        }\n        select -r $selObjShort[0];\n        grupo($selObjShort[0]);     \n        float $radiusUno = `textField -q -tx radius2TF`;\n        float $randRadiusUno = `textField -q -tx randomRadius2TF`;\n        float $frameRate = `textField -q -tx frameRate2TF`;\n        int $maxCount = `textField -q -tx count2TF`;        \n        int $frameEndDriverGotas = `textField -q -tx frameEnd2TF`;\n        if ($frameEndDriverGotas > (`playbackOptions -q -max`)){\n            playbackOptions -aet $frameEndDriverGotas -max $frameEndDriverGotas;\n        }\n        NParticleMenu MayaWindow|mainNParticleMenu;       \n        updateNParticleStyleMenu \"Water\";\n        select -cl;\n        string $emisorCaida[] = `emitter -type omni -r $frameRate -sro 0 -nuv 0 -cye none -cyi 1 -spd 0 -srn 0 -nsp 0 -tsp 0 -mxd 0 -mnd 0 -dx 1 -dy 0 -dz 0 -sp 0 -n ($selObjShort[0] + \"_Driver_Drops_Creation_Emitter\")`;\n        string $particulasCaida[] = `nParticle -n ($selObjShort[0] + \"_Driver_Drops_Creation_nParticles\")`;\n        addAttr -h 0 -ln \"driver\" -at double $emisorCaida[0];\n        addAttr -h 0 -ln \"driver\" -at double $particulasCaida[1];        \n        connectDynamic -em $emisorCaida[0] $particulasCaida[0];\n//        string $gravity[] = `gravity -pos 0 0 0 -m 9.8 -att 0 -dx 0 -dy -1 -dz 0  -mxd -1  -vsh none -vex 0 -vof 0 0 0 -vsw 360 -tsr 0.5 -n ($selObjShort[0] + \"_Driver_Drops_Gravity\")`;\n//        connectDynamic -f $gravity[0]  $particulasCaida[1];        \n//        grupo($gravity[0]);\n        grupo($emisorCaida[0]);\n        grupo($particulasCaida[0]);\n        string $nucleus[] = `listConnections -d 1 -s 1 ($particulasCaida[0] + \".currentState\")`;\n\n        setAttr ($nucleus[0] + \".gravity\") 0;\n        setAttr ($particulasCaida[0] + \".maxCount\") $maxCount;\n        setAttr ($particulasCaida[0] + \".radiusScaleSPH\") 0;\n        setAttr ($particulasCaida[0] + \".radius\") $radiusUno;\n        setAttr ($particulasCaida[0] + \".radiusScaleInput\") 5;\n        setAttr ($particulasCaida[0] + \".radiusScaleRandomize\") $randRadiusUno;\n        goal -w 0.5 -utr 0   -g $selObjShort[0]  $particulasCaida[0];\n        setAttr ($particulasCaida[0] + \".collide\") 1;\n        setAttr ($particulasCaida[0] + \".conserve\") 1;\n        setAttr ($particulasCaida[0] + \".goalSmoothness\") 0.001;\n        setAttr ($particulasCaida[0] + \".goalWeight[0]\") 1;\n        setAttr ($particulasCaida[0] + \".lifespanMode\") 3;\n        setAttr ($particulasCaida[0] + \".collideWidthScale\") 0.6;        \n\n        addAttr -ln goalU -dt doubleArray $particulasCaida[1];\n        addAttr -ln goalU0 -dt doubleArray $particulasCaida[1];\n        addAttr -ln goalV -dt doubleArray $particulasCaida[1];\n        addAttr -ln goalV0 -dt doubleArray $particulasCaida[1];\n        addAttr -ln \"randSin0\"  -dt doubleArray  $particulasCaida[1];\n        addAttr -ln \"randSin\"  -dt doubleArray  $particulasCaida[1];\n        setAttr -e-keyable true ($particulasCaida[1] + \".randSin\");\n        addAttr -ln \"randMov0\"  -dt doubleArray  $particulasCaida[1];\n        addAttr -ln \"randMov\"  -dt doubleArray  $particulasCaida[1];\n        setAttr -e-keyable true ($particulasCaida[1] + \".randMov\");\n        addAttr -ln \"startOffset0\"  -dt doubleArray  $particulasCaida[1];\n        addAttr -ln \"startOffset\"  -dt doubleArray  $particulasCaida[1];\n        setAttr -e-keyable true ($particulasCaida[1] + \".startOffset\");\n        \n        string $GotasCaenCreationExpression = ($particulasCaida[1] + \".goalPP = 1;\\n\");\n            $GotasCaenCreationExpression += ($particulasCaida[1] + \".randSin = rand(\" + (`textField -q -tx velocity1TF`) + \",\" + (`textField -q -tx velocity2TF`) + \");\\n\");\n            $GotasCaenCreationExpression += ($particulasCaida[1] + \".startOffset = rand(\" + (`textField -q -tx ageOffset1TF`) + \",\" + (`textField -q -tx ageOffset2TF`) + \");\\n\");\n            $GotasCaenCreationExpression += ($particulasCaida[1] + \".goalU = rand(\" + (`textField -q -tx goalU1TF`) + \",\" + (`textField -q -tx goalU2TF`) + \");\\n\");\n            $GotasCaenCreationExpression += ($particulasCaida[1] + \".goalV = rand(\" + (`textField -q -tx goalV1TF`) + \",\" + (`textField -q -tx goalV2TF`) + \");\\n\");\n            $GotasCaenCreationExpression += ($particulasCaida[1] + \".randMov = rand(0,\" + (`textField -q -tx movesTF`) + \".99);\\n\");\n\n        string $CreationExp = `dynExpression -c -s $GotasCaenCreationExpression`;        \n\n        string $gotasFijasVentana = \"if (frame == \";\n            $gotasFijasVentana += $frameEndDriverGotas;\n            $gotasFijasVentana += \"){\\n\";\n            $gotasFijasVentana += \"    play -state off;\\n\";\n            $gotasFijasVentana += (\"    select \" + $particulasCaida[0] + \";\\n\");\n            $gotasFijasVentana += \"    if (`window -ex GotasFijasOk`) {\\n\";\n            $gotasFijasVentana += \"        deleteUI -window GotasFijasOk;\\n\";\n            $gotasFijasVentana += \"    }\\n\";\n            $gotasFijasVentana += \"    window -s 0 -t \\\"DRIVER WATER DROPS\\\" -w 350 -h 250 -minimizeButton false  -maximizeButton false GotasFijasOk;\\n\";\n            $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"            text -font \\\"boldLabelFont\\\" -l \\\"APPLY INITIAL STATE?\\\";\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 5 -columnWidth 1 10 -columnWidth 2 80 -columnWidth 3 10 -columnWidth 4 80 -columnWidth 5 10;\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"            global proc Aplicar(){\\n\";\n            $gotasFijasVentana += (\"                driverGotasApply(\\\"\" + $particulasCaida[0] + \"\\\",\\\"\" + $emisorCaida[0] + \"\\\",\\\"\" + $selObjShort[0] + \"\\\");\\n\");\n            $gotasFijasVentana += \"            }\\n\";\n            $gotasFijasVentana += \"            button -l \\\"APPLY\\\" -c\\\"Aplicar()\\\";\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";            \n            $gotasFijasVentana += \"            button -l \\\"CANCEL\\\" -c\\\"driverGotasCancel()\\\";\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"    showWindow;\\n\";\n            $gotasFijasVentana += \"}\\n\";\n\n        string $playDriver = `expression -s $gotasFijasVentana -n \"Driver_Gotas_Exp\"`;\n        play -forward true;\n  \n        currentTime -edit 0;\n        play -forward true;\n    }\n}\n\n//Apply water drops\n\nglobal proc waterDropsApply(string $nParticles, string $emitter, string $object){\n    if (`window -ex GotasFijasOk`) {\n      deleteUI -window GotasFijasOk;\n    }\n    if (`objExists Water_Drops_Exp`){\n       delete Water_Drops_Exp;\n    }\n    select -r $nParticles;\n    string $gotasFijasPartsRename = `rename \"Water_Drops_nParticles\"`;\n    select -r $emitter;\n    string $gotasFijasEmitter[] = `ls -sl`;\n    string $gotasFijasEmitterRename = `rename \"Water_Drops_Emitter\"`;\n    select -r $gotasFijasPartsRename;\n    setNClothStartState;\n    performSetNClothStartState 1;\n    currentTime -edit 0;\n    select -r $object;\n}\n\n//Cancel water Drops\n\nglobal proc waterDropsCancel(){\n    if (`window -ex GotasFijasOk`) {\n        deleteUI -window GotasFijasOk;\n    }\n    currentTime -edit 0;\n}\n\n//Create Water Drops Particles\n\nglobal proc createWater(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select Driver Drops Particles.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" /*&& `attributeExists \"driver\" $obj`*/){\n                if (`objExists Gotas_Fijas_Exp`){\n                    delete Gotas_Fijas_Exp;\n                }\n                if (`objExists Driver_Gotas_Exp`){\n                    delete Driver_Gotas_Exp;\n                }\n                if (`objExists Trails_Exp`){\n                    delete Trails_Exp;\n                }\n                if (`objExists Water_Drops_Exp`){\n                    delete Water_Drops_Exp;\n                }\n                float $radiusUno = `textField -q -tx radius3TF`;\n                float $randRadiusUno = `textField -q -tx randomRadius3TF`;\n                float $frameRate = `textField -q -tx frameRate3TF`;\n                int $frameEndDriverGotas = `textField -q -tx frameEnd3TF`;\n                if ($frameEndDriverGotas > (`playbackOptions -q -max`)){\n                    playbackOptions -aet $frameEndDriverGotas -max $frameEndDriverGotas;\n                }\n                NParticleMenu MayaWindow|mainNParticleMenu;       \n                updateNParticleStyleMenu \"Water\";\n                string $emisorCaida[] = `emitter -type omni -r $frameRate -sro 0 -nuv 0 -cye none -cyi 1 -spd 0 -srn 0 -nsp 0 -tsp 0 -mxd 0 -mnd 0 -dx 1 -dy 0 -dz 0 -sp 0 -n \"Water_Drops_Creation_Emitter\"`;\n                string $particulasCaida[] = `nParticle -n \"Water_Drops_Creation_nParticles\"`;\n                addAttr -h 0 -ln \"water\" -at double $emisorCaida[1];\n                addAttr -h 0 -ln \"water\" -at double $particulasCaida[1];        \n                connectDynamic -em $emisorCaida[1] $particulasCaida[0];\n        //        string $gravity[] = `gravity -pos 0 0 0 -m 9.8 -att 0 -dx 0 -dy -1 -dz 0  -mxd -1  -vsh none -vex 0 -vof 0 0 0 -vsw 360 -tsr 0.5 -n ($selObjShort[0] + \"_Driver_Drops_Gravity\")`;\n        //        connectDynamic -f $gravity[0]  $particulasCaida[1];        \n        //        grupo($gravity[0]);\n                grupo($particulasCaida[0]);\n                string $nucleus[] = `listConnections -d 1 -s 1 ($particulasCaida[0] + \".currentState\")`;\n        \n                setAttr ($nucleus[0] + \".gravity\") 0;\n                setAttr ($emisorCaida[1] + \".emitterType\") 0;\n                setAttr ($emisorCaida[1] + \".spread\") 1;\n                setAttr ($emisorCaida[1] + \".directionX\") 0;\n                setAttr ($emisorCaida[1] + \".speed\") 0;\n\n\n                setAttr ($particulasCaida[0] + \".radius\") $radiusUno;\n                setAttr ($particulasCaida[0] + \".radiusScaleRandomize\") $randRadiusUno;\n                setAttr ($particulasCaida[0] + \".collide\") 0;\n                setAttr ($particulasCaida[0] + \".lifespanMode\") 1;\n                setAttr ($particulasCaida[0] + \".radiusScale[0].radiusScale_Position\") 0;\n                setAttr ($particulasCaida[0] + \".radiusScale[0].radiusScale_FloatValue\") 1;\n                setAttr ($particulasCaida[0] + \".radiusScale[0].radiusScale_Interp\") 2;\n                setAttr ($particulasCaida[0] + \".radiusScale[1].radiusScale_Position\") 0.252174;\n                setAttr ($particulasCaida[0] + \".radiusScale[1].radiusScale_FloatValue\") 0.44;\n                setAttr ($particulasCaida[0] + \".radiusScale[1].radiusScale_Interp\") 2;\n                setAttr ($particulasCaida[0] + \".radiusScale[2].radiusScale_Position\") 0.521739;\n                setAttr ($particulasCaida[0] + \".radiusScale[2].radiusScale_FloatValue\") 0;\n                setAttr ($particulasCaida[0] + \".radiusScale[2].radiusScale_Interp\") 2;\n                setAttr ($particulasCaida[0] + \".radiusScaleInput\") 1;\n                setAttr ($particulasCaida[0] + \".radiusScaleInputMax\") 2.808989;\n                setAttr ($particulasCaida[0] + \".radiusScaleRandomize\") 0.060;\n                setAttr ($particulasCaida[0] + \".radiusScaleSPH\") 0;         \n                \n                string $gotasFijasVentana = \"if (frame == \";\n                    $gotasFijasVentana += $frameEndDriverGotas;\n                    $gotasFijasVentana += \"){\\n\";\n                    $gotasFijasVentana += \"    play -state off;\\n\";\n                    $gotasFijasVentana += (\"    select \" + $particulasCaida[0] + \";\\n\");\n                    $gotasFijasVentana += \"    if (`window -ex GotasFijasOk`) {\\n\";\n                    $gotasFijasVentana += \"        deleteUI -window GotasFijasOk;\\n\";\n                    $gotasFijasVentana += \"    }\\n\";\n                    $gotasFijasVentana += \"    window -s 0 -t \\\"DRIVER WATER DROPS\\\" -w 350 -h 250 -minimizeButton false  -maximizeButton false GotasFijasOk;\\n\";\n                    $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"            text -font \\\"boldLabelFont\\\" -l \\\"APPLY INITIAL STATE?\\\";\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 5 -columnWidth 1 10 -columnWidth 2 80 -columnWidth 3 10 -columnWidth 4 80 -columnWidth 5 10;\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"            global proc Aplicar(){\\n\";\n                    $gotasFijasVentana += (\"                waterDropsApply(\\\"\" + $particulasCaida[0] + \"\\\",\\\"\" + $emisorCaida[1] + \"\\\",\\\"\" + $selObjShort[0] + \"\\\");\\n\");\n                    $gotasFijasVentana += \"            }\\n\";\n                    $gotasFijasVentana += \"            button -l \\\"APPLY\\\" -c\\\"Aplicar()\\\";\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";            \n                    $gotasFijasVentana += \"            button -l \\\"CANCEL\\\" -c\\\"waterDropsCancel()\\\";\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"    showWindow;\\n\";\n                    $gotasFijasVentana += \"}\\n\";\n        \n                string $playDriver = `expression -s $gotasFijasVentana -n \"Water_Drops_Exp\"`;\n                play -forward true;\n          \n                currentTime -edit 0;\n                play -forward true;\n                \n            } else {\n                warning \"select Driver Drops Particles.\";\n            }\n        }       \n    }\n}\n\n\n//Create Trails Particles\n\nglobal proc createTrails(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n                currentTime -edit 0;\n    if (size($selObjShort) == 0 ){\n        warning \"select Driver Drops Particles.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" /*&& `attributeExists \"driver\" $obj`*/){\n                if (`objExists Gotas_Fijas_Exp`){\n                    delete Gotas_Fijas_Exp;\n                }\n                if (`objExists Driver_Gotas_Exp`){\n                    delete Driver_Gotas_Exp;\n                }\n                if (`objExists Trails_Exp`){\n                    delete Trails_Exp;\n                }\n                if (`objExists Water_Drops_Exp`){\n                    delete Water_Drops_Exp;\n                }\n                float $radiusUno = `textField -q -tx radius4TF`;\n                float $randRadiusUno = `textField -q -tx randomRadius4TF`;\n                float $frameRate = `textField -q -tx frameRate4TF`;\n                NParticleMenu MayaWindow|mainNParticleMenu;       \n                updateNParticleStyleMenu \"Water\";\n                string $emisorCaida[] = `emitter -type omni -r $frameRate -sro 0 -nuv 0 -cye none -cyi 1 -spd 0 -srn 0 -nsp 0 -tsp 0 -mxd 0 -mnd 0 -dx 1 -dy 0 -dz 0 -sp 0 -n \"Water_Trails_Creation_Emitter\"`;\n                string $particulasCaida[] = `nParticle -n \"Water_Trails_Creation_nParticles\"`;\n                addAttr -h 0 -ln \"trail\" -at double $emisorCaida[1];\n                addAttr -h 0 -ln \"trail\" -at double $particulasCaida[1];        \n                connectDynamic -em $emisorCaida[1] $particulasCaida[0];\n        //        string $gravity[] = `gravity -pos 0 0 0 -m 9.8 -att 0 -dx 0 -dy -1 -dz 0  -mxd -1  -vsh none -vex 0 -vof 0 0 0 -vsw 360 -tsr 0.5 -n ($selObjShort[0] + \"_Driver_Drops_Gravity\")`;\n        //        connectDynamic -f $gravity[0]  $particulasCaida[1];        \n        //        grupo($gravity[0]);\n                grupo($particulasCaida[0]);\n                string $nucleus[] = `listConnections -d 1 -s 1 ($particulasCaida[0] + \".currentState\")`;\n        \n                setAttr ($nucleus[0] + \".gravity\") 0;\n                setAttr ($emisorCaida[1] + \".speed\") 0;\n                select -r $emisorCaida[1];\n                string $gotasFijasEmitterRename = `rename \"Water_Trails_Emitter\"`; \n                                \n                select -r $particulasCaida[0];\n                setAttr ($particulasCaida[0] + \".radius\") $radiusUno;\n                setAttr ($particulasCaida[0] + \".radiusScaleRandomize\") $randRadiusUno;\n                setAttr ($particulasCaida[0] + \".collide\") 0;\n                setAttr ($particulasCaida[0] + \".radiusScaleSPH\") 0;\n\n                select -r $particulasCaida[0];\n                string $TrailsPartisRename = `rename \"Water_Trails_nParticles\"`;\n  \n\n                string $TrailExpression = \"if (frame == 1){\\n\";\n                    $TrailExpression += \"    play -state off;\\n\";\n                    $TrailExpression += (\"    setAttr \" + $TrailsPartisRename + \".radiusScaleInput 5;\\n\");\n                    $TrailExpression += \"}\";\n                \n                string $playDriver = `expression -s $TrailExpression -n \"Trails_Exp\"`;\n                \n                for ($i = 0; $i < 2; $i++){\n                    currentTime -edit $i;\n                }    \n\n                currentTime -edit 0;\n\n                if (`objExists Trails_Exp`){\n                    delete Trails_Exp;\n                }\n         \n            }\n        }       \n    }\n}\n\n//Apply water drops\n\nglobal proc waterDropsObjectApply(string $nParticles, string $emitter, string $object){\n    if (`window -ex GotasFijasOk`) {\n      deleteUI -window GotasFijasOk;\n    }\n    if (`objExists Water_Drops_Exp`){\n       delete Water_Drops_Exp;\n    }\n    select -r $nParticles;\n    string $gotasFijasPartsRename = `rename ($object + \"_Water_Drops_nParticles\")`;\n    select -r $emitter;\n    string $gotasFijasEmitter[] = `ls -sl`;\n    string $gotasFijasEmitterRename = `rename ($object + \"_Water_Drops_Emitter\")`;\n    select -r $gotasFijasPartsRename;\n    setNClothStartState;\n    performSetNClothStartState 1;\n    currentTime -edit 0;\n    select -r $object;\n}\n\n//Create Water Drops Object\n\nglobal proc createObjectWater(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select Object.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"transform\" /*&& `attributeExists \"driver\" $obj`*/){\n                if (`objExists Gotas_Fijas_Exp`){\n                    delete Gotas_Fijas_Exp;\n                }\n                if (`objExists Driver_Gotas_Exp`){\n                    delete Driver_Gotas_Exp;\n                }\n                if (`objExists Trails_Exp`){\n                    delete Trails_Exp;\n                }\n                if (`objExists Water_Drops_Exp`){\n                    delete Water_Drops_Exp;\n                }\n                float $radiusUno = `textField -q -tx radius3TF`;\n                float $randRadiusUno = `textField -q -tx randomRadius3TF`;\n                float $frameRate = `textField -q -tx frameRate3TF`;\n                int $frameEndDriverGotas = `textField -q -tx frameEnd3TF`;\n                if ($frameEndDriverGotas > (`playbackOptions -q -max`)){\n                    playbackOptions -aet $frameEndDriverGotas -max $frameEndDriverGotas;\n                }\n                select -cl;\n                NParticleMenu MayaWindow|mainNParticleMenu;       \n                updateNParticleStyleMenu \"Water\";\n                string $emisorCaida[] = `emitter -type omni -r $frameRate -sro 0 -nuv 0 -cye none -cyi 1 -spd 0 -srn 0 -nsp 0 -tsp 0 -mxd 0 -mnd 0 -dx 1 -dy 0 -dz 0 -sp 0 -n ($selObjShort[0] + \"_Water_Drops_Creation_Emitter\")`;\n                string $particulasCaida[] = `nParticle -n ( $selObjShort[0] + \"_Water_Drops_Creation_nParticles\")`;\n                addAttr -h 0 -ln \"water\" -at double $emisorCaida[0];\n                addAttr -h 0 -ln \"water\" -at double $particulasCaida[1];        \n                connectDynamic -em $emisorCaida[0] $particulasCaida[0];\n        //        string $gravity[] = `gravity -pos 0 0 0 -m 9.8 -att 0 -dx 0 -dy -1 -dz 0  -mxd -1  -vsh none -vex 0 -vof 0 0 0 -vsw 360 -tsr 0.5 -n ($selObjShort[0] + \"_Driver_Drops_Gravity\")`;\n        //        connectDynamic -f $gravity[0]  $particulasCaida[1];        \n        //        grupo($gravity[0]);\n\n                setAttr ($emisorCaida[0] + \".emitterType\") 0;\n                setAttr ($emisorCaida[0] + \".spread\") 1;\n                setAttr ($emisorCaida[0] + \".directionX\") 0;\n                setAttr ($emisorCaida[0] + \".speed\") 0;\n\n                parent $emisorCaida[0] $selObjShort[0];\n                setAttr ($emisorCaida[0] + \".translateZ\") 0;\n                setAttr ($emisorCaida[0] + \".translateX\") 0;\n                setAttr ($emisorCaida[0] + \".translateY\") 0;\n\n                setAttr ($particulasCaida[0] + \".radius\") $radiusUno;\n                setAttr ($particulasCaida[0] + \".radiusScaleRandomize\") $randRadiusUno;\n                setAttr ($particulasCaida[0] + \".collide\") 0;\n                setAttr ($particulasCaida[0] + \".lifespanMode\") 1;\n                setAttr ($particulasCaida[0] + \".radiusScale[0].radiusScale_Position\") 0;\n                setAttr ($particulasCaida[0] + \".radiusScale[0].radiusScale_FloatValue\") 1;\n                setAttr ($particulasCaida[0] + \".radiusScale[0].radiusScale_Interp\") 2;\n                setAttr ($particulasCaida[0] + \".radiusScale[1].radiusScale_Position\") 0.252174;\n                setAttr ($particulasCaida[0] + \".radiusScale[1].radiusScale_FloatValue\") 0.44;\n                setAttr ($particulasCaida[0] + \".radiusScale[1].radiusScale_Interp\") 2;\n                setAttr ($particulasCaida[0] + \".radiusScale[2].radiusScale_Position\") 0.521739;\n                setAttr ($particulasCaida[0] + \".radiusScale[2].radiusScale_FloatValue\") 0;\n                setAttr ($particulasCaida[0] + \".radiusScale[2].radiusScale_Interp\") 2;\n                setAttr ($particulasCaida[0] + \".radiusScaleInput\") 1;\n                setAttr ($particulasCaida[0] + \".radiusScaleInputMax\") 2.808989;\n                setAttr ($particulasCaida[0] + \".radiusScaleRandomize\") 0.060;\n                setAttr ($particulasCaida[0] + \".radiusScaleSPH\") 0;         \n\n                string $nucleus[] = `listConnections -d 1 -s 1 ($particulasCaida[0] + \".currentState\")`;\n        \n                setAttr ($nucleus[0] + \".gravity\") 0;\n                \n                string $gotasFijasVentana = \"if (frame == \";\n                    $gotasFijasVentana += $frameEndDriverGotas;\n                    $gotasFijasVentana += \"){\\n\";\n                    $gotasFijasVentana += \"    play -state off;\\n\";\n                    $gotasFijasVentana += (\"    select \" + $particulasCaida[0] + \";\\n\");\n                    $gotasFijasVentana += \"    if (`window -ex GotasFijasOk`) {\\n\";\n                    $gotasFijasVentana += \"        deleteUI -window GotasFijasOk;\\n\";\n                    $gotasFijasVentana += \"    }\\n\";\n                    $gotasFijasVentana += \"    window -s 0 -t \\\"DRIVER WATER DROPS\\\" -w 350 -h 250 -minimizeButton false  -maximizeButton false GotasFijasOk;\\n\";\n                    $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"            text -font \\\"boldLabelFont\\\" -l \\\"APPLY INITIAL STATE?\\\";\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 5 -columnWidth 1 10 -columnWidth 2 80 -columnWidth 3 10 -columnWidth 4 80 -columnWidth 5 10;\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"            global proc Aplicar(){\\n\";\n                    $gotasFijasVentana += (\"                waterDropsObjectApply(\\\"\" + $particulasCaida[0] + \"\\\",\\\"\" + $emisorCaida[0] + \"\\\",\\\"\" + $selObjShort[0] + \"\\\");\\n\");\n                    $gotasFijasVentana += \"            }\\n\";\n                    $gotasFijasVentana += \"            button -l \\\"APPLY\\\" -c\\\"Aplicar()\\\";\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";            \n                    $gotasFijasVentana += \"            button -l \\\"CANCEL\\\" -c\\\"waterDropsCancel()\\\";\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"    showWindow;\\n\";\n                    $gotasFijasVentana += \"}\\n\";\n        \n                string $playDriver = `expression -s $gotasFijasVentana -n \"Water_Drops_Exp\"`;\n                play -forward true;\n          \n                currentTime -edit 0;\n                play -forward true;\n            } else {\n                warning \"select Object.\";\n            }\n        }       \n    }\n}\n\n//Create Trails Particles Object\n\nglobal proc createObjectTrails(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n                currentTime -edit 0;\n    if (size($selObjShort) == 0 ){\n        warning \"select Object.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"transform\" /*&& `attributeExists \"driver\" $obj`*/){\n                if (`objExists Gotas_Fijas_Exp`){\n                    delete Gotas_Fijas_Exp;\n                }\n                if (`objExists Driver_Gotas_Exp`){\n                    delete Driver_Gotas_Exp;\n                }\n                if (`objExists Trails_Exp`){\n                    delete Trails_Exp;\n                }\n                if (`objExists Water_Drops_Exp`){\n                    delete Water_Drops_Exp;\n                }\n                select -cl;                \n                float $radiusUno = `textField -q -tx radius4TF`;\n                float $randRadiusUno = `textField -q -tx randomRadius4TF`;\n                float $frameRate = `textField -q -tx frameRate4TF`;\n                NParticleMenu MayaWindow|mainNParticleMenu;       \n                updateNParticleStyleMenu \"Water\";\n                string $emisorCaida[] = `emitter -type omni -r $frameRate -sro 0 -nuv 0 -cye none -cyi 1 -spd 0 -srn 0 -nsp 0 -tsp 0 -mxd 0 -mnd 0 -dx 1 -dy 0 -dz 0 -sp 0 -n ($selObjShort[0] + \"_Water_Trails_Creation_Emitter\")`;\n                string $particulasCaida[] = `nParticle -n ($selObjShort[0] + \"_Water_Trails_Creation_nParticles\")`;\n                addAttr -h 0 -ln \"trail\" -at double $emisorCaida[0];\n                addAttr -h 0 -ln \"trail\" -at double $particulasCaida[1];        \n                connectDynamic -em $emisorCaida[0] $particulasCaida[0];\n        //        string $gravity[] = `gravity -pos 0 0 0 -m 9.8 -att 0 -dx 0 -dy -1 -dz 0  -mxd -1  -vsh none -vex 0 -vof 0 0 0 -vsw 360 -tsr 0.5 -n ($selObjShort[0] + \"_Driver_Drops_Gravity\")`;\n        //        connectDynamic -f $gravity[0]  $particulasCaida[1];        \n        //        grupo($gravity[0]);\n//                grupo($particulasCaida[0]);\n                setAttr ($emisorCaida[0] + \".speed\") 0;\n                select -r $emisorCaida[0];\n\n                parent $emisorCaida[0] $selObjShort[0];\n                setAttr ($emisorCaida[0] + \".translateZ\") 0;\n                setAttr ($emisorCaida[0] + \".translateX\") 0;\n                setAttr ($emisorCaida[0] + \".translateY\") 0;\n\n                string $gotasFijasEmitterRename = `rename ($selObjShort[0] + \"_Water_Trails_Emitter\")`; \n                                \n                select -r $particulasCaida[0];\n                setAttr ($particulasCaida[0] + \".radius\") $radiusUno;\n                setAttr ($particulasCaida[0] + \".radiusScaleRandomize\") $randRadiusUno;\n                setAttr ($particulasCaida[0] + \".collide\") 0;\n                setAttr ($particulasCaida[0] + \".radiusScaleSPH\") 0;\n\n                string $nucleus[] = `listConnections -d 1 -s 1 ($particulasCaida[0] + \".currentState\")`;\n        \n                setAttr ($nucleus[0] + \".gravity\") 0;\n                \n                select -r $particulasCaida[0];\n                string $TrailsPartisRename = `rename ($selObjShort[0] + \"_Water_Trails_nParticles\")`;\n  \n\n                string $TrailExpression = \"if (frame == 1){\\n\";\n                    $TrailExpression += \"    play -state off;\\n\";\n                    $TrailExpression += (\"    setAttr \" + $TrailsPartisRename + \".radiusScaleInput 5;\\n\");\n                    $TrailExpression += \"}\";\n                \n                string $playDriver = `expression -s $TrailExpression -n \"Trails_Exp\"`;\n                \n                for ($i = 0; $i < 2; $i++){\n                    currentTime -edit $i;\n                }    \n\n                currentTime -edit 0;\n\n                if (`objExists Trails_Exp`){\n                    delete Trails_Exp;\n                }\n         \n            }\n        }       \n    }\n}\n\nprint \"Water Drops 1.0 By Mariano Antico.\";\n" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "////////////////////////////////////////////////////////////////..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "waterDrops" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.2 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "/////////////////////////////////////////////////////////////////////////////////////////////////////////////\n// WATER DROPS 1.0                                                                                         //\n// By Mariano Antico                                                                                       //\n// Barraca Post                                                                                            //\n// www.barraca.com.ar                                                                                      //\n// www.marianoantico.blogspot.com                                                                          //\n// Last Updated: June 14, 2011.                                                                            //\n// All Rights Reserved .                                                                                   //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n// INTERFAZ\n\nif (`window -ex Drops`) {\n  deleteUI -window Drops;\n}\nif (`window -ex GotasFijasOk`) {\n    deleteUI -window GotasFijasOk;\n}\nwindow -s 0 -t \"Water Drops 1.0 by Mariano Antico\" /*-minimizeButton false  -maximizeButton false*/ Drops;\n    menuBarLayout menuWater;\n        menu -l \"File\" -en true m1;\n        menuItem -l \"Reset values\" -en true -c \"resetValues()\";\n        menu -l \"Window\" -en true m2;\n        menuItem -l \"Expression Editor\" -en true -c \"ExpressionEditor;\";\n        menuItem -l \"Dynamic Relationships\" -en true -c \"DynamicRelationshipEditor;\";\n        menu -l \"Help\" -en true m3;\n        menuItem -l \"About\" -en true -c \"aboutHelp()\";\n        separator;\n\n//SEED SECTION\n\n    rowColumnLayout -numberOfColumns 1 -columnWidth 1 245;\n        text -font \"boldLabelFont\" -l \"CREATE SEED EXPRESSION:\";\n        separator -style \"none\" -h 2;\n    rowColumnLayout -numberOfColumns 2 -columnWidth 1 120 -columnWidth 2 120;       \n        text -font \"plainLabelFont\" -l \"SEED:\"; textField -font \"plainLabelFont\" -tx \"12345\" -ec \"updateSeed()\" seedTF;\n        separator -style \"none\" -h 2;separator -style \"none\" -h 2;       \n    setParent ..; \n    rowColumnLayout -numberOfColumns 3 -columnWidth 1 80 -columnWidth 2 80 -columnWidth 3 80;    \n        button -l \"Create Seed\" -c \"updateSeed()\"; button -l \"Random Seed\" -c \"randomSeed()\"; button -l \"Delete Seed\" -c \"deleteSeed()\";\n        separator -style \"none\" -h 2;separator -style \"none\" -h 2;separator -style \"none\" -h 2;           \n    setParent ..;        \n\n    rowColumnLayout -numberOfColumns 1;       \n        separator;\n        text -font \"boldLabelFont\" -l \"CREATE WATER DROPS:\";\n        separator -style \"none\" -h 2;\n        separator;\n\n//DRIVER WATER DROPS SECTION\n\n        separator -style \"none\" -h 5;\n        text -font \"boldLabelFont\" -l \"CREATE DRIVER WATER DROPS:\";\n        separator -style \"none\" -h 5;\n    rowColumnLayout -numberOfColumns 2 -columnWidth 1 120 -columnWidth 2 120;\n        text -font \"plainLabelFont\" -l \"NUMBER OF DROPS:\"; textField -font \"plainLabelFont\" -tx \"10\" count2TF;\n        text -font \"plainLabelFont\" -l \"PARTICLES RATE:\"; textField -font \"plainLabelFont\" -tx \"250\" -ec \"updateParticleRate2()\" frameRate2TF;\n        text -font \"plainLabelFont\" -l \"INITIAL STATE FRAME:\"; textField -font \"plainLabelFont\" -tx \"20\" -ec \"updateFrameEnd2()\" frameEnd2TF;\n        text -font \"plainLabelFont\" -l \"RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.200\" -ec \"updateRadius2()\" radius2TF;\n        text -font \"plainLabelFont\" -l \"RANDOM RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.250\" -ec \"updateRandomRadius2()\" randomRadius2TF;\n    setParent ..;\n    \n    rowColumnLayout -numberOfColumns 3 -columnWidth 1 120 -columnWidth 2 60 -columnWidth 3 60;    \n        text -font \"plainLabelFont\" -l \"GOAL U:\"; textField -font \"plainLabelFont\" -tx \"0\" goalU1TF;  textField -font \"plainLabelFont\" -tx \"1\" goalU2TF;\n        text -font \"plainLabelFont\" -l \"GOAL V:\"; textField -font \"plainLabelFont\" -tx \"0\" goalV1TF;  textField -font \"plainLabelFont\" -tx \"1\" goalV2TF;\n        text -font \"plainLabelFont\" -l \"RANDOM VELOCITY:\"; textField -font \"plainLabelFont\" -tx \"1\" velocity1TF;  textField -font \"plainLabelFont\" -tx \"2\" velocity2TF;\n        text -font \"plainLabelFont\" -l \"START OFFSET:\"; textField -font \"plainLabelFont\" -tx \"0\" ageOffset1TF;  textField -font \"plainLabelFont\" -tx \"12\" ageOffset2TF;\n\n    setParent ..; \n    \n    rowColumnLayout -numberOfColumns 2 -columnWidth 1 120 -columnWidth 2 120;        \n        text -font \"plainLabelFont\" -l \"# OF RANDOM MOVES:\"; textField -font \"plainLabelFont\" -tx \"6\" movesTF;\n        separator -style \"none\" -h 3;separator -style \"none\" -h 3;        \n    setParent ..; \n    rowColumnLayout -numberOfColumns 3 -columnWidth 1 80 -columnWidth 2 80 -columnWidth 3 80;\n        button -l \"Create Driver\" -c \"createDrops()\"; button -l \"Select Driver\" -c \"selectDriver()\"; button -l \"Driver Visibility\" -c \"toogleVisibleDriver()\";\n    setParent ..; \n\n//WATER SWEAT SECTION  \n\n    rowColumnLayout -numberOfColumns 1;\n        separator;   \n        separator -style \"none\" -h 5;\n        text -font \"boldLabelFont\" -l \"CREATE SWEAT:\";\n\n   rowColumnLayout -numberOfColumns 2 -columnWidth 1 120 -columnWidth 2 120;\n        separator -style \"none\" -h 5;separator -style \"none\" -h 5;\n        text -font \"plainLabelFont\" -l \"RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.100\" -ec \"updateRadius()\" radiusTF;\n        text -font \"plainLabelFont\" -l \"RANDOM RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.250\" -ec \"updateRandomRadius()\" randomRadiusTF;\n        text -font \"plainLabelFont\" -l \"PARTICLES RATE:\"; textField -font \"plainLabelFont\" -tx \"250\" -ec \"updateParticleRate()\" frameRateTF;\n        text -font \"plainLabelFont\" -l \"INITIAL STATE FRAME:\"; textField -font \"plainLabelFont\" -tx \"100\" -ec \"updateFrameEnd()\" frameEndTF;\n        separator -style \"none\" -h 5;separator -style \"none\" -h 5;\n    setParent ..; \n    rowColumnLayout -numberOfColumns 3 -columnWidth 1 80 -columnWidth 2 80 -columnWidth 3 80;\n        button -l \"Create Sweat\" -c \"createParts()\"; button -l \"Select Sweat\" -c \"selectSweat()\"; button -l \"Sweat Visibility\" -c \"toogleVisibleSweat()\";\n    setParent ..; \n\n//WATER DROPS SECTION  \n\n    rowColumnLayout -numberOfColumns 1;\n        separator;   \n        separator -style \"none\" -h 5;\n        text -font \"boldLabelFont\" -l \"CREATE WATER DROPS:\";\n\n   rowColumnLayout -numberOfColumns 2 -columnWidth 1 120 -columnWidth 2 120;\n        separator -style \"none\" -h 5;separator -style \"none\" -h 5;\n        text -font \"plainLabelFont\" -l \"RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.250\" -ec \"updateRadius3()\" radius3TF;\n        text -font \"plainLabelFont\" -l \"RANDOM RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.060\" -ec \"updateRandomRadius3()\" randomRadius3TF;\n        text -font \"plainLabelFont\" -l \"PARTICLES RATE:\"; textField -font \"plainLabelFont\" -tx \"100\" -ec \"updateParticleRate3()\" frameRate3TF;\n        text -font \"plainLabelFont\" -l \"INITIAL STATE FRAME:\"; textField -font \"plainLabelFont\" -tx \"3\" -ec \"updateFrameEnd3()\" frameEnd3TF;\n        separator -style \"none\" -h 5;separator -style \"none\" -h 5;\n    setParent ..; \n    rowColumnLayout -numberOfColumns 3 -columnWidth 1 80 -columnWidth 2 80 -columnWidth 3 80;\n        button -l \"Create Drops\" -c \"createWater()\"; button -l \"Select Drops\" -c \"selectWater()\"; button -l \"Drops Visibility\" -c \"toogleVisibleWater()\";\n    setParent ..; \n\n//WATER TRAILS SECTION  \n\n    rowColumnLayout -numberOfColumns 1;\n        separator;   \n        separator -style \"none\" -h 5;\n        text -font \"boldLabelFont\" -l \"CREATE WATER TRAILS:\";\n\n   rowColumnLayout -numberOfColumns 2 -columnWidth 1 120 -columnWidth 2 120;\n        separator -style \"none\" -h 5;separator -style \"none\" -h 5;\n        text -font \"plainLabelFont\" -l \"RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.060\" -ec \"updateRadius4()\" radius4TF;\n        text -font \"plainLabelFont\" -l \"RANDOM RADIUS:\"; textField -font \"plainLabelFont\" -tx \"0.850\" -ec \"updateRandomRadius4()\" randomRadius4TF;\n        text -font \"plainLabelFont\" -l \"PARTICLES RATE:\"; textField -font \"plainLabelFont\" -tx \"10\" -ec \"updateParticleRate4()\" frameRate4TF;\n        separator -style \"none\" -h 5;separator -style \"none\" -h 5;\n    setParent ..; \n    rowColumnLayout -numberOfColumns 3 -columnWidth 1 80 -columnWidth 2 80 -columnWidth 3 80;\n        button -l \"Create Trails\" -c \"createTrails()\"; button -l \"Select Trails\" -c \"selectTrails()\"; button -l \"Trails Visibility\" -c \"toogleVisibleTrails()\";\n    setParent ..;\n    \n//TOOLS\n\n   rowColumnLayout -numberOfColumns 2 -columnWidth 1 120 -columnWidth 2 120;\n        separator -style \"none\" -h 2;separator -style \"none\" -h 2;\n        separator; separator;\n        separator -style \"none\" -h 2;separator -style \"none\" -h 2;\n        button -l \"OBJECT DROPS\" -c \"createObjectWater()\"; button -l \"OBJECT TRAILS\" -c \"createObjectTrails()\";\n        button -l \"REFRESH VALUES\" -c \"refreshValues()\"; button -l \"SET INITIAL STATE\" -c \"initialState()\"; \n    setParent ..; \n    rowColumnLayout -numberOfColumns 3 -columnWidth 1 80 -columnWidth 2 80 -columnWidth 3 80; \n        button -l \"COLLIDE ON\" -c \"collideOn()\"; button -l \"COLLIDE OFF\" -c \"collideOff()\"; button -l \"CACHE\" -c \"cacheParts()\";\n    setParent ..;          \n       \nshowWindow;\n\n\n\n//PROCEDIMIENTOS\n\ncycleCheck -e off;\n\n// Select Driver\n\nglobal proc selectDriver(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"Driver nParticles doesn`t exist.\";\n    } else {\n        int $i = 0;\n        select -cl;\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"driver\" $obj`){\n                select -add $obj;\n            }\n        }\n        pickWalk -d up;\n    }\n}\n\n// Select Sweat\n\nglobal proc selectSweat(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"Sweat nParticles doesn`t exist.\";\n    } else {\n        int $i = 0;\n        select -cl;\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"sweat\" $obj`){\n                select -add $obj;\n            }\n        }\n        pickWalk -d up;\n    }\n}\n\n// Select Water Drops\n\nglobal proc selectWater(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"Water Drops nParticles doesn`t exist.\";\n    } else {\n        int $i = 0;\n        select -cl;\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"water\" $obj`){\n                select -add $obj;\n            }\n        }\n        pickWalk -d up;\n    }\n}\n\n// Select Trails\n\nglobal proc selectTrails(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"Trails nParticles doesn`t exist.\";\n    } else {\n        int $i = 0;\n        select -cl;\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"trail\" $obj`){\n                select -add $obj;\n            }\n        }\n        pickWalk -d up;\n    }\n}\n\n\n// Toogle visibility sweat\n\nglobal proc toogleVisibleSweat(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"sweat\" $obj`){\n                select -r $obj;\n                string $objnPart[] = `pickWalk -d up`;\n                if (`getAttr ($objnPart[0] + \".visibility\")`){\n                    setAttr ($objnPart[0] + \".visibility\") 0;\n                } else {\n                    setAttr ($objnPart[0] + \".visibility\") 1;\n                }                    \n            }\n        }\n    }\n}\n\n// Toogle visibility driver\n\nglobal proc toogleVisibleDriver(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"driver\" $obj`){\n                select -r $obj;\n                string $objnPart[] = `pickWalk -d up`;\n                if (`getAttr ($objnPart[0] + \".visibility\")`){\n                    setAttr ($objnPart[0] + \".visibility\") 0;\n                } else {\n                    setAttr ($objnPart[0] + \".visibility\") 1;\n                }                    \n            }\n        }\n    }\n}\n\n// Toogle visibility water drop\n\nglobal proc toogleVisibleWater(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"water\" $obj`){\n                select -r $obj;\n                string $objnPart[] = `pickWalk -d up`;\n                if (`getAttr ($objnPart[0] + \".visibility\")`){\n                    setAttr ($objnPart[0] + \".visibility\") 0;\n                } else {\n                    setAttr ($objnPart[0] + \".visibility\") 1;\n                }                    \n            }\n        }\n    }\n}\n\n// Toogle visibility trails\n\nglobal proc toogleVisibleTrails(){\n    string $selObjShort[] = `ls -type \"nParticle\"`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObjShort){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" && `attributeExists \"trail\" $obj`){\n                select -r $obj;\n                string $objnPart[] = `pickWalk -d up`;\n                if (`getAttr ($objnPart[0] + \".visibility\")`){\n                    setAttr ($objnPart[0] + \".visibility\") 0;\n                } else {\n                    setAttr ($objnPart[0] + \".visibility\") 1;\n                }                    \n            }\n        }\n    }\n}\n\n// Cache\n\nglobal proc cacheParts(){\n    nClothCacheOpt;\n}\n\nglobal proc cacheParts2(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\"){\n                select -r $obj;\n                doCreateNclothCache 4 { \"2\", \"1\", \"10\", \"OneFilePerFrame\", \"1\", \"\",\"0\",\"\",\"0\", \"add\", \"0\", \"1\", \"1\",\"0\",\"1\" } ;\n            }\n        }\n    }\n}\n\n// Set initial state\n\nglobal proc initialState(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\"){\n                select -r $obj;\n                setNClothStartState;\n                performSetNClothStartState 1;\n            }\n        }\n    }\n}\n\n// Collide ON\n\nglobal proc collideOn(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\"){\n                setAttr ($obj + \".collide\") 1;\n            }\n        }\n    }\n}\n\n// Collide OFF\n\nglobal proc collideOff(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select nParticles.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\"){\n                setAttr ($obj + \".collide\") 0;\n            }\n        }\n    }\n}\n\n// Group\n\nglobal proc grupo(string $object){\n    if (`objExists Water_Drops_Dynamics_GRP`) {\n        string $parientes[] = `listRelatives -parent $object`;\n        if (size($parientes) == 0){        \n            parent $object Water_Drops_Dynamics_GRP ;            \n        } else {       \n            for ($each in $parientes){\n                if (`gmatch $each \"*Water_Drops_Dynamics_GRP*\"`){\n                } else {\n                    parent $object Water_Drops_Dynamics_GRP ;                \n                }\n            }\n        }\n    } else {\n        string $Grupo = `CreateEmptyGroup`;\n        string $Grupo = `rename Water_Drops_Dynamics_GRP`;\n        parent $object Water_Drops_Dynamics_GRP ;\n    }\n}\n\n// create Seed\n\nglobal proc createSeed(){\n    float $seedNum = `textField -q -tx seedTF`;\n    string $seedExp = \"if (frame == 0){\\n\";\n        $seedExp += \"    seed \";\n        $seedExp += $seedNum;\n        $seedExp += \";\\n\";\n        $seedExp += \"}\\n\";\n    string $seedExpression = `expression -s $seedExp -n \"Seed_Exp\"`;          \n}\n\n// delete Seed\n\nglobal proc deleteSeed(){\n    if (`objExists Seed_Exp`){\n        delete Seed_Exp;\n    }\n}\n\n// update Seed\n\nglobal proc updateSeed(){\n    if (`objExists Seed_Exp`){\n        deleteSeed();\n        createSeed(); \n    } else {\n        createSeed(); \n    }   \n}\n\n// random Seed\n\nglobal proc randomSeed(){\n    if (`objExists Seed_Exp`){\n        deleteSeed();\n        int $seedRandom = rand(99999);\n        string $seedExp = \"if (frame == 0){\\n\";\n            $seedExp += \"    seed \";\n            $seedExp += $seedRandom;\n            $seedExp += \";\\n\";\n            $seedExp += \"}\\n\";\n        string $seedExpression = `expression -s $seedExp -n \"Seed_Exp\"`;  \n        textField -e -tx $seedRandom seedTF;\n    } else {\n        int $seedRandom = rand(99999);\n        string $seedExp = \"if (frame == 0){\\n\";\n            $seedExp += \"    seed \";\n            $seedExp += $seedRandom;\n            $seedExp += \";\\n\";\n            $seedExp += \"}\\n\";\n        string $seedExpression = `expression -s $seedExp -n \"Seed_Exp\"`;  \n        textField -e -tx $seedRandom seedTF;\n    }   \n}\n\n// reset values menu\n\nglobal proc resetValues(){\n\n    textField -e -tx \"10\" count2TF;\n    textField -e -tx \"250\" frameRate2TF;\n    textField -e -tx \"20\" frameEnd2TF;\n    textField -e -tx \"0.200\" radius2TF;\n    textField -e -tx \"0.250\" randomRadius2TF;\n\n    textField -e -tx \"0\" goalU1TF;textField -e -tx \"1\" goalU2TF;\n    textField -e -tx \"0\" goalV1TF;textField -e -tx \"1\" goalV2TF;\n    textField -e -tx \"1\" velocity1TF;textField -e -tx \"2\" velocity2TF;\n    textField -e -tx \"0\" ageOffset1TF;textField -e -tx \"12\" ageOffset2TF;\n    textField -e -tx \"6\" movesTF;\n \n    textField -e -tx \"250\" frameRateTF;\n    textField -e -tx \"20\" frameEndTF;\n    textField -e -tx \"0.100\" radiusTF;\n    textField -e -tx \"0.250\" randomRadiusTF;\n    \n    textField -e -tx \"100\" frameRate3TF;\n    textField -e -tx \"3\" frameEnd3TF;\n    textField -e -tx \"0.250\" radius3TF;\n    textField -e -tx \"0.060\" randomRadius3TF;\n    \n    textField -e -tx \"10\" frameRate4TF;\n    textField -e -tx \"0.060\" radius4TF;\n    textField -e -tx \"0.850\" randomRadius4TF;       \n    \n}\n\n// about menu\n\nglobal proc aboutHelp(){\n    showHelp -absolute \"http://www.marianoantico.blogspot.com/\";\n}\n\n// refresh values\n\nglobal proc refreshValues(){\n    float $frameEnd = `playbackOptions -q -max`;\n    textField -e -tx $frameEnd frameEndTF;\n    textField -e -tx $frameEnd frameEnd2TF;\n    string $Gotas[] = `ls -dag Water_Drops_Dynamics_GRP`;\n    if (size($Gotas) == 0 ){\n        warning \"select an Emitter or Particles.\";\n    } else {   \n        for ($obj in $Gotas){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"pointEmitter\" && `attributeExists \"sweat\" $obj`){\n                float $frameRate = `getAttr ($obj + \".rate\")`;\n                textField -e -tx $frameRate frameRateTF;\n            } else if ($nodeType == \"nParticle\" && `attributeExists \"sweat\" $obj`){\n                float $randRadiusUno = `getAttr ($obj + \".radiusScaleRandomize\")`;\n                textField -e -tx $randRadiusUno randomRadiusTF;\n                float $radiusUno = `getAttr ($obj + \".radius\")`;\n                textField -e -tx $radiusUno radiusTF;\n            } else if ($nodeType == \"pointEmitter\" && `attributeExists \"driver\" $obj`){\n                float $frameRate = `getAttr ($obj + \".rate\")`;\n                textField -e -tx $frameRate frameRate2TF;\n            } else if ($nodeType == \"nParticle\" && `attributeExists \"driver\" $obj`){\n                float $randRadiusUno = `getAttr ($obj + \".radiusScaleRandomize\")`;\n                textField -e -tx $randRadiusUno randomRadius2TF;\n                float $radiusUno = `getAttr ($obj + \".radius\")`;\n                textField -e -tx $radiusUno radius2TF;\n            } \n        }\n    }\n}\n \n// update Radius Sweat\n\nglobal proc updateRadius(){\n    string $sel[] = `ls -sl -dag`;\n    float $radiusUno = `textField -q -tx radiusTF`; \n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"sweat\" $obj`){\n            setAttr ($obj + \".radius\") $radiusUno;\n        }\n    }\n}\n\n// update Radius driver\n\nglobal proc updateRadius2(){\n    string $sel[] = `ls -sl -dag`;\n    float $radiusUno = `textField -q -tx radius2TF`; \n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"driver\" $obj`){\n            setAttr ($obj + \".radius\") $radiusUno;\n        }\n    }\n}\n\n// update Radius water\n\nglobal proc updateRadius3(){\n    string $sel[] = `ls -sl -dag`;\n    float $radiusUno = `textField -q -tx radius3TF`; \n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"water\" $obj`){\n            setAttr ($obj + \".radius\") $radiusUno;\n        }\n    }\n}\n\n// update Radius trails\n\nglobal proc updateRadius4(){\n    string $sel[] = `ls -sl -dag`;\n    float $radiusUno = `textField -q -tx radius4TF`; \n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"trail\" $obj`){\n            setAttr ($obj + \".radius\") $radiusUno;\n        }\n    }\n}\n\n\n// update random Radius Sweat\n\nglobal proc updateRandomRadius(){\n    string $sel[] = `ls -sl -dag`;\n    float $randRadiusUno = `textField -q -tx randomRadiusTF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"sweat\" $obj`){\n            setAttr ($obj + \".radiusScaleRandomize\") $randRadiusUno;\n        }                                 \n    }   \n}\n\n// update random Radius driver\n\nglobal proc updateRandomRadius2(){\n    string $sel[] = `ls -sl -dag`;\n    float $randRadiusUno = `textField -q -tx randomRadius2TF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"driver\" $obj`){\n            setAttr ($obj + \".radiusScaleRandomize\") $randRadiusUno;\n        }                                 \n    }   \n}\n\n// update random Radius water\n\nglobal proc updateRandomRadius3(){\n    string $sel[] = `ls -sl -dag`;\n    float $randRadiusUno = `textField -q -tx randomRadius3TF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"water\" $obj`){\n            setAttr ($obj + \".radiusScaleRandomize\") $randRadiusUno;\n        }                                 \n    }   \n}\n\n// update random Radius trails\n\nglobal proc updateRandomRadius4(){\n    string $sel[] = `ls -sl -dag`;\n    float $randRadiusUno = `textField -q -tx randomRadius4TF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"nParticle\" && `attributeExists \"trail\" $obj`){\n            setAttr ($obj + \".radiusScaleRandomize\") $randRadiusUno;\n        }                                 \n    }   \n}\n\n// update Particle Rate Sweat\n\nglobal proc updateParticleRate(){\n    string $sel[] = `ls -sl -dag`;\n    float $frameRate = `textField -q -tx frameRateTF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"pointEmitter\" && `attributeExists \"sweat\" $obj`){\n            setAttr ($obj + \".rate\") $frameRate;\n        }                                 \n    }   \n}\n\n// update Particle Rate Driver\n\nglobal proc updateParticleRate2(){\n    string $sel[] = `ls -sl -dag`;\n    float $frameRate = `textField -q -tx frameRate2TF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"pointEmitter\" && `attributeExists \"driver\" $obj`){\n            setAttr ($obj + \".rate\") $frameRate;\n        }                                 \n    }   \n}\n\n// update Particle Rate water\n\nglobal proc updateParticleRate3(){\n    string $sel[] = `ls -sl -dag`;\n    float $frameRate = `textField -q -tx frameRate3TF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"pointEmitter\" && `attributeExists \"water\" $obj`){\n            setAttr ($obj + \".rate\") $frameRate;\n        }                                 \n    }   \n}\n\n// update Particle Rate trails\n\nglobal proc updateParticleRate4(){\n    string $sel[] = `ls -sl -dag`;\n    float $frameRate = `textField -q -tx frameRate4TF`;\n    for ($obj in $sel){\n        string $nodeType = `nodeType $obj`;\n        if ($nodeType == \"pointEmitter\" && `attributeExists \"trail\" $obj`){\n            setAttr ($obj + \".rate\") $frameRate;\n        }                                 \n    }   \n}\n\n// update Frame End Sweat\n\nglobal proc updateFrameEnd(){\n    int $frameEndGotasFijas = `textField -q -tx frameEndTF`;\n    playbackOptions -aet $frameEndGotasFijas -max $frameEndGotasFijas;  \n}\n\n// update Frame End Driver\n\nglobal proc updateFrameEnd2(){\n    int $frameEndGotasFijas = `textField -q -tx frameEnd2TF`;\n    playbackOptions -aet $frameEndGotasFijas -max $frameEndGotasFijas;  \n}\n\n// update Frame End water\n\nglobal proc updateFrameEnd3(){\n    int $frameEndGotasFijas = `textField -q -tx frameEnd3TF`;\n    playbackOptions -aet $frameEndGotasFijas -max $frameEndGotasFijas;  \n}\n\n//Apply gotas Fijas\n\nglobal proc gotasFijasApply(string $nParticles, string $emitter, string $object){\n    if (`window -ex GotasFijasOk`) {\n      deleteUI -window GotasFijasOk;\n    }\n    if (`objExists Gotas_Fijas_Exp`){\n       delete Gotas_Fijas_Exp;\n    }\n    select -r $nParticles;\n    string $gotasFijasPartsRename = `rename ($object + \"_Sweat_nParticles\")`;\n    select -r $emitter;\n    string $gotasFijasEmitter[] = `ls -sl`;\n    string $gotasFijasEmitterRename = `rename ($object + \"_Sweat_Emitter\")`;\n    emitter -e -r 0 $gotasFijasEmitterRename;\n    select -r $gotasFijasPartsRename;\n    setNClothStartState;\n    performSetNClothStartState 1;\n    currentTime -edit 0;\n    select -r $object;\n}\n\n//Cancel gotas Fijas\n\nglobal proc gotasFijasCancel(){\n    if (`window -ex GotasFijasOk`) {\n        deleteUI -window GotasFijasOk;\n    }\n    currentTime -edit 0;\n}\n\n//Create Sweat Particles\n\nglobal proc createParts(){\n    string $fileNew = \"\";    \n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select an object.\";\n    } else {\n        if (`objExists Gotas_Fijas_Exp`){\n            delete Gotas_Fijas_Exp;\n        }\n        if (`objExists Driver_Gotas_Exp`){\n            delete Driver_Gotas_Exp;\n        }\n        if (`objExists Trails_Exp`){\n            delete Trails_Exp;\n        }\n        if (`objExists Water_Drops_Exp`){\n            delete Water_Drops_Exp;\n        }        \n        select -r $selObjShort[0];\n        grupo($selObjShort[0]);\n        float $radiusUno = `textField -q -tx radiusTF`;\n        float $randRadiusUno = `textField -q -tx randomRadiusTF`;\n        float $frameRate = `textField -q -tx frameRateTF`;\n        int $frameEndGotasFijas = `textField -q -tx frameEndTF`;\n        NParticleMenu MayaWindow|mainNParticleMenu;       \n        updateNParticleStyleMenu \"Water\";\n        string $emisorUno[] = `emitter -type surf -r $frameRate -sro 0 -nuv 0 -cye none -cyi 1 -spd 0 -srn 0 -nsp 0 -tsp 0 -mxd 0 -mnd 0 -dx 1 -dy 0 -dz 0 -sp 0 -n ($selObjShort[0] + \"_Sweat_Creation_Emitter\")`;\n        setAttr ($emisorUno[1] + \".enableTextureRate\") 1;\n        addAttr -h 0 -ln \"sweat\" -at double $emisorUno[1];\n        string $particulasUno[] = `nParticle -n ($selObjShort[0] + \"_Sweat_Creation_nParticles\")`;\n        addAttr -h 0 -ln \"sweat\" -at double $particulasUno[1];     \n        connectDynamic -em $emisorUno[0] $particulasUno[0];\n        grupo($particulasUno[0]);\n\n        string $nucleus[] = `listConnections -d 1 -s 1 ($particulasUno[0] + \".currentState\")`;\n\n        setAttr ($nucleus[0] + \".gravity\") 0;\n        event -name \"Die_Event\" -die 1 -count 0 $particulasUno[0];\n        setAttr ($particulasUno[0] + \".radiusScaleSPH\") 0;\n        setAttr ($particulasUno[0] + \".radius\") $radiusUno;\n        setAttr ($particulasUno[0] + \".radiusScaleInput\") 5;\n        setAttr ($particulasUno[0] + \".radiusScaleRandomize\") $randRadiusUno;\n\n        string $fileNew = `shadingNode -asTexture file -n ($selObjShort[0] + \"_Sweat_Texture_Rate_File\")`;\n        string $place2dNew = `shadingNode -asUtility place2dTexture`;\n        connectAttr -f ($place2dNew + \".coverage\") ($fileNew + \".coverage\");\n        connectAttr -f ($place2dNew + \".translateFrame\") ($fileNew + \".translateFrame\");\n        connectAttr -f ($place2dNew + \".rotateFrame\") ($fileNew + \".rotateFrame\");\n        connectAttr -f ($place2dNew + \".mirrorU\") ($fileNew + \".mirrorU\");\n        connectAttr -f ($place2dNew + \".mirrorV\") ($fileNew + \".mirrorV\");\n        connectAttr -f ($place2dNew + \".stagger\") ($fileNew + \".stagger\");\n        connectAttr -f ($place2dNew + \".wrapU\") ($fileNew + \".wrapU\");\n        connectAttr -f ($place2dNew + \".wrapV\") ($fileNew + \".wrapV\");\n        connectAttr -f ($place2dNew + \".repeatUV\") ($fileNew + \".repeatUV\");\n        connectAttr -f ($place2dNew + \".offset\") ($fileNew + \".offset\");\n        connectAttr -f ($place2dNew + \".rotateUV\") ($fileNew + \".rotateUV\");\n        connectAttr -f ($place2dNew + \".noiseUV\") ($fileNew + \".noiseUV\");\n        connectAttr -f ($place2dNew + \".vertexUvOne\") ($fileNew + \".vertexUvOne\");\n        connectAttr -f ($place2dNew + \".vertexUvTwo\") ($fileNew + \".vertexUvTwo\");\n        connectAttr -f ($place2dNew + \".vertexUvThree\") ($fileNew + \".vertexUvThree\");\n        connectAttr -f ($place2dNew + \".vertexCameraOne\") ($fileNew + \".vertexCameraOne\");\n        connectAttr -f ($place2dNew + \".outUV\") ($fileNew + \".uv\");\n        connectAttr -f ($place2dNew + \".outUvFilterSize\") ($fileNew + \".uvFilterSize\");\n        string $DirName = `workspace -q -fullName`;\n        string $openFileName[] = `fileDialog2  -caption \"Please select a texture rate map.\" -fileMode 1 -startingDirectory $DirName -fileFilter \"*.*\"`;\n        setAttr -type \"string\" ($fileNew + \".fileTextureName\") (substituteAllString($openFileName[0], ($DirName + \"/\"), \"\"));\n        connectAttr -f ($fileNew + \".outColor\") ($emisorUno[1] + \".textureRate\");\n\n        currentTime -edit 0;\n        if ($frameEndGotasFijas > (`playbackOptions -q -max`)){\n            playbackOptions -aet $frameEndGotasFijas -max $frameEndGotasFijas;\n        }        \n\n        string $gotasFijasVentana = \"if (frame == \";\n            $gotasFijasVentana += $frameEndGotasFijas;\n            $gotasFijasVentana += \"){\\n\";\n            $gotasFijasVentana += \"    play -state off;\\n\";\n            $gotasFijasVentana += (\"    select \" + $particulasUno[0] + \";\\n\");\n            $gotasFijasVentana += \"    if (`window -ex GotasFijasOk`) {\\n\";\n            $gotasFijasVentana += \"        deleteUI -window GotasFijasOk;\\n\";\n            $gotasFijasVentana += \"    }\\n\";\n            $gotasFijasVentana += \"    window -s 0 -t \\\"SWEAT\\\" -w 350 -h 250 -minimizeButton false  -maximizeButton false GotasFijasOk;\\n\";\n            $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"            text -font \\\"boldLabelFont\\\" -l \\\"APPLY INITIAL STATE?\\\";\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 5 -columnWidth 1 10 -columnWidth 2 80 -columnWidth 3 10 -columnWidth 4 80 -columnWidth 5 10;\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"            global proc Aplicar(){\\n\";\n            $gotasFijasVentana += (\"                gotasFijasApply(\\\"\" + $particulasUno[0] + \"\\\",\\\"\" + $emisorUno[1] + \"\\\",\\\"\" + $selObjShort[0] + \"\\\");\\n\");\n            $gotasFijasVentana += \"            }\\n\";\n            $gotasFijasVentana += \"            button -l \\\"APPLY\\\" -c \\\"Aplicar()\\\";\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";            \n            $gotasFijasVentana += \"            button -l \\\"CANCEL\\\" -c\\\"gotasFijasCancel()\\\";\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"    showWindow;\\n\";\n            $gotasFijasVentana += \"}\\n\";\n\n        string $play = `expression -s $gotasFijasVentana -n \"Gotas_Fijas_Exp\"`;\n        play -forward true;\n    }\n}\n\n//Apply Driver gotas \n\nglobal proc driverGotasApply(string $nParticles, string $emitter, string $object){\n    if (`window -ex GotasFijasOk`) {\n      deleteUI -window GotasFijasOk;\n    }\n    if (`objExists Driver_Gotas_Exp`){\n       delete Driver_Gotas_Exp;\n    }\n    select -r $nParticles;\n    string $DriverPartsRename = `rename ($object + \"_Driver_Drops_nParticles\")`;\n    select -r $emitter;\n    string $DriverEmitterRename = `rename ($object + \"_Driver_Drops_Emitter\")`;\n    emitter -e -r 0 $DriverEmitterRename;\n    select -r $DriverPartsRename;\n    string $PartisShape[] = `ls -dag $DriverPartsRename`;\n    setNClothStartState;\n    performSetNClothStartState 1;\n    currentTime -edit 0;\n    setAttr ($DriverPartsRename + \".collide\") 1;\n    string $GotasCaenMoveExpression = \"\";    \n    int $moves = `textField -q -tx movesTF`;\n    for ($i=0; $i< ($moves + 1);$i++){\n        int $randExpressions = rand(2.99);           \n        int $j = $i + 1;\n        float $velocity1 = `textField -q -tx velocity1TF`;\n        float $velocity2 = `textField -q -tx velocity2TF`;\n        float $randFreno = rand(($velocity1*.005),($velocity2*.005));\n        float $randXMove = rand(0.0002,0.0009);\n        float $randCaida = rand(0.0025,0.0085);\n        float $randTimes = rand(0.0055,0.0095);\n        float $randMultiply = rand(8,12);\n        float $randNoiseX = rand(.12,.35);\n\n        if ($randExpressions == 0){    \n\n            $GotasCaenMoveExpression += (\"if (\" + $PartisShape[1] + \".randMov > \" + $i + \" && \" +  $PartisShape[1] + \".randMov < \" + $j + \"){\\n\");\n            $GotasCaenMoveExpression += (\"    if (frame > \" + $PartisShape[1] + \".startOffset){\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalV -= abs(sin(time*(noise(time/\" + $PartisShape[1] + \".randSin)*\" + $randMultiply + \"))*\" + $randFreno +\");\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalU += (sin(time*(gauss(time/\" + $PartisShape[1] + \".randSin)*\" + $randNoiseX + \"))*\" + $randXMove + \");\\n\");\n            $GotasCaenMoveExpression += (\"        if (\" + $PartisShape[1] + \".goalV < \" + $randCaida + \"){\\n\");\n           \t$GotasCaenMoveExpression +=\t(\"            if (\" + $PartisShape[1] + \".goalPP > 0.06){\\n\");\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] +\t\".goalPP -= 0.05;\\n\");\n            $GotasCaenMoveExpression += \"            } else {\\n\";\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".goalPP = 0.1;\\n\");\n//            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".lifespanPP = 0;\\n\");\n            $GotasCaenMoveExpression += \"            }\\n\";\n            $GotasCaenMoveExpression += \"        }\\n\";\n            $GotasCaenMoveExpression += \"    }\\n\";\n            $GotasCaenMoveExpression += \"}\\n\";\n        \n        } else if ($randExpressions == 1){    \n\n            $GotasCaenMoveExpression += (\"if (\" + $PartisShape[1] + \".randMov > \" + $i + \" && \" +  $PartisShape[1] + \".randMov < \" + $j + \"){\\n\");\n            $GotasCaenMoveExpression += (\"    if (frame > \" + $PartisShape[1] + \".startOffset){\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalV -= abs(sin(time/\" + $PartisShape[1] + \".randSin)*\" + $randFreno +\");\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalU += (noise(time)/\" + $PartisShape[1] + \".randSin)*\" + $randXMove + \";\\n\");\n            $GotasCaenMoveExpression += (\"        if (\" + $PartisShape[1] + \".goalV < \" + $randCaida + \"){\\n\");\n           \t$GotasCaenMoveExpression +=\t(\"            if (\" + $PartisShape[1] + \".goalPP > 0.06){\\n\");\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] +\t\".goalPP -= 0.05;\\n\");\n            $GotasCaenMoveExpression += \"            } else {\\n\";\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".goalPP = 0.1;\\n\");\n//            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".lifespanPP = 0;\\n\");\n            $GotasCaenMoveExpression += \"            }\\n\";\n            $GotasCaenMoveExpression += \"        }\\n\";\n            $GotasCaenMoveExpression += \"    }\\n\";\n            $GotasCaenMoveExpression += \"}\\n\";\n        \n        } else if ($randExpressions == 2){    \n\n            $GotasCaenMoveExpression += (\"if (\" + $PartisShape[1] + \".randMov > \" + $i + \" && \" +  $PartisShape[1] + \".randMov < \" + $j + \"){\\n\");\n            $GotasCaenMoveExpression += (\"    if (frame > \" + $PartisShape[1] + \".startOffset){\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalV -= abs(( sin(time/\" + $PartisShape[1] + \".randSin)*cos(sin(time/\" + $PartisShape[1] + \".randSin*3.14))/atan(3.14/\" + $PartisShape[1] + \".randSin))*\" + $randFreno + \");\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalU += (noise(time)/\" + $PartisShape[1] + \".randSin*\" + ($randFreno*.1) + \");\\n\");\n            $GotasCaenMoveExpression += (\"        if (\" + $PartisShape[1] + \".goalV < \" + $randCaida + \"){\\n\");\n           \t$GotasCaenMoveExpression +=\t(\"            if (\" + $PartisShape[1] + \".goalPP > 0.06){\\n\");\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] +\t\".goalPP -= 0.05;\\n\");\n            $GotasCaenMoveExpression += \"            } else {\\n\";\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".goalPP = 0.1;\\n\");\n//            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".lifespanPP = 0;\\n\");\n            $GotasCaenMoveExpression += \"            }\\n\";\n            $GotasCaenMoveExpression += \"        }\\n\";\n            $GotasCaenMoveExpression += \"    }\\n\";\n            $GotasCaenMoveExpression += \"}\\n\";\n\n        } else if ($randExpressions == 3){    \n\n            $GotasCaenMoveExpression += (\"if (\" + $PartisShape[1] + \".randMov > \" + $i + \" && \" +  $PartisShape[1] + \".randMov < \" + $j + \"){\\n\");\n            $GotasCaenMoveExpression += (\"    if (frame > \" + $PartisShape[1] + \".startOffset){\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalV -= abs(sin(time*(noise(time/\" + $PartisShape[1] + \".randSin)*\" + $randMultiply + \"))*\" + $randFreno +\");\\n\");\n            $GotasCaenMoveExpression += (\"        \" + $PartisShape[1] + \".goalU += (sin(time*(gauss(time/\" + $PartisShape[1] + \".randSin)*\" + $randNoiseX + \"))*\" + $randXMove + \");\\n\");\n            $GotasCaenMoveExpression += (\"        if (\" + $PartisShape[1] + \".goalV < \" + $randCaida + \"){\\n\");\n           \t$GotasCaenMoveExpression +=\t(\"            if (\" + $PartisShape[1] + \".goalPP > 0.06){\\n\");\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] +\t\".goalPP -= 0.05;\\n\");\n            $GotasCaenMoveExpression += \"            } else {\\n\";\n            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".goalPP = 0.1;\\n\");\n//            $GotasCaenMoveExpression += (\"                \" + $PartisShape[1] + \".lifespanPP = 0;\\n\");\n            $GotasCaenMoveExpression += \"            }\\n\";\n            $GotasCaenMoveExpression += \"        }\\n\";\n            $GotasCaenMoveExpression += \"    }\\n\";\n            $GotasCaenMoveExpression += \"}\\n\";\n\n        } \n    }\n    dynExpression -s $GotasCaenMoveExpression -rbd $PartisShape[1];\n}\n\n//Cancel driver gotas\n\nglobal proc driverGotasCancel(){\n    if (`window -ex GotasFijasOk`) {\n        deleteUI -window GotasFijasOk;\n    }\n    currentTime -edit 0;\n}\n\n//Create Driver Drops Particles\n\nglobal proc createDrops(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select a goal object.\";\n    } else {\n        if (`objExists Gotas_Fijas_Exp`){\n            delete Gotas_Fijas_Exp;\n        }\n        if (`objExists Driver_Gotas_Exp`){\n            delete Driver_Gotas_Exp;\n        }\n        if (`objExists Trails_Exp`){\n            delete Trails_Exp;\n        }\n        if (`objExists Water_Drops_Exp`){\n            delete Water_Drops_Exp;\n        }\n        select -r $selObjShort[0];\n        grupo($selObjShort[0]);     \n        float $radiusUno = `textField -q -tx radius2TF`;\n        float $randRadiusUno = `textField -q -tx randomRadius2TF`;\n        float $frameRate = `textField -q -tx frameRate2TF`;\n        int $maxCount = `textField -q -tx count2TF`;        \n        int $frameEndDriverGotas = `textField -q -tx frameEnd2TF`;\n        if ($frameEndDriverGotas > (`playbackOptions -q -max`)){\n            playbackOptions -aet $frameEndDriverGotas -max $frameEndDriverGotas;\n        }\n        NParticleMenu MayaWindow|mainNParticleMenu;       \n        updateNParticleStyleMenu \"Water\";\n        select -cl;\n        string $emisorCaida[] = `emitter -type omni -r $frameRate -sro 0 -nuv 0 -cye none -cyi 1 -spd 0 -srn 0 -nsp 0 -tsp 0 -mxd 0 -mnd 0 -dx 1 -dy 0 -dz 0 -sp 0 -n ($selObjShort[0] + \"_Driver_Drops_Creation_Emitter\")`;\n        string $particulasCaida[] = `nParticle -n ($selObjShort[0] + \"_Driver_Drops_Creation_nParticles\")`;\n        addAttr -h 0 -ln \"driver\" -at double $emisorCaida[0];\n        addAttr -h 0 -ln \"driver\" -at double $particulasCaida[1];        \n        connectDynamic -em $emisorCaida[0] $particulasCaida[0];\n//        string $gravity[] = `gravity -pos 0 0 0 -m 9.8 -att 0 -dx 0 -dy -1 -dz 0  -mxd -1  -vsh none -vex 0 -vof 0 0 0 -vsw 360 -tsr 0.5 -n ($selObjShort[0] + \"_Driver_Drops_Gravity\")`;\n//        connectDynamic -f $gravity[0]  $particulasCaida[1];        \n//        grupo($gravity[0]);\n        grupo($emisorCaida[0]);\n        grupo($particulasCaida[0]);\n        string $nucleus[] = `listConnections -d 1 -s 1 ($particulasCaida[0] + \".currentState\")`;\n\n        setAttr ($nucleus[0] + \".gravity\") 0;\n        setAttr ($particulasCaida[0] + \".maxCount\") $maxCount;\n        setAttr ($particulasCaida[0] + \".radiusScaleSPH\") 0;\n        setAttr ($particulasCaida[0] + \".radius\") $radiusUno;\n        setAttr ($particulasCaida[0] + \".radiusScaleInput\") 5;\n        setAttr ($particulasCaida[0] + \".radiusScaleRandomize\") $randRadiusUno;\n        goal -w 0.5 -utr 0   -g $selObjShort[0]  $particulasCaida[0];\n        setAttr ($particulasCaida[0] + \".collide\") 1;\n        setAttr ($particulasCaida[0] + \".conserve\") 1;\n        setAttr ($particulasCaida[0] + \".goalSmoothness\") 0.001;\n        setAttr ($particulasCaida[0] + \".goalWeight[0]\") 1;\n        setAttr ($particulasCaida[0] + \".lifespanMode\") 3;\n        setAttr ($particulasCaida[0] + \".collideWidthScale\") 0.6;        \n\n        addAttr -ln goalU -dt doubleArray $particulasCaida[1];\n        addAttr -ln goalU0 -dt doubleArray $particulasCaida[1];\n        addAttr -ln goalV -dt doubleArray $particulasCaida[1];\n        addAttr -ln goalV0 -dt doubleArray $particulasCaida[1];\n        addAttr -ln \"randSin0\"  -dt doubleArray  $particulasCaida[1];\n        addAttr -ln \"randSin\"  -dt doubleArray  $particulasCaida[1];\n        setAttr -e-keyable true ($particulasCaida[1] + \".randSin\");\n        addAttr -ln \"randMov0\"  -dt doubleArray  $particulasCaida[1];\n        addAttr -ln \"randMov\"  -dt doubleArray  $particulasCaida[1];\n        setAttr -e-keyable true ($particulasCaida[1] + \".randMov\");\n        addAttr -ln \"startOffset0\"  -dt doubleArray  $particulasCaida[1];\n        addAttr -ln \"startOffset\"  -dt doubleArray  $particulasCaida[1];\n        setAttr -e-keyable true ($particulasCaida[1] + \".startOffset\");\n        \n        string $GotasCaenCreationExpression = ($particulasCaida[1] + \".goalPP = 1;\\n\");\n            $GotasCaenCreationExpression += ($particulasCaida[1] + \".randSin = rand(\" + (`textField -q -tx velocity1TF`) + \",\" + (`textField -q -tx velocity2TF`) + \");\\n\");\n            $GotasCaenCreationExpression += ($particulasCaida[1] + \".startOffset = rand(\" + (`textField -q -tx ageOffset1TF`) + \",\" + (`textField -q -tx ageOffset2TF`) + \");\\n\");\n            $GotasCaenCreationExpression += ($particulasCaida[1] + \".goalU = rand(\" + (`textField -q -tx goalU1TF`) + \",\" + (`textField -q -tx goalU2TF`) + \");\\n\");\n            $GotasCaenCreationExpression += ($particulasCaida[1] + \".goalV = rand(\" + (`textField -q -tx goalV1TF`) + \",\" + (`textField -q -tx goalV2TF`) + \");\\n\");\n            $GotasCaenCreationExpression += ($particulasCaida[1] + \".randMov = rand(0,\" + (`textField -q -tx movesTF`) + \".99);\\n\");\n\n        string $CreationExp = `dynExpression -c -s $GotasCaenCreationExpression`;        \n\n        string $gotasFijasVentana = \"if (frame == \";\n            $gotasFijasVentana += $frameEndDriverGotas;\n            $gotasFijasVentana += \"){\\n\";\n            $gotasFijasVentana += \"    play -state off;\\n\";\n            $gotasFijasVentana += (\"    select \" + $particulasCaida[0] + \";\\n\");\n            $gotasFijasVentana += \"    if (`window -ex GotasFijasOk`) {\\n\";\n            $gotasFijasVentana += \"        deleteUI -window GotasFijasOk;\\n\";\n            $gotasFijasVentana += \"    }\\n\";\n            $gotasFijasVentana += \"    window -s 0 -t \\\"DRIVER WATER DROPS\\\" -w 350 -h 250 -minimizeButton false  -maximizeButton false GotasFijasOk;\\n\";\n            $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"            text -font \\\"boldLabelFont\\\" -l \\\"APPLY INITIAL STATE?\\\";\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 5 -columnWidth 1 10 -columnWidth 2 80 -columnWidth 3 10 -columnWidth 4 80 -columnWidth 5 10;\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"            global proc Aplicar(){\\n\";\n            $gotasFijasVentana += (\"                driverGotasApply(\\\"\" + $particulasCaida[0] + \"\\\",\\\"\" + $emisorCaida[0] + \"\\\",\\\"\" + $selObjShort[0] + \"\\\");\\n\");\n            $gotasFijasVentana += \"            }\\n\";\n            $gotasFijasVentana += \"            button -l \\\"APPLY\\\" -c\\\"Aplicar()\\\";\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";            \n            $gotasFijasVentana += \"            button -l \\\"CANCEL\\\" -c\\\"driverGotasCancel()\\\";\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n            $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n            $gotasFijasVentana += \"    showWindow;\\n\";\n            $gotasFijasVentana += \"}\\n\";\n\n        string $playDriver = `expression -s $gotasFijasVentana -n \"Driver_Gotas_Exp\"`;\n        play -forward true;\n  \n        currentTime -edit 0;\n        play -forward true;\n    }\n}\n\n//Apply water drops\n\nglobal proc waterDropsApply(string $nParticles, string $emitter, string $object){\n    if (`window -ex GotasFijasOk`) {\n      deleteUI -window GotasFijasOk;\n    }\n    if (`objExists Water_Drops_Exp`){\n       delete Water_Drops_Exp;\n    }\n    select -r $nParticles;\n    string $gotasFijasPartsRename = `rename \"Water_Drops_nParticles\"`;\n    select -r $emitter;\n    string $gotasFijasEmitter[] = `ls -sl`;\n    string $gotasFijasEmitterRename = `rename \"Water_Drops_Emitter\"`;\n    select -r $gotasFijasPartsRename;\n    setNClothStartState;\n    performSetNClothStartState 1;\n    currentTime -edit 0;\n    select -r $object;\n}\n\n//Cancel water Drops\n\nglobal proc waterDropsCancel(){\n    if (`window -ex GotasFijasOk`) {\n        deleteUI -window GotasFijasOk;\n    }\n    currentTime -edit 0;\n}\n\n//Create Water Drops Particles\n\nglobal proc createWater(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select Driver Drops Particles.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" /*&& `attributeExists \"driver\" $obj`*/){\n                if (`objExists Gotas_Fijas_Exp`){\n                    delete Gotas_Fijas_Exp;\n                }\n                if (`objExists Driver_Gotas_Exp`){\n                    delete Driver_Gotas_Exp;\n                }\n                if (`objExists Trails_Exp`){\n                    delete Trails_Exp;\n                }\n                if (`objExists Water_Drops_Exp`){\n                    delete Water_Drops_Exp;\n                }\n                float $radiusUno = `textField -q -tx radius3TF`;\n                float $randRadiusUno = `textField -q -tx randomRadius3TF`;\n                float $frameRate = `textField -q -tx frameRate3TF`;\n                int $frameEndDriverGotas = `textField -q -tx frameEnd3TF`;\n                if ($frameEndDriverGotas > (`playbackOptions -q -max`)){\n                    playbackOptions -aet $frameEndDriverGotas -max $frameEndDriverGotas;\n                }\n                NParticleMenu MayaWindow|mainNParticleMenu;       \n                updateNParticleStyleMenu \"Water\";\n                string $emisorCaida[] = `emitter -type omni -r $frameRate -sro 0 -nuv 0 -cye none -cyi 1 -spd 0 -srn 0 -nsp 0 -tsp 0 -mxd 0 -mnd 0 -dx 1 -dy 0 -dz 0 -sp 0 -n \"Water_Drops_Creation_Emitter\"`;\n                string $particulasCaida[] = `nParticle -n \"Water_Drops_Creation_nParticles\"`;\n                addAttr -h 0 -ln \"water\" -at double $emisorCaida[1];\n                addAttr -h 0 -ln \"water\" -at double $particulasCaida[1];        \n                connectDynamic -em $emisorCaida[1] $particulasCaida[0];\n        //        string $gravity[] = `gravity -pos 0 0 0 -m 9.8 -att 0 -dx 0 -dy -1 -dz 0  -mxd -1  -vsh none -vex 0 -vof 0 0 0 -vsw 360 -tsr 0.5 -n ($selObjShort[0] + \"_Driver_Drops_Gravity\")`;\n        //        connectDynamic -f $gravity[0]  $particulasCaida[1];        \n        //        grupo($gravity[0]);\n                grupo($particulasCaida[0]);\n                string $nucleus[] = `listConnections -d 1 -s 1 ($particulasCaida[0] + \".currentState\")`;\n        \n                setAttr ($nucleus[0] + \".gravity\") 0;\n                setAttr ($emisorCaida[1] + \".emitterType\") 0;\n                setAttr ($emisorCaida[1] + \".spread\") 1;\n                setAttr ($emisorCaida[1] + \".directionX\") 0;\n                setAttr ($emisorCaida[1] + \".speed\") 0;\n\n\n                setAttr ($particulasCaida[0] + \".radius\") $radiusUno;\n                setAttr ($particulasCaida[0] + \".radiusScaleRandomize\") $randRadiusUno;\n                setAttr ($particulasCaida[0] + \".collide\") 0;\n                setAttr ($particulasCaida[0] + \".lifespanMode\") 1;\n                setAttr ($particulasCaida[0] + \".radiusScale[0].radiusScale_Position\") 0;\n                setAttr ($particulasCaida[0] + \".radiusScale[0].radiusScale_FloatValue\") 1;\n                setAttr ($particulasCaida[0] + \".radiusScale[0].radiusScale_Interp\") 2;\n                setAttr ($particulasCaida[0] + \".radiusScale[1].radiusScale_Position\") 0.252174;\n                setAttr ($particulasCaida[0] + \".radiusScale[1].radiusScale_FloatValue\") 0.44;\n                setAttr ($particulasCaida[0] + \".radiusScale[1].radiusScale_Interp\") 2;\n                setAttr ($particulasCaida[0] + \".radiusScale[2].radiusScale_Position\") 0.521739;\n                setAttr ($particulasCaida[0] + \".radiusScale[2].radiusScale_FloatValue\") 0;\n                setAttr ($particulasCaida[0] + \".radiusScale[2].radiusScale_Interp\") 2;\n                setAttr ($particulasCaida[0] + \".radiusScaleInput\") 1;\n                setAttr ($particulasCaida[0] + \".radiusScaleInputMax\") 2.808989;\n                setAttr ($particulasCaida[0] + \".radiusScaleRandomize\") 0.060;\n                setAttr ($particulasCaida[0] + \".radiusScaleSPH\") 0;         \n                \n                string $gotasFijasVentana = \"if (frame == \";\n                    $gotasFijasVentana += $frameEndDriverGotas;\n                    $gotasFijasVentana += \"){\\n\";\n                    $gotasFijasVentana += \"    play -state off;\\n\";\n                    $gotasFijasVentana += (\"    select \" + $particulasCaida[0] + \";\\n\");\n                    $gotasFijasVentana += \"    if (`window -ex GotasFijasOk`) {\\n\";\n                    $gotasFijasVentana += \"        deleteUI -window GotasFijasOk;\\n\";\n                    $gotasFijasVentana += \"    }\\n\";\n                    $gotasFijasVentana += \"    window -s 0 -t \\\"DRIVER WATER DROPS\\\" -w 350 -h 250 -minimizeButton false  -maximizeButton false GotasFijasOk;\\n\";\n                    $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"            text -font \\\"boldLabelFont\\\" -l \\\"APPLY INITIAL STATE?\\\";\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 5 -columnWidth 1 10 -columnWidth 2 80 -columnWidth 3 10 -columnWidth 4 80 -columnWidth 5 10;\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"            global proc Aplicar(){\\n\";\n                    $gotasFijasVentana += (\"                waterDropsApply(\\\"\" + $particulasCaida[0] + \"\\\",\\\"\" + $emisorCaida[1] + \"\\\",\\\"\" + $selObjShort[0] + \"\\\");\\n\");\n                    $gotasFijasVentana += \"            }\\n\";\n                    $gotasFijasVentana += \"            button -l \\\"APPLY\\\" -c\\\"Aplicar()\\\";\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";            \n                    $gotasFijasVentana += \"            button -l \\\"CANCEL\\\" -c\\\"waterDropsCancel()\\\";\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"    showWindow;\\n\";\n                    $gotasFijasVentana += \"}\\n\";\n        \n                string $playDriver = `expression -s $gotasFijasVentana -n \"Water_Drops_Exp\"`;\n                play -forward true;\n          \n                currentTime -edit 0;\n                play -forward true;\n                \n            } else {\n                warning \"select Driver Drops Particles.\";\n            }\n        }       \n    }\n}\n\n\n//Create Trails Particles\n\nglobal proc createTrails(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n                currentTime -edit 0;\n    if (size($selObjShort) == 0 ){\n        warning \"select Driver Drops Particles.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"nParticle\" /*&& `attributeExists \"driver\" $obj`*/){\n                if (`objExists Gotas_Fijas_Exp`){\n                    delete Gotas_Fijas_Exp;\n                }\n                if (`objExists Driver_Gotas_Exp`){\n                    delete Driver_Gotas_Exp;\n                }\n                if (`objExists Trails_Exp`){\n                    delete Trails_Exp;\n                }\n                if (`objExists Water_Drops_Exp`){\n                    delete Water_Drops_Exp;\n                }\n                float $radiusUno = `textField -q -tx radius4TF`;\n                float $randRadiusUno = `textField -q -tx randomRadius4TF`;\n                float $frameRate = `textField -q -tx frameRate4TF`;\n                NParticleMenu MayaWindow|mainNParticleMenu;       \n                updateNParticleStyleMenu \"Water\";\n                string $emisorCaida[] = `emitter -type omni -r $frameRate -sro 0 -nuv 0 -cye none -cyi 1 -spd 0 -srn 0 -nsp 0 -tsp 0 -mxd 0 -mnd 0 -dx 1 -dy 0 -dz 0 -sp 0 -n \"Water_Trails_Creation_Emitter\"`;\n                string $particulasCaida[] = `nParticle -n \"Water_Trails_Creation_nParticles\"`;\n                addAttr -h 0 -ln \"trail\" -at double $emisorCaida[1];\n                addAttr -h 0 -ln \"trail\" -at double $particulasCaida[1];        \n                connectDynamic -em $emisorCaida[1] $particulasCaida[0];\n        //        string $gravity[] = `gravity -pos 0 0 0 -m 9.8 -att 0 -dx 0 -dy -1 -dz 0  -mxd -1  -vsh none -vex 0 -vof 0 0 0 -vsw 360 -tsr 0.5 -n ($selObjShort[0] + \"_Driver_Drops_Gravity\")`;\n        //        connectDynamic -f $gravity[0]  $particulasCaida[1];        \n        //        grupo($gravity[0]);\n                grupo($particulasCaida[0]);\n                string $nucleus[] = `listConnections -d 1 -s 1 ($particulasCaida[0] + \".currentState\")`;\n        \n                setAttr ($nucleus[0] + \".gravity\") 0;\n                setAttr ($emisorCaida[1] + \".speed\") 0;\n                select -r $emisorCaida[1];\n                string $gotasFijasEmitterRename = `rename \"Water_Trails_Emitter\"`; \n                                \n                select -r $particulasCaida[0];\n                setAttr ($particulasCaida[0] + \".radius\") $radiusUno;\n                setAttr ($particulasCaida[0] + \".radiusScaleRandomize\") $randRadiusUno;\n                setAttr ($particulasCaida[0] + \".collide\") 0;\n                setAttr ($particulasCaida[0] + \".radiusScaleSPH\") 0;\n\n                select -r $particulasCaida[0];\n                string $TrailsPartisRename = `rename \"Water_Trails_nParticles\"`;\n  \n\n                string $TrailExpression = \"if (frame == 1){\\n\";\n                    $TrailExpression += \"    play -state off;\\n\";\n                    $TrailExpression += (\"    setAttr \" + $TrailsPartisRename + \".radiusScaleInput 5;\\n\");\n                    $TrailExpression += \"}\";\n                \n                string $playDriver = `expression -s $TrailExpression -n \"Trails_Exp\"`;\n                \n                for ($i = 0; $i < 2; $i++){\n                    currentTime -edit $i;\n                }    \n\n                currentTime -edit 0;\n\n                if (`objExists Trails_Exp`){\n                    delete Trails_Exp;\n                }\n         \n            }\n        }       \n    }\n}\n\n//Apply water drops\n\nglobal proc waterDropsObjectApply(string $nParticles, string $emitter, string $object){\n    if (`window -ex GotasFijasOk`) {\n      deleteUI -window GotasFijasOk;\n    }\n    if (`objExists Water_Drops_Exp`){\n       delete Water_Drops_Exp;\n    }\n    select -r $nParticles;\n    string $gotasFijasPartsRename = `rename ($object + \"_Water_Drops_nParticles\")`;\n    select -r $emitter;\n    string $gotasFijasEmitter[] = `ls -sl`;\n    string $gotasFijasEmitterRename = `rename ($object + \"_Water_Drops_Emitter\")`;\n    select -r $gotasFijasPartsRename;\n    setNClothStartState;\n    performSetNClothStartState 1;\n    currentTime -edit 0;\n    select -r $object;\n}\n\n//Create Water Drops Object\n\nglobal proc createObjectWater(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n    if (size($selObjShort) == 0 ){\n        warning \"select Object.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"transform\" /*&& `attributeExists \"driver\" $obj`*/){\n                if (`objExists Gotas_Fijas_Exp`){\n                    delete Gotas_Fijas_Exp;\n                }\n                if (`objExists Driver_Gotas_Exp`){\n                    delete Driver_Gotas_Exp;\n                }\n                if (`objExists Trails_Exp`){\n                    delete Trails_Exp;\n                }\n                if (`objExists Water_Drops_Exp`){\n                    delete Water_Drops_Exp;\n                }\n                float $radiusUno = `textField -q -tx radius3TF`;\n                float $randRadiusUno = `textField -q -tx randomRadius3TF`;\n                float $frameRate = `textField -q -tx frameRate3TF`;\n                int $frameEndDriverGotas = `textField -q -tx frameEnd3TF`;\n                if ($frameEndDriverGotas > (`playbackOptions -q -max`)){\n                    playbackOptions -aet $frameEndDriverGotas -max $frameEndDriverGotas;\n                }\n                select -cl;\n                NParticleMenu MayaWindow|mainNParticleMenu;       \n                updateNParticleStyleMenu \"Water\";\n                string $emisorCaida[] = `emitter -type omni -r $frameRate -sro 0 -nuv 0 -cye none -cyi 1 -spd 0 -srn 0 -nsp 0 -tsp 0 -mxd 0 -mnd 0 -dx 1 -dy 0 -dz 0 -sp 0 -n ($selObjShort[0] + \"_Water_Drops_Creation_Emitter\")`;\n                string $particulasCaida[] = `nParticle -n ( $selObjShort[0] + \"_Water_Drops_Creation_nParticles\")`;\n                addAttr -h 0 -ln \"water\" -at double $emisorCaida[0];\n                addAttr -h 0 -ln \"water\" -at double $particulasCaida[1];        \n                connectDynamic -em $emisorCaida[0] $particulasCaida[0];\n        //        string $gravity[] = `gravity -pos 0 0 0 -m 9.8 -att 0 -dx 0 -dy -1 -dz 0  -mxd -1  -vsh none -vex 0 -vof 0 0 0 -vsw 360 -tsr 0.5 -n ($selObjShort[0] + \"_Driver_Drops_Gravity\")`;\n        //        connectDynamic -f $gravity[0]  $particulasCaida[1];        \n        //        grupo($gravity[0]);\n\n                setAttr ($emisorCaida[0] + \".emitterType\") 0;\n                setAttr ($emisorCaida[0] + \".spread\") 1;\n                setAttr ($emisorCaida[0] + \".directionX\") 0;\n                setAttr ($emisorCaida[0] + \".speed\") 0;\n\n                parent $emisorCaida[0] $selObjShort[0];\n                setAttr ($emisorCaida[0] + \".translateZ\") 0;\n                setAttr ($emisorCaida[0] + \".translateX\") 0;\n                setAttr ($emisorCaida[0] + \".translateY\") 0;\n\n                setAttr ($particulasCaida[0] + \".radius\") $radiusUno;\n                setAttr ($particulasCaida[0] + \".radiusScaleRandomize\") $randRadiusUno;\n                setAttr ($particulasCaida[0] + \".collide\") 0;\n                setAttr ($particulasCaida[0] + \".lifespanMode\") 1;\n                setAttr ($particulasCaida[0] + \".radiusScale[0].radiusScale_Position\") 0;\n                setAttr ($particulasCaida[0] + \".radiusScale[0].radiusScale_FloatValue\") 1;\n                setAttr ($particulasCaida[0] + \".radiusScale[0].radiusScale_Interp\") 2;\n                setAttr ($particulasCaida[0] + \".radiusScale[1].radiusScale_Position\") 0.252174;\n                setAttr ($particulasCaida[0] + \".radiusScale[1].radiusScale_FloatValue\") 0.44;\n                setAttr ($particulasCaida[0] + \".radiusScale[1].radiusScale_Interp\") 2;\n                setAttr ($particulasCaida[0] + \".radiusScale[2].radiusScale_Position\") 0.521739;\n                setAttr ($particulasCaida[0] + \".radiusScale[2].radiusScale_FloatValue\") 0;\n                setAttr ($particulasCaida[0] + \".radiusScale[2].radiusScale_Interp\") 2;\n                setAttr ($particulasCaida[0] + \".radiusScaleInput\") 1;\n                setAttr ($particulasCaida[0] + \".radiusScaleInputMax\") 2.808989;\n                setAttr ($particulasCaida[0] + \".radiusScaleRandomize\") 0.060;\n                setAttr ($particulasCaida[0] + \".radiusScaleSPH\") 0;         \n\n                string $nucleus[] = `listConnections -d 1 -s 1 ($particulasCaida[0] + \".currentState\")`;\n        \n                setAttr ($nucleus[0] + \".gravity\") 0;\n                \n                string $gotasFijasVentana = \"if (frame == \";\n                    $gotasFijasVentana += $frameEndDriverGotas;\n                    $gotasFijasVentana += \"){\\n\";\n                    $gotasFijasVentana += \"    play -state off;\\n\";\n                    $gotasFijasVentana += (\"    select \" + $particulasCaida[0] + \";\\n\");\n                    $gotasFijasVentana += \"    if (`window -ex GotasFijasOk`) {\\n\";\n                    $gotasFijasVentana += \"        deleteUI -window GotasFijasOk;\\n\";\n                    $gotasFijasVentana += \"    }\\n\";\n                    $gotasFijasVentana += \"    window -s 0 -t \\\"DRIVER WATER DROPS\\\" -w 350 -h 250 -minimizeButton false  -maximizeButton false GotasFijasOk;\\n\";\n                    $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"            text -font \\\"boldLabelFont\\\" -l \\\"APPLY INITIAL STATE?\\\";\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 5 -columnWidth 1 10 -columnWidth 2 80 -columnWidth 3 10 -columnWidth 4 80 -columnWidth 5 10;\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"            global proc Aplicar(){\\n\";\n                    $gotasFijasVentana += (\"                waterDropsObjectApply(\\\"\" + $particulasCaida[0] + \"\\\",\\\"\" + $emisorCaida[0] + \"\\\",\\\"\" + $selObjShort[0] + \"\\\");\\n\");\n                    $gotasFijasVentana += \"            }\\n\";\n                    $gotasFijasVentana += \"            button -l \\\"APPLY\\\" -c\\\"Aplicar()\\\";\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";            \n                    $gotasFijasVentana += \"            button -l \\\"CANCEL\\\" -c\\\"waterDropsCancel()\\\";\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"        rowColumnLayout -numberOfColumns 1;\\n\";\n                    $gotasFijasVentana += \"            separator -style \\\"none\\\" -h 5;\\n\";\n                    $gotasFijasVentana += \"    showWindow;\\n\";\n                    $gotasFijasVentana += \"}\\n\";\n        \n                string $playDriver = `expression -s $gotasFijasVentana -n \"Water_Drops_Exp\"`;\n                play -forward true;\n          \n                currentTime -edit 0;\n                play -forward true;\n            } else {\n                warning \"select Object.\";\n            }\n        }       \n    }\n}\n\n//Create Trails Particles Object\n\nglobal proc createObjectTrails(){\n    string $selObjShort[] = `ls -sl`;\n    string $selObj[] = `ls -sl -dag`;\n                currentTime -edit 0;\n    if (size($selObjShort) == 0 ){\n        warning \"select Object.\";\n    } else {\n        for ($obj in $selObj){\n            string $nodeType = `nodeType $obj`;\n            if ($nodeType == \"transform\" /*&& `attributeExists \"driver\" $obj`*/){\n                if (`objExists Gotas_Fijas_Exp`){\n                    delete Gotas_Fijas_Exp;\n                }\n                if (`objExists Driver_Gotas_Exp`){\n                    delete Driver_Gotas_Exp;\n                }\n                if (`objExists Trails_Exp`){\n                    delete Trails_Exp;\n                }\n                if (`objExists Water_Drops_Exp`){\n                    delete Water_Drops_Exp;\n                }\n                select -cl;                \n                float $radiusUno = `textField -q -tx radius4TF`;\n                float $randRadiusUno = `textField -q -tx randomRadius4TF`;\n                float $frameRate = `textField -q -tx frameRate4TF`;\n                NParticleMenu MayaWindow|mainNParticleMenu;       \n                updateNParticleStyleMenu \"Water\";\n                string $emisorCaida[] = `emitter -type omni -r $frameRate -sro 0 -nuv 0 -cye none -cyi 1 -spd 0 -srn 0 -nsp 0 -tsp 0 -mxd 0 -mnd 0 -dx 1 -dy 0 -dz 0 -sp 0 -n ($selObjShort[0] + \"_Water_Trails_Creation_Emitter\")`;\n                string $particulasCaida[] = `nParticle -n ($selObjShort[0] + \"_Water_Trails_Creation_nParticles\")`;\n                addAttr -h 0 -ln \"trail\" -at double $emisorCaida[0];\n                addAttr -h 0 -ln \"trail\" -at double $particulasCaida[1];        \n                connectDynamic -em $emisorCaida[0] $particulasCaida[0];\n        //        string $gravity[] = `gravity -pos 0 0 0 -m 9.8 -att 0 -dx 0 -dy -1 -dz 0  -mxd -1  -vsh none -vex 0 -vof 0 0 0 -vsw 360 -tsr 0.5 -n ($selObjShort[0] + \"_Driver_Drops_Gravity\")`;\n        //        connectDynamic -f $gravity[0]  $particulasCaida[1];        \n        //        grupo($gravity[0]);\n//                grupo($particulasCaida[0]);\n                setAttr ($emisorCaida[0] + \".speed\") 0;\n                select -r $emisorCaida[0];\n\n                parent $emisorCaida[0] $selObjShort[0];\n                setAttr ($emisorCaida[0] + \".translateZ\") 0;\n                setAttr ($emisorCaida[0] + \".translateX\") 0;\n                setAttr ($emisorCaida[0] + \".translateY\") 0;\n\n                string $gotasFijasEmitterRename = `rename ($selObjShort[0] + \"_Water_Trails_Emitter\")`; \n                                \n                select -r $particulasCaida[0];\n                setAttr ($particulasCaida[0] + \".radius\") $radiusUno;\n                setAttr ($particulasCaida[0] + \".radiusScaleRandomize\") $randRadiusUno;\n                setAttr ($particulasCaida[0] + \".collide\") 0;\n                setAttr ($particulasCaida[0] + \".radiusScaleSPH\") 0;\n\n                string $nucleus[] = `listConnections -d 1 -s 1 ($particulasCaida[0] + \".currentState\")`;\n        \n                setAttr ($nucleus[0] + \".gravity\") 0;\n                \n                select -r $particulasCaida[0];\n                string $TrailsPartisRename = `rename ($selObjShort[0] + \"_Water_Trails_nParticles\")`;\n  \n\n                string $TrailExpression = \"if (frame == 1){\\n\";\n                    $TrailExpression += \"    play -state off;\\n\";\n                    $TrailExpression += (\"    setAttr \" + $TrailsPartisRename + \".radiusScaleInput 5;\\n\");\n                    $TrailExpression += \"}\";\n                \n                string $playDriver = `expression -s $TrailExpression -n \"Trails_Exp\"`;\n                \n                for ($i = 0; $i < 2; $i++){\n                    currentTime -edit $i;\n                }    \n\n                currentTime -edit 0;\n\n                if (`objExists Trails_Exp`){\n                    delete Trails_Exp;\n                }\n         \n            }\n        }       \n    }\n}\n\nprint \"Water Drops 1.0 By Mariano Antico.\";\n" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "#SP2M v1.03d author 戴巍\n#http://weibo.com/david376\n\n############################################################################################\n#重要。目前版本针对vray和arnold可以结合各种maya版本使用。\n#针对redshfit只测试了2016版本的maya，别的版本目测会有问题，遇到问题请联系我，持续修改升级。这就是个苦力活\n\n#感谢之前一直帮忙测试，提供bug的朋友，因为你们，这个工具变得更好更完善\n\n#############################################################################################\nimport maya.cmds as mc\nif mc.dockControl('SP2Maya_dockControl',ex = 1):\n\tmc.deleteUI('SP2Maya_dockControl')\nmc.window('SP2Maya',t = 'SP2Maya' )\n\nmc.showWindow()\n\nmainRCL = mc.rowColumnLayout(w = 100,numberOfColumns = 1)\nmc.dockControl('SP2Maya_dockControl',area = 'left',content = 'SP2Maya',l = 'SP2Maya' )\nmc.separator(style = 'none',h = 20)\n\n\n#define which renderer is using \n\nrendererUsing = 'vray'\n\ndef connectUVNodeToTextureNode(UVnode,textureNode):\n\tmc.connectAttr(UVnode +'.outUV',textureNode + '.uvCoord',force = 1)\n\tmc.connectAttr(UVnode +'.outUvFilterSize',textureNode + '.uvFilterSize',force = 1)\n\tmc.connectAttr(UVnode +'.coverage',textureNode + '.coverage',force = 1)\n\tmc.connectAttr(UVnode +'.translateFrame',textureNode + '.translateFrame',force = 1)\n\tmc.connectAttr(UVnode +'.rotateFrame',textureNode + '.rotateFrame',force = 1)\n\tmc.connectAttr(UVnode +'.mirrorU',textureNode + '.mirrorU',force = 1)\n\tmc.connectAttr(UVnode +'.mirrorV',textureNode + '.mirrorV',force = 1)\n\tmc.connectAttr(UVnode +'.wrapU',textureNode + '.wrapU',force = 1)\n\tmc.connectAttr(UVnode +'.wrapV',textureNode + '.wrapV',force = 1)\n\tmc.connectAttr(UVnode +'.repeatUV',textureNode + '.repeatUV',force = 1)\n\tmc.connectAttr(UVnode +'.vertexUvOne',textureNode + '.vertexUvOne',force = 1)\n\tmc.connectAttr(UVnode +'.vertexUvTwo',textureNode + '.vertexUvTwo',force = 1)\n\tmc.connectAttr(UVnode +'.vertexUvThree',textureNode + '.vertexUvThree',force = 1)\n\tmc.connectAttr(UVnode +'.vertexCameraOne',textureNode + '.vertexCameraOne',force = 1)\n\tmc.connectAttr(UVnode +'.noiseUV',textureNode + '.noiseUV',force = 1)\n\tmc.connectAttr(UVnode +'.offset',textureNode + '.offset',force = 1)\n\tmc.connectAttr(UVnode +'.rotateUV',textureNode + '.rotateUV',force = 1)\n\n#get all file names will be used in the sourceimages folder or user defined folder\ndef getFileNames(materialName,userDefinedPath):\n\tif userDefinedPath == '':\n\t\tprojectPath = mc.workspace(o =1 ,q =1)\n\t\ttargetPath = projectPath + r'/' + 'sourceimages/'\n\telse:\n\t\ttargetPath = userDefinedPath + '\\\\'\n\t\n\tallFileNames = mc.getFileList(folder = targetPath)\n\tprint allFileNames\n\tfileNamesUsing = []\n\tfileExsists = False\n\tfor fileName in allFileNames:\n\t\tif materialName in fileName:\n\t\t\tfileNamesUsing.append(fileName)\n\t\t\tfileExsists = True\n\tif not fileExsists:\n\t\tmc.error('没有找到对应贴图，请检查')\n\treturn fileNamesUsing\n\t\n\t\t\n\n#udim bool used to judge weather to use udim\nudim = False\ndef UDIM_on(*argus):\n\tglobal udim\n\tudim = True\ndef UDIM_off(*argus):\n\tglobal udim\n\tudim = False\ndef UDIM_judge(fileNode):\n\tif udim:\n\t\tmc.setAttr(fileNode + '.uvTilingMode',3)\n\t\tmc.setAttr(fileNode + '.uvTileProxyQuality',4)\n\t\t\n\t\n#create a dict which containts all the textures that having the materialName\n#the keys of the dict are the texture's name\n#the values of the dict are the file nodes which ref to the texture \ndef createTexturesUsing(fileNamesUsing,userDefinedPath):\n\ttexturesUsing = {}\n\ttargetFileExist = False\n\tfor fileName in fileNamesUsing:\n\t\ttry:\n\t\t\ttempFile = mc.shadingNode('file',at = 1,icm = 1)\n\t\texcept:\n\t\t\ttempFile = mc.shadingNode('file',at = 1)\n\t\ttexturesUsing[fileName] = tempFile\n\t\tif userDefinedPath == '':\n\t\t\tmc.setAttr(tempFile + '.fileTextureName','sourceimages' + '\\\\' + fileName,type = 'string')\n\t\t\ttargetFileExist = True\n\t\telse:\n\t\t\tmc.setAttr(tempFile + '.fileTextureName',userDefinedPath + '\\\\' + fileName,type = 'string')\n\t\t\ttargetFileExist = True\n\tif not targetFileExist:\n\t\tmc.error('写错名字了吧小伙子，检查一下')\n\treturn texturesUsing\n\ndef createVrayShadingNetwork(materialName,texturesUsing):\n\t#get current version of maya\n\tversion = mc.about(version = 1)[:4]\n\tversion = int(version)\n\t#if the version is newer than 2016 ,we can use the colormanagement directly\n\tif version >= 2016:\n\t\t#create vray mtl\n\t\tvrayMtl = mc.shadingNode('VRayMtl',asShader = 1,n = materialName)\n\t\tmc.setAttr(vrayMtl + '.bumpMapType',1)\n\t\ttry:\n\t\t\tmc.setAttr(vrayMtl + '.brdfType' , 3)\n\t\texcept:\n\t\t\tmc.warning('当前版本vray没有ggx_brdf，效果可能不好，请注意')\n\n\t\t#create place2dtexture\n\t\tUVnode = mc.shadingNode('place2dTexture',au =1)\n\t\t#connect textures to material\n\t\tfor textureUsing in texturesUsing.keys():\n\t\t\t\n\t\t\tif 'Diffuse' in textureUsing:\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',vrayMtl + '.diffuseColor',f = 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','sRGB',type = 'string')\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Reflection' in textureUsing:\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',vrayMtl + '.reflectionColor',f = 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','sRGB',type = 'string')\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Roughness' in textureUsing:\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.invert',1)\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',vrayMtl + '.reflectionGlossiness',f = 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','sRGB',type = 'string')\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Glossiness' in textureUsing:\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',vrayMtl + '.reflectionGlossiness',f = 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','Raw',type = 'string')\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'ior' in textureUsing:\n\t\t\t\tmc.setAttr(vrayMtl + '.lockFresnelIORToRefractionIOR',0)\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',vrayMtl + '.fresnelIOR',f = 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','Raw',type = 'string')\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Normal' in textureUsing:\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',vrayMtl + '.bumpMap',f = 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','Raw',type = 'string')\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\t\n\telse:\n\t\t#create vray mtl\n\t\tvrayMtl = mc.shadingNode('VRayMtl',asShader = 1,n = materialName)\n\t\tmc.setAttr(vrayMtl + '.bumpMapType',1)\n\t\ttry:\n\t\t\tmc.setAttr(vrayMtl + '.brdfType' , 3)\n\t\texcept:\n\t\t\tmc.warning('当前版本vray没有ggx_brdf，效果可能不好，请注意')\n\t\t#create place2dtexture\n\t\tUVnode = mc.shadingNode('place2dTexture',au =1)\n\t\t#connect textures to material\n\t\tfor textureUsing in texturesUsing.keys():\n\t\t\tif 'Diffuse' in textureUsing:\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',vrayMtl + '.diffuseColor',f = 1)\n\t\t\t\tmc.vray(\"addAttributesFromGroup\", texturesUsing[textureUsing], \"vray_file_gamma\", 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.vrayFileColorSpace',2)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Reflection' in textureUsing: \n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',vrayMtl + '.reflectionColor',f = 1)\n\t\t\t\tmc.vray(\"addAttributesFromGroup\", texturesUsing[textureUsing], \"vray_file_gamma\", 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.vrayFileColorSpace',2)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Roughness' in textureUsing:\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.invert',1)\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',vrayMtl + '.reflectionGlossiness',f = 1)\n\t\t\t\tmc.vray(\"addAttributesFromGroup\", texturesUsing[textureUsing], \"vray_file_gamma\", 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.vrayFileColorSpace',0)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Glossiness' in textureUsing:\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',vrayMtl + '.reflectionGlossiness',f = 1)\n\t\t\t\tmc.vray(\"addAttributesFromGroup\", texturesUsing[textureUsing], \"vray_file_gamma\", 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.vrayFileColorSpace',0)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'ior' in textureUsing:\n\t\t\t\tmc.setAttr(vrayMtl + '.lockFresnelIORToRefractionIOR',0)\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',vrayMtl + '.fresnelIOR',f =1)\n\t\t\t\tmc.vray(\"addAttributesFromGroup\", texturesUsing[textureUsing], \"vray_file_gamma\", 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.vrayFileColorSpace',0)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Normal' in textureUsing:\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',vrayMtl + '.bumpMap',f = 1)\n\t\t\t\tmc.vray(\"addAttributesFromGroup\", texturesUsing[textureUsing], \"vray_file_gamma\", 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.vrayFileColorSpace',0)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\ndef createArnoldShadingNetwork(materialName,texturesUsing):\n\t\n\t#create aistandard mtl\n\taiStandard = mc.shadingNode('aiStandard',asShader = 1,n = materialName)\n\tmc.setAttr(aiStandard + '.Kd',1)\n\tmc.setAttr(aiStandard + '.Ks',1)\n\ttry:\n\t\tmc.setAttr(aiStandard + '.specularDistribution' ,1 )\n\texcept:\n\t\tmc.warning('你使用的arnold版本没有ggx_brdf，效果可能不好')\n\t\n\t#create place2dtexture\n\tUVnode = mc.shadingNode('place2dTexture',au =1)\n\t\n\t#connect textures to material\n\tfor textureUsing in texturesUsing.keys():\n\t\tif 'Diffuse' in textureUsing:\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',aiStandard + '.color')\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'Specular' in textureUsing:\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',aiStandard + '.KsColor')\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'Roughness' in textureUsing:\n\t\t\tgammaCorret = mc.shadingNode('gammaCorrect',au = 1)\n\t\t\tmc.setAttr(gammaCorret + '.gammaX',2.2)\n\t\t\tmc.setAttr(gammaCorret + '.gammaY',2.2)\n\t\t\tmc.setAttr(gammaCorret + '.gammaZ',2.2)\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',gammaCorret + '.value')\n\t\t\tmc.connectAttr(gammaCorret + '.outValueX',aiStandard + '.specularRoughness')\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'f0' in textureUsing:\n\t\t\tmc.setAttr(aiStandard + '.specularFresnel',1)\n\t\t\tgammaCorret = mc.shadingNode('gammaCorrect',au = 1)\n\t\t\tmc.setAttr(gammaCorret + '.gammaX',2.2)\n\t\t\tmc.setAttr(gammaCorret + '.gammaY',2.2)\n\t\t\tmc.setAttr(gammaCorret + '.gammaZ',2.2)\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',gammaCorret + '.value')\n\t\t\tmc.connectAttr(gammaCorret + '.outValueX',aiStandard + '.Ksn')\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'Normal' in textureUsing:\n\t\t\tbumpNode = mc.shadingNode('bump2d',au = 1)\n\t\t\tmc.setAttr(bumpNode + '.bumpInterp', 1)\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',bumpNode + '.bumpValue')\n\t\t\tmc.connectAttr(bumpNode + '.outNormal',aiStandard + '.normalCamera')\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\t\ndef createRedshiftShadingNetwork(materialName,texturesUsing):\n    #create redshift mtl\n\trsMtl = mc.shadingNode('RedshiftMaterial',asShader = 1,n = materialName)\n\tmc.setAttr(rsMtl + '.refl_brdf',1)\n\t\n\t\n\t\n\t#create place2dtexture\n\tUVnode = mc.shadingNode('place2dTexture',au =1)\n\t\n\t#connect textures to material\n\tfor textureUsing in texturesUsing.keys():\n\t\tif 'Diffuse' in textureUsing:\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',rsMtl + '.diffuse_color',f = 1)\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'Reflection' in textureUsing:\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',rsMtl + '.refl_color')\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'Glossiness' in textureUsing:\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','Raw',type = 'string')\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.invert',1)\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',rsMtl + '.refl_roughness')\n\t\t\t\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'f0' in textureUsing:\n\t\t\tmc.setAttr(rsMtl + '.refl_fresnel_mode',1)\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','Raw',type = 'string')\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',rsMtl + '.refl_reflectivity',f = 1)\n\t\t\t\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'ior' in textureUsing:\n\t\t\tmc.setAttr(rsMtl + '.refl_fresnel_mode',3)\n\t\t\tmultiplyDivide = mc.shadingNode('multiplyDivide',au = 1)\n\t\t\tmc.setAttr(multiplyDivide + '.input1X',1)\n\t\t\tmc.setAttr(multiplyDivide + '.input1Y',1)\n\t\t\tmc.setAttr(multiplyDivide + '.input1Z',1)\n\t\t\tmc.setAttr(multiplyDivide + '.operation',2)\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',multiplyDivide + '.input2')\n\t\t\tmc.connectAttr(multiplyDivide + '.output.outputX',rsMtl + '.refl_ior')\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','Raw',type = 'string')\n\t\t\t\t\t\n\t\telif 'Normal' in textureUsing:\n\t\t\tnormalNode = mc.shadingNode('RedshiftNormalMap',au = 1)\n\t\t\tif not udim:\n\t\t\t\tpath = mc.getAttr(texturesUsing[textureUsing] + '.fileTextureName')\n\t\t\telse:\n\t\t\t\tpath = mc.getAttr(texturesUsing[textureUsing] + '.fileTextureName')\n\t\t\t\tpath = path.partition('1001')[0] + '<udim>' + path.partition('1001')[2]\n\t\t\tmc.setAttr(normalNode + '.tex0',path,type = 'string')\n\t\t\tmc.connectAttr(normalNode + '.outDisplacementVector',rsMtl + '.bump_input')\n\t\t\t\n\n    \t\t\t\ndef changingRenderer(*argus):\n    global rendererUsing\n    rendererUsing = mc.optionMenuGrp('Renderer',q = 1 ,v = 1)\ndef openDirectory(*argus):\n\treturnDirectory = mc.fileDialog2(fm = 3,ff = None,ds = 1)\n\tif returnDirectory != None:\n\t\treturnDirectory = returnDirectory[0]\n\telse:\n\t\treturnDirectory = ''\n\n\tmc.textFieldGrp('texutresPath',e = 1, tx = returnDirectory)\t\ndef main(materialName):\n\t#get all file names in the sourceimages folder\n\tuserDefinedPath = mc.textFieldGrp(userDefinedPathTextField,q = 1, tx = 1)\n\ttargetFileNames = getFileNames(materialName,userDefinedPath)\n\ttextureNamesUsing =[]\n\tif udim:\n\t\tfor targetFileName01 in targetFileNames:\n\t\t\ttextureRepeated = False\n\t\t\tfor textureUsing in textureNamesUsing:\n\t\t\t\tif targetFileName01[:-9] == textureUsing[:-9]:\n\t\t\t\t\ttextureRepeated = True\n\t\t\t\t\tbreak\n\t\t\tif textureRepeated:\n\t\t\t\tcontinue\n\t\t\tfor targetFileName02 in targetFileNames:\n\t\t\t\tif (not targetFileName01 == targetFileName02) and (targetFileName01[:-9] == targetFileName02[:-9]):\n\t\t\t\t\t\n\t\t\t\t\ttextureNamesUsing.append(targetFileName01)\n\t\t\t\t\tbreak\n\t\t\t\t\t\n\t\tprint textureNamesUsing\n\telse:\n\t\ttextureNamesUsing = targetFileNames\t\t\t\n\n\t#get a dict contains all the textures will be used\n\ttexturesUsing = createTexturesUsing(textureNamesUsing,userDefinedPath)\n\t\t\n\t#judge every texture using, whether is a udim texture,if yes,change the settings\n\tfor textureUsing in texturesUsing.values():\n\t\tUDIM_judge(textureUsing)\n\t\t\n\tif rendererUsing == 'vray':\n\t\tcreateVrayShadingNetwork(materialName,texturesUsing)\n\telif rendererUsing == 'arnold':\n\t\tcreateArnoldShadingNetwork(materialName,texturesUsing)\n\telif rendererUsing == 'redshift':\n\t    createRedshiftShadingNetwork(materialName,texturesUsing)\n\telse:\n\t\tmc.error('请选择一个你要使用的渲染器,please choose a renderer')\n\n#the UI used to choose renderer\nrenderer = mc.optionMenuGrp('Renderer', l = 'Renderer',cc = changingRenderer)\nmc.menuItem('vray')\nmc.menuItem('arnold')\nmc.menuItem('redshift')\n\n\n\n\nmc.rowColumnLayout(co = (1,'left',141))\n\nmc.separator(h = 50) \nmc.separator(style = 'out') \nmc.checkBox(l = 'udim textures',onc = UDIM_on,ofc = UDIM_off,align = 'right')  \n\nmc.rowColumnLayout(p = mainRCL)\nuserDefinedPathTextField = mc.textFieldGrp('texutresPath',l = 'TexutresPath')\nmc.iconTextButton(style = 'iconOnly',image = 'xgBrowse.png', p = userDefinedPathTextField,c = openDirectory)\nmaterialNameInput = mc.textFieldButtonGrp(l = 'MaterialName',bl = 'excute',bc = 'main(mc.textFieldButtonGrp(materialNameInput,q = 1,text =1 ))')\nmc.separator(style = 'none',h = 20)\nmc.separator()\nmc.text(l = 'sp2m v1.03d',w =230,al = 'right',hyperlink = 1,ww = 1,ann = 'the version of the script')" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "SP2M" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "SP2M" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "pythonFamily.png" 
        -image1 "pythonFamily.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "#SP2M v1.03d author 戴巍\n#http://weibo.com/david376\n\n############################################################################################\n#重要。目前版本针对vray和arnold可以结合各种maya版本使用。\n#针对redshfit只测试了2016版本的maya，别的版本目测会有问题，遇到问题请联系我，持续修改升级。这就是个苦力活\n\n#感谢之前一直帮忙测试，提供bug的朋友，因为你们，这个工具变得更好更完善\n\n#############################################################################################\nimport maya.cmds as mc\nif mc.dockControl('SP2Maya_dockControl',ex = 1):\n\tmc.deleteUI('SP2Maya_dockControl')\nmc.window('SP2Maya',t = 'SP2Maya' )\n\nmc.showWindow()\n\nmainRCL = mc.rowColumnLayout(w = 100,numberOfColumns = 1)\nmc.dockControl('SP2Maya_dockControl',area = 'left',content = 'SP2Maya',l = 'SP2Maya' )\nmc.separator(style = 'none',h = 20)\n\n\n#define which renderer is using \n\nrendererUsing = 'vray'\n\ndef connectUVNodeToTextureNode(UVnode,textureNode):\n\tmc.connectAttr(UVnode +'.outUV',textureNode + '.uvCoord',force = 1)\n\tmc.connectAttr(UVnode +'.outUvFilterSize',textureNode + '.uvFilterSize',force = 1)\n\tmc.connectAttr(UVnode +'.coverage',textureNode + '.coverage',force = 1)\n\tmc.connectAttr(UVnode +'.translateFrame',textureNode + '.translateFrame',force = 1)\n\tmc.connectAttr(UVnode +'.rotateFrame',textureNode + '.rotateFrame',force = 1)\n\tmc.connectAttr(UVnode +'.mirrorU',textureNode + '.mirrorU',force = 1)\n\tmc.connectAttr(UVnode +'.mirrorV',textureNode + '.mirrorV',force = 1)\n\tmc.connectAttr(UVnode +'.wrapU',textureNode + '.wrapU',force = 1)\n\tmc.connectAttr(UVnode +'.wrapV',textureNode + '.wrapV',force = 1)\n\tmc.connectAttr(UVnode +'.repeatUV',textureNode + '.repeatUV',force = 1)\n\tmc.connectAttr(UVnode +'.vertexUvOne',textureNode + '.vertexUvOne',force = 1)\n\tmc.connectAttr(UVnode +'.vertexUvTwo',textureNode + '.vertexUvTwo',force = 1)\n\tmc.connectAttr(UVnode +'.vertexUvThree',textureNode + '.vertexUvThree',force = 1)\n\tmc.connectAttr(UVnode +'.vertexCameraOne',textureNode + '.vertexCameraOne',force = 1)\n\tmc.connectAttr(UVnode +'.noiseUV',textureNode + '.noiseUV',force = 1)\n\tmc.connectAttr(UVnode +'.offset',textureNode + '.offset',force = 1)\n\tmc.connectAttr(UVnode +'.rotateUV',textureNode + '.rotateUV',force = 1)\n\n#get all file names will be used in the sourceimages folder or user defined folder\ndef getFileNames(materialName,userDefinedPath):\n\tif userDefinedPath == '':\n\t\tprojectPath = mc.workspace(o =1 ,q =1)\n\t\ttargetPath = projectPath + r'/' + 'sourceimages/'\n\telse:\n\t\ttargetPath = userDefinedPath + '\\\\'\n\t\n\tallFileNames = mc.getFileList(folder = targetPath)\n\tprint allFileNames\n\tfileNamesUsing = []\n\tfileExsists = False\n\tfor fileName in allFileNames:\n\t\tif materialName in fileName:\n\t\t\tfileNamesUsing.append(fileName)\n\t\t\tfileExsists = True\n\tif not fileExsists:\n\t\tmc.error('没有找到对应贴图，请检查')\n\treturn fileNamesUsing\n\t\n\t\t\n\n#udim bool used to judge weather to use udim\nudim = False\ndef UDIM_on(*argus):\n\tglobal udim\n\tudim = True\ndef UDIM_off(*argus):\n\tglobal udim\n\tudim = False\ndef UDIM_judge(fileNode):\n\tif udim:\n\t\tmc.setAttr(fileNode + '.uvTilingMode',3)\n\t\tmc.setAttr(fileNode + '.uvTileProxyQuality',4)\n\t\t\n\t\n#create a dict which containts all the textures that having the materialName\n#the keys of the dict are the texture's name\n#the values of the dict are the file nodes which ref to the texture \ndef createTexturesUsing(fileNamesUsing,userDefinedPath):\n\ttexturesUsing = {}\n\ttargetFileExist = False\n\tfor fileName in fileNamesUsing:\n\t\ttry:\n\t\t\ttempFile = mc.shadingNode('file',at = 1,icm = 1)\n\t\texcept:\n\t\t\ttempFile = mc.shadingNode('file',at = 1)\n\t\ttexturesUsing[fileName] = tempFile\n\t\tif userDefinedPath == '':\n\t\t\tmc.setAttr(tempFile + '.fileTextureName','sourceimages' + '\\\\' + fileName,type = 'string')\n\t\t\ttargetFileExist = True\n\t\telse:\n\t\t\tmc.setAttr(tempFile + '.fileTextureName',userDefinedPath + '\\\\' + fileName,type = 'string')\n\t\t\ttargetFileExist = True\n\tif not targetFileExist:\n\t\tmc.error('写错名字了吧小伙子，检查一下')\n\treturn texturesUsing\n\ndef createVrayShadingNetwork(materialName,texturesUsing):\n\t#get current version of maya\n\tversion = mc.about(version = 1)[:4]\n\tversion = int(version)\n\t#if the version is newer than 2016 ,we can use the colormanagement directly\n\tif version >= 2016:\n\t\t#create vray mtl\n\t\tvrayMtl = mc.shadingNode('VRayMtl',asShader = 1,n = materialName)\n\t\tmc.setAttr(vrayMtl + '.bumpMapType',1)\n\t\ttry:\n\t\t\tmc.setAttr(vrayMtl + '.brdfType' , 3)\n\t\texcept:\n\t\t\tmc.warning('当前版本vray没有ggx_brdf，效果可能不好，请注意')\n\n\t\t#create place2dtexture\n\t\tUVnode = mc.shadingNode('place2dTexture',au =1)\n\t\t#connect textures to material\n\t\tfor textureUsing in texturesUsing.keys():\n\t\t\t\n\t\t\tif 'Diffuse' in textureUsing:\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',vrayMtl + '.diffuseColor',f = 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','sRGB',type = 'string')\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Reflection' in textureUsing:\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',vrayMtl + '.reflectionColor',f = 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','sRGB',type = 'string')\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Roughness' in textureUsing:\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.invert',1)\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',vrayMtl + '.reflectionGlossiness',f = 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','sRGB',type = 'string')\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Glossiness' in textureUsing:\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',vrayMtl + '.reflectionGlossiness',f = 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','Raw',type = 'string')\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'ior' in textureUsing:\n\t\t\t\tmc.setAttr(vrayMtl + '.lockFresnelIORToRefractionIOR',0)\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',vrayMtl + '.fresnelIOR',f = 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','Raw',type = 'string')\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Normal' in textureUsing:\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',vrayMtl + '.bumpMap',f = 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','Raw',type = 'string')\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\t\n\telse:\n\t\t#create vray mtl\n\t\tvrayMtl = mc.shadingNode('VRayMtl',asShader = 1,n = materialName)\n\t\tmc.setAttr(vrayMtl + '.bumpMapType',1)\n\t\ttry:\n\t\t\tmc.setAttr(vrayMtl + '.brdfType' , 3)\n\t\texcept:\n\t\t\tmc.warning('当前版本vray没有ggx_brdf，效果可能不好，请注意')\n\t\t#create place2dtexture\n\t\tUVnode = mc.shadingNode('place2dTexture',au =1)\n\t\t#connect textures to material\n\t\tfor textureUsing in texturesUsing.keys():\n\t\t\tif 'Diffuse' in textureUsing:\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',vrayMtl + '.diffuseColor',f = 1)\n\t\t\t\tmc.vray(\"addAttributesFromGroup\", texturesUsing[textureUsing], \"vray_file_gamma\", 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.vrayFileColorSpace',2)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Reflection' in textureUsing: \n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',vrayMtl + '.reflectionColor',f = 1)\n\t\t\t\tmc.vray(\"addAttributesFromGroup\", texturesUsing[textureUsing], \"vray_file_gamma\", 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.vrayFileColorSpace',2)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Roughness' in textureUsing:\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.invert',1)\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',vrayMtl + '.reflectionGlossiness',f = 1)\n\t\t\t\tmc.vray(\"addAttributesFromGroup\", texturesUsing[textureUsing], \"vray_file_gamma\", 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.vrayFileColorSpace',0)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Glossiness' in textureUsing:\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',vrayMtl + '.reflectionGlossiness',f = 1)\n\t\t\t\tmc.vray(\"addAttributesFromGroup\", texturesUsing[textureUsing], \"vray_file_gamma\", 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.vrayFileColorSpace',0)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'ior' in textureUsing:\n\t\t\t\tmc.setAttr(vrayMtl + '.lockFresnelIORToRefractionIOR',0)\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',vrayMtl + '.fresnelIOR',f =1)\n\t\t\t\tmc.vray(\"addAttributesFromGroup\", texturesUsing[textureUsing], \"vray_file_gamma\", 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.vrayFileColorSpace',0)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\telif 'Normal' in textureUsing:\n\t\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',vrayMtl + '.bumpMap',f = 1)\n\t\t\t\tmc.vray(\"addAttributesFromGroup\", texturesUsing[textureUsing], \"vray_file_gamma\", 1)\n\t\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.vrayFileColorSpace',0)\n\t\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\ndef createArnoldShadingNetwork(materialName,texturesUsing):\n\t\n\t#create aistandard mtl\n\taiStandard = mc.shadingNode('aiStandard',asShader = 1,n = materialName)\n\tmc.setAttr(aiStandard + '.Kd',1)\n\tmc.setAttr(aiStandard + '.Ks',1)\n\ttry:\n\t\tmc.setAttr(aiStandard + '.specularDistribution' ,1 )\n\texcept:\n\t\tmc.warning('你使用的arnold版本没有ggx_brdf，效果可能不好')\n\t\n\t#create place2dtexture\n\tUVnode = mc.shadingNode('place2dTexture',au =1)\n\t\n\t#connect textures to material\n\tfor textureUsing in texturesUsing.keys():\n\t\tif 'Diffuse' in textureUsing:\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',aiStandard + '.color')\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'Specular' in textureUsing:\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',aiStandard + '.KsColor')\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'Roughness' in textureUsing:\n\t\t\tgammaCorret = mc.shadingNode('gammaCorrect',au = 1)\n\t\t\tmc.setAttr(gammaCorret + '.gammaX',2.2)\n\t\t\tmc.setAttr(gammaCorret + '.gammaY',2.2)\n\t\t\tmc.setAttr(gammaCorret + '.gammaZ',2.2)\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',gammaCorret + '.value')\n\t\t\tmc.connectAttr(gammaCorret + '.outValueX',aiStandard + '.specularRoughness')\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'f0' in textureUsing:\n\t\t\tmc.setAttr(aiStandard + '.specularFresnel',1)\n\t\t\tgammaCorret = mc.shadingNode('gammaCorrect',au = 1)\n\t\t\tmc.setAttr(gammaCorret + '.gammaX',2.2)\n\t\t\tmc.setAttr(gammaCorret + '.gammaY',2.2)\n\t\t\tmc.setAttr(gammaCorret + '.gammaZ',2.2)\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',gammaCorret + '.value')\n\t\t\tmc.connectAttr(gammaCorret + '.outValueX',aiStandard + '.Ksn')\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'Normal' in textureUsing:\n\t\t\tbumpNode = mc.shadingNode('bump2d',au = 1)\n\t\t\tmc.setAttr(bumpNode + '.bumpInterp', 1)\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',bumpNode + '.bumpValue')\n\t\t\tmc.connectAttr(bumpNode + '.outNormal',aiStandard + '.normalCamera')\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\t\t\ndef createRedshiftShadingNetwork(materialName,texturesUsing):\n    #create redshift mtl\n\trsMtl = mc.shadingNode('RedshiftMaterial',asShader = 1,n = materialName)\n\tmc.setAttr(rsMtl + '.refl_brdf',1)\n\t\n\t\n\t\n\t#create place2dtexture\n\tUVnode = mc.shadingNode('place2dTexture',au =1)\n\t\n\t#connect textures to material\n\tfor textureUsing in texturesUsing.keys():\n\t\tif 'Diffuse' in textureUsing:\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',rsMtl + '.diffuse_color',f = 1)\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'Reflection' in textureUsing:\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',rsMtl + '.refl_color')\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'Glossiness' in textureUsing:\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','Raw',type = 'string')\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.invert',1)\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outAlpha',rsMtl + '.refl_roughness')\n\t\t\t\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'f0' in textureUsing:\n\t\t\tmc.setAttr(rsMtl + '.refl_fresnel_mode',1)\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','Raw',type = 'string')\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',rsMtl + '.refl_reflectivity',f = 1)\n\t\t\t\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.alphaIsLuminance', 1)\n\t\t\tconnectUVNodeToTextureNode(UVnode,texturesUsing[textureUsing])\n\t\telif 'ior' in textureUsing:\n\t\t\tmc.setAttr(rsMtl + '.refl_fresnel_mode',3)\n\t\t\tmultiplyDivide = mc.shadingNode('multiplyDivide',au = 1)\n\t\t\tmc.setAttr(multiplyDivide + '.input1X',1)\n\t\t\tmc.setAttr(multiplyDivide + '.input1Y',1)\n\t\t\tmc.setAttr(multiplyDivide + '.input1Z',1)\n\t\t\tmc.setAttr(multiplyDivide + '.operation',2)\n\t\t\tmc.connectAttr(texturesUsing[textureUsing] + '.outColor',multiplyDivide + '.input2')\n\t\t\tmc.connectAttr(multiplyDivide + '.output.outputX',rsMtl + '.refl_ior')\n\t\t\tmc.setAttr(texturesUsing[textureUsing] + '.colorSpace','Raw',type = 'string')\n\t\t\t\t\t\n\t\telif 'Normal' in textureUsing:\n\t\t\tnormalNode = mc.shadingNode('RedshiftNormalMap',au = 1)\n\t\t\tif not udim:\n\t\t\t\tpath = mc.getAttr(texturesUsing[textureUsing] + '.fileTextureName')\n\t\t\telse:\n\t\t\t\tpath = mc.getAttr(texturesUsing[textureUsing] + '.fileTextureName')\n\t\t\t\tpath = path.partition('1001')[0] + '<udim>' + path.partition('1001')[2]\n\t\t\tmc.setAttr(normalNode + '.tex0',path,type = 'string')\n\t\t\tmc.connectAttr(normalNode + '.outDisplacementVector',rsMtl + '.bump_input')\n\t\t\t\n\n    \t\t\t\ndef changingRenderer(*argus):\n    global rendererUsing\n    rendererUsing = mc.optionMenuGrp('Renderer',q = 1 ,v = 1)\ndef openDirectory(*argus):\n\treturnDirectory = mc.fileDialog2(fm = 3,ff = None,ds = 1)\n\tif returnDirectory != None:\n\t\treturnDirectory = returnDirectory[0]\n\telse:\n\t\treturnDirectory = ''\n\n\tmc.textFieldGrp('texutresPath',e = 1, tx = returnDirectory)\t\ndef main(materialName):\n\t#get all file names in the sourceimages folder\n\tuserDefinedPath = mc.textFieldGrp(userDefinedPathTextField,q = 1, tx = 1)\n\ttargetFileNames = getFileNames(materialName,userDefinedPath)\n\ttextureNamesUsing =[]\n\tif udim:\n\t\tfor targetFileName01 in targetFileNames:\n\t\t\ttextureRepeated = False\n\t\t\tfor textureUsing in textureNamesUsing:\n\t\t\t\tif targetFileName01[:-9] == textureUsing[:-9]:\n\t\t\t\t\ttextureRepeated = True\n\t\t\t\t\tbreak\n\t\t\tif textureRepeated:\n\t\t\t\tcontinue\n\t\t\tfor targetFileName02 in targetFileNames:\n\t\t\t\tif (not targetFileName01 == targetFileName02) and (targetFileName01[:-9] == targetFileName02[:-9]):\n\t\t\t\t\t\n\t\t\t\t\ttextureNamesUsing.append(targetFileName01)\n\t\t\t\t\tbreak\n\t\t\t\t\t\n\t\tprint textureNamesUsing\n\telse:\n\t\ttextureNamesUsing = targetFileNames\t\t\t\n\n\t#get a dict contains all the textures will be used\n\ttexturesUsing = createTexturesUsing(textureNamesUsing,userDefinedPath)\n\t\t\n\t#judge every texture using, whether is a udim texture,if yes,change the settings\n\tfor textureUsing in texturesUsing.values():\n\t\tUDIM_judge(textureUsing)\n\t\t\n\tif rendererUsing == 'vray':\n\t\tcreateVrayShadingNetwork(materialName,texturesUsing)\n\telif rendererUsing == 'arnold':\n\t\tcreateArnoldShadingNetwork(materialName,texturesUsing)\n\telif rendererUsing == 'redshift':\n\t    createRedshiftShadingNetwork(materialName,texturesUsing)\n\telse:\n\t\tmc.error('请选择一个你要使用的渲染器,please choose a renderer')\n\n#the UI used to choose renderer\nrenderer = mc.optionMenuGrp('Renderer', l = 'Renderer',cc = changingRenderer)\nmc.menuItem('vray')\nmc.menuItem('arnold')\nmc.menuItem('redshift')\n\n\n\n\nmc.rowColumnLayout(co = (1,'left',141))\n\nmc.separator(h = 50) \nmc.separator(style = 'out') \nmc.checkBox(l = 'udim textures',onc = UDIM_on,ofc = UDIM_off,align = 'right')  \n\nmc.rowColumnLayout(p = mainRCL)\nuserDefinedPathTextField = mc.textFieldGrp('texutresPath',l = 'TexutresPath')\nmc.iconTextButton(style = 'iconOnly',image = 'xgBrowse.png', p = userDefinedPathTextField,c = openDirectory)\nmaterialNameInput = mc.textFieldButtonGrp(l = 'MaterialName',bl = 'excute',bc = 'main(mc.textFieldButtonGrp(materialNameInput,q = 1,text =1 ))')\nmc.separator(style = 'none',h = 20)\nmc.separator()\nmc.text(l = 'sp2m v1.03d',w =230,al = 'right',hyperlink = 1,ww = 1,ann = 'the version of the script')" 
        -sourceType "python" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "deleteUI unifiedRenderGlobalsWindow; \n\n buildNewSceneUI;  " 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "deleteUI unifiedRenderGlobalsWindow; \n\n buildNewSceneUI;  " 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "Rwin" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "deleteUI unifiedRenderGlobalsWindow; \n\n buildNewSceneUI;  " 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "import pymel.core as pm\n\ndef RemoveNamespace():\n    nameSpaces = pm.namespaceInfo(lon = True)\n    \n    for name in ['UI', 'shared']:\n        nameSpaces.remove(name) \n    \n    while nameSpaces:\n        for names in nameSpaces:\n            removeNamespace = pm.namespace(mergeNamespaceWithRoot = True, removeNamespace = names)\n        pm.namespace(setNamespace = \":\")\n        nameSpaces = pm.namespaceInfo(lon = True)\n        for name in ['UI', 'shared']:\n            nameSpaces.remove(name) \n" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "import pymel.core as pm\n\ndef RemoveNamespace():\n    nameSpaces =..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "DelName" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "pythonFamily.png" 
        -image1 "pythonFamily.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "import pymel.core as pm\n\ndef RemoveNamespace():\n    nameSpaces = pm.namespaceInfo(lon = True)\n    \n    for name in ['UI', 'shared']:\n        nameSpaces.remove(name) \n    \n    while nameSpaces:\n        for names in nameSpaces:\n            removeNamespace = pm.namespace(mergeNamespaceWithRoot = True, removeNamespace = names)\n        pm.namespace(setNamespace = \":\")\n        nameSpaces = pm.namespaceInfo(lon = True)\n        for name in ['UI', 'shared']:\n            nameSpaces.remove(name) \nRemoveNamespace()" 
        -sourceType "python" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "global proc sel_curve_for_hair(){\npickWalk -d down -type edgering;\nstring $aaa[]=`ls -sl -fl`;\nselect -cl;\nstring $all[];\nfor ($a=0;$a<size($aaa);$a++)\n\n{\n    select -r $aaa[$a];\n    pickWalk -d right -type edgeloop;\n    \n    CreateCurveFromPoly;\n    string $t[]=`ls -sl`;\n    $all[size($all)]=$t[0];\n}\n\nselect -r $all;\nclear $all;\n}\nif(`window -ex FY_tool_6`) deleteUI FY_tool_6; \n\n\nwindow -title \"大肥羊牌贴心小工具\" -sizeable 0 -tlb 0 FY_tool_6;\nrowColumnLayout -numberOfColumns 1  ;\ntext -l \"\";\ntext -l \"\";\ntext -fn \"boldLabelFont\" -l \"         奥义之提取毛发曲线大法 - 先选择模型的一根边线         \";\n\ntext -l \"\";\n\ntext -l \"\";\nbutton -l \"执行\" -c \"sel_curve_for_hair()\";\ntext -l \"\";\ntext -l \"\";\nsetParent ..;   \nshowWindow FY_tool_6;" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "global proc sel_curve_for_hair(){\npickWalk -d down -type edgerin..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "提取线" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "global proc sel_curve_for_hair(){\npickWalk -d down -type edgering;\nstring $aaa[]=`ls -sl -fl`;\nselect -cl;\nstring $all[];\nfor ($a=0;$a<size($aaa);$a++)\n\n{\n    select -r $aaa[$a];\n    pickWalk -d right -type edgeloop;\n    \n    CreateCurveFromPoly;\n    string $t[]=`ls -sl`;\n    $all[size($all)]=$t[0];\n}\n\nselect -r $all;\nclear $all;\n}\nif(`window -ex FY_tool_6`) deleteUI FY_tool_6; \n\n\nwindow -title \"大肥羊牌贴心小工具\" -sizeable 0 -tlb 0 FY_tool_6;\nrowColumnLayout -numberOfColumns 1  ;\ntext -l \"\";\ntext -l \"\";\ntext -fn \"boldLabelFont\" -l \"         奥义之提取毛发曲线大法 - 先选择模型的一根边线         \";\n\ntext -l \"\";\n\ntext -l \"\";\nbutton -l \"执行\" -c \"sel_curve_for_hair()\";\ntext -l \"\";\ntext -l \"\";\nsetParent ..;   \nshowWindow FY_tool_6;" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "改名字" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "\tif (`window -ex BRreNameWin`)\n\n\tdeleteUI  BRreNameWin;\n\twindow ..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "改名字" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "\tif (`window -ex BRreNameWin`)\n\n\tdeleteUI  BRreNameWin;\n\twindow -title \"Batch Renaming Window\"\n    \t-wh 500 300  -mxb 0  BRreNameWin;    \t\t\n  formLayout renOptionFom;\n\tframeLayout -l \"改名操作\" -labelAlign \"center\"\n\t\t\t-borderStyle \"etchedIn\" renOptionFrm;\n\tcolumnLayout renOptionLay;\n\tradioButtonGrp -numberOfRadioButtons 3\n    \t  -label \"改名类型\"\n\t\t\t-labelArray3 \"加前缀\" \"加后缀\" \"替换字符\"\n\t\t\t-sl 1 renType;\n\tradioButtonGrp -numberOfRadioButtons 2 -shareCollection renType\n\t\t\t-label \"\"\n\t\t\t-labelArray2  \"取新名\" \"\" renType2;\n\n\tradioButtonGrp\n     \t-numberOfRadioButtons 2\n     \t-label \"操作范围\"\n\t    -labelArray2 \"被选物体\" \"包括子物体\" \n\t\t\t-sl 1 renRange;\n\tsetParent..;\n\tsetParent..;\n\tframeLayout -l \"替换字符\" -labelAlign \"center\"\n\t\t\t-borderStyle \"etchedIn\" repNameFrm;\n\t \t\t\n\tcolumnLayout -adjustableColumn true  repNameLay;\n\ttextFieldGrp \n\t\t\t-label \"旧文字\" -en 0\t\n\t\t\t-text \"old\" oldstring;\n\n\ttextFieldGrp\n\t\t\t-label \"新字符\" -en 0 \n\t\t\t-text \"new\" newstring;\n\tsetParent..;\n\tsetParent..;\n\n\tframeLayout -l \"新名称\" -labelAlign \"center\"\n\t\t\t-borderStyle \"etchedIn\" newNameFrm;\n\n\tcolumnLayout -adjustableColumn true newNameLay;\n\ttextFieldGrp \n\t\t\t-label \"前缀\" -en 1\n\t\t\t-text \"Prefix_\" preString ;\n\ttextFieldGrp \n\t\t\t-label \"后缀\" -en 0\n\t\t\t-text \"_Postfix\" postString ;\n\ttextFieldGrp \n\t\t\t-label \"物体名\" -en 0\n\t\t\t-text \"Obj_\" objString ;\n\tsetParent..;\n\tsetParent..;\n\n\tbutton -l \"Replace\" \n\t\t\t-annotation \"Rename Objects Operation\"\n\t\t\t-c \"gxb_BRrenameTool_Main;deleteUI  BRreNameWin;\" okBtn;\n\tbutton -l \"Apply\" \n\t\t\t-annotation \"Rename Objects Operation\"\n\t\t\t-c \"gxb_BRrenameTool_Main;\" optBtn;\n\tbutton -l \"Close\"\n\t\t\t-annotation \"Close Curren Windows\"\n\t\t\t-c \"deleteUI  BRreNameWin;\" closeBtn;\t\n\tsetParent..;\n\n\tstring $cmdOnOldStr = \"textFieldGrp -e -en 1 oldstring;\";\n\tstring $cmdOffOldStr = \"textFieldGrp -e -en 0 oldstring;\";\n\n\tstring $cmdOnNewStr = \"textFieldGrp -e -en 1 newstring;\";\n\tstring $cmdOffNewStr = \"textFieldGrp -e -en 0 newstring;\";\n\n\tstring $cmdOnObjStr = \"textFieldGrp -e -en 1 objString;\";\n\tstring $cmdOffObjStr = \"textFieldGrp -e -en 0 objString;\";\n\n\tstring $cmdOnPreStr = \"textFieldGrp -e -en 1 preString;\";\n\tstring $cmdOffPreStr = \"textFieldGrp -e -en 0 preString;\";\n\n\tstring $cmdOnPosStr = \"textFieldGrp -e -en 1 postString;\";\n\tstring $cmdOffPosStr = \"textFieldGrp -e -en 0 postString;\";\n\n\n\n\tradioButtonGrp -e -on1 ($cmdOnPreStr + $cmdOffOldStr + $cmdOffNewStr + $cmdOffObjStr + $cmdOffPosStr)\n\t\t\t-on2 ($cmdOffPreStr + $cmdOffOldStr + $cmdOffNewStr + $cmdOffObjStr + $cmdOnPosStr)\n\t\t\t-on3 ($cmdOffPreStr + $cmdOnOldStr + $cmdOnNewStr + $cmdOffObjStr + $cmdOffPosStr)\n\t\t\trenType;\n\tradioButtonGrp -e\n\t\t\t-on1 ($cmdOffPreStr + $cmdOffOldStr + $cmdOffNewStr + $cmdOnObjStr + $cmdOffPosStr)\n\t\t\t-on2 ($cmdOffPreStr + $cmdOffOldStr + $cmdOffNewStr + $cmdOffObjStr + $cmdOffPosStr)\n\t\t\trenType2;\n\n\tformLayout -e\t\n\t\t-af okBtn left 5\n\t\t-af okBtn bottom 5 \n\t\t-ap okBtn right 0 30 \n\n\t\t-ac optBtn left 5 okBtn\n\t\t-af optBtn bottom 5 \n\t\t-ap optBtn right 0 65 \n\n\t\t-ac closeBtn left 5 optBtn\n\t\t-af closeBtn bottom 5\n\t\t-af closeBtn right 5\n\n\t\t-af renOptionFrm top 5\n\t\t-af renOptionFrm left 5\n\t\t-af renOptionFrm right 5 \n\n\t\t-ac repNameFrm top 5 renOptionFrm\n\t\t-af repNameFrm left 5\n\t\t-af repNameFrm right 5 \n\n\t\t-ac newNameFrm top 5 repNameFrm\n\t\t-af newNameFrm left 5\n\t\t-af newNameFrm right 5 \n\t\trenOptionFom;\n\nshowWindow BRreNameWin;\n\n\n\nproc BRaddPrefix(string $seled[],string $prefix)\n{\n\tfor($i=0;$i<`size $seled`;$i++)\n\t{\n\t\tstring $namepiece[];\n\t\tint $j = (`size $seled`)-$i-1;\n\t\tint  $tok = `tokenize $seled[$j] \"|\"  $namepiece`;\n\n\t\tstring $name_temp = $prefix + $namepiece[$tok-1] ;\n\t\trename $seled[$j] $name_temp;\n\t}\n}\n\nproc BRaddPostfix(string $seled[],string $postfix)\n{\n\tfor($i=0;$i<`size $seled`;$i++)\n\t{\n\t\tstring $namepiece[];\n\t\tint $j = (`size $seled`)-$i-1;\n\t\tint  $tok = `tokenize $seled[$j] \"|\"  $namepiece`;\n\n\t\tstring $name_temp = $namepiece[$tok-1] + $postfix ;\n\t\trename $seled[$j] $name_temp;\n\t}\n}\n\nproc BRrepLetter(string $seled[],string $oldLetter,string $newLetter)\n{\n\tfor($i=0;$i<`size $seled`;$i++)\n\t{\n\t\tstring $namepiece[];\n\t\tint $j = (`size $seled`)-$i-1;\n\t\tint  $tok = `tokenize $seled[$j] \"|\"  $namepiece`;\n\n\t\tstring $name_temp = `substitute $oldLetter $namepiece[$tok-1] $newLetter`;\n\t\trename $seled[$j] $name_temp;\n\t}\n}\n\nproc BRrenShap(string $seled[])\n{\n\tint $j = size ($seled);\n\tstring $namepiece[];\n\n\tfor ($i=0;$i<$j;$i++)\n\t{\n\tselect -r $seled[$i];\n\tstring $shapes[] = `ls -dag -leaf -sl`;\n\tint $num = `tokenize $seled[$i] \"|\" $namepiece` -1;\n\n\tif(size($shapes) == 1)\n\t\t{\n\tstring $shapName = $namepiece[$num] + \"Shape\" ;\n\trename $shapes[0]   $shapName;\n\t\t}\n\telse\n\t\t{\n\t\t\nfor($ii=0;$ii<size($shapes);$ii++)\n\t\t\t{\n\tstring $temp = $ii+1;\n\tstring $shapName = $namepiece[$num] + \"Shape\" + $temp;\n\trename $shapes[$ii]   $shapName;\n\t\t\t}\n\t\t}\n\t}\n}\n\nproc BRnewName(string $seled[],string $newName)\n{\n\tint $j = size ($seled);\n\t\nfor($i=0;$i<`size $seled`;$i++)\n\t{\n\tint $j = (`size $seled`)-$i-1;\n\tstring $name_temp = $newName + $j;\n\t\trename $seled[$j] $name_temp;\n\t}\n}\n\nglobal proc gxb_BRrenameTool_Main()\n{\n\tstring $tmp[],$tmp1[],$sel_list[],$shap[];\n\n\tint $renType = `radioButtonGrp -q -sl renType` \n\t\t+ sign(float(`radioButtonGrp -q -sl renType2`))*3.0\n\t\t+ `radioButtonGrp -q -sl renType2`;\n\tint $renRang = `radioButtonGrp -q -sl renRange`;\n\n\tstring $oldName = `textFieldGrp -q -text oldstring`;\n\tstring $newName = `textFieldGrp -q -text newstring`;\n\tstring $prefix\t= `textFieldGrp -q -text preString`;\n\tstring $postfix = `textFieldGrp -q -text postString`;\n\tstring $objName = `textFieldGrp -q -text objString`;\n\n\tif($renRang == 1)\n\t{\n\t\t$tmp1 = `ls -l -sl`;\n\t\t$shap = `ls -s -l -sl`;\n\t}\n\telse\n\t{\n\t\t$tmp1 = `ls -sl`;\n\tselect -hi $tmp1;\n\t\t$tmp1 = `ls -l -sl`;\n\t}\n\t$shap = `ls -s -l -sl`;\n\t$tmp = stringArrayRemove($shap, $tmp1);\n\n\tfor($i=0;$i<`size $tmp`;$i++)\n\t{\n\tif($i<(`size $tmp`)-1)\n\t\t{\n\tint $j = $i+1;\n\t\t\t$sel_list[$j] = $tmp[$i];\n\tfor($jj = $j;$jj>0;$jj--)\n\t\t\t{\n\tstring $buffer[];\n\tif (`tokenize $sel_list[$jj] \"|\" $buffer` < `tokenize $sel_list[$jj-1] \"|\" $buffer`)\n\t\t\t\t{\n\tstring $temp = $sel_list[$jj-1];\n\t\t\t\t\t$sel_list[$jj-1] = $sel_list[$jj];\n\t\t\t\t\t$sel_list[$jj] = $temp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\telse\n\t\t{\n\t\t\t$sel_list[0] = $tmp[ $i];\n\t\t}\n\t}\n\n\tfor($i=0;$i<`size $tmp`;$i++)\n\t{\n\t\t\t$sel_list[$i] = $tmp[$i];\n\t}\n\n\tswitch ($renType)\n\t{\n\t    case 1:\n\t\tBRaddPrefix($sel_list,$prefix);\n\t\tbreak;\n\t    case 2:\n\t\tBRaddPostfix($sel_list, $postfix);\n\t        break;\n\t    case 3:\n\t\tBRrepLetter($sel_list,$oldName,$newName);\n\t        break;\n\t    case 4:\n\t\tBRnewName($sel_list,$objName);\n\t        break;\n\t    case 5:\n\t\tBRrenShap($sel_list);\n\t        break;\n\t}\n}\n" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "global proc ap_RenameObjs ()\n\n{\n\tstring $win = \"ap_RenameObjs_Win\";\n\n\tif (`window -ex $win`) {\n\t\tdeleteUI $win;\n\t\twindowPref -remove $win;\n\t}\n\n\tap_RenameObjs_Ui $win;\n\tshowWindow $win;\n}\n\n// global proc selectBelow() {\n// \tprint (`listRelatives -ad -type \"transform\"`);\n// }\n\nglobal proc chiAddSuffix() {\n\n\tstring $sel[] = `ls -sl`;\n\tstring $s = \"\";\n\t\n\tstring $suffixStr = `textField -q -tx ap_RenameObjs_Fld_Txt_3`;\n\n\tfor ($s in $sel) {\n\t\trename $s ($s + $suffixStr);\n\t}\n}\n\n//Layout the ui\nglobal proc ap_RenameObjs_Ui (string $win)\n\n{\n\tstring $ro = \"ap_RenameObjs_\";\n\n\twindow -t \"改名工具包（整理）\" -mb 1 -tlb 1 -mnb 1 -s 1 $win;\n\t\n\t//Create menu items\n/*\n\tmenu -p $win -to 1 -l \"Settings\";\n\tmenuItem -c \"ap_RenameObjs_ap_RenameObjs_Browse prefix\" -l \"Prefix File\";\n\tmenuItem -c \"ap_RenameObjs_ap_RenameObjs_Browse suffix\" -l \"Suffix File\";\n*/\n\t// menu -p $win -to 1 -l \"Extra\";\n\t// menuItem -c \"ap_Capitalize; ap_RenameObjs_Update_Tsl ap_RenameObjs_Tsl_1;\" -l \"Capitalize Name\";\n\t// menuItem -c \"select -hi\" -l \"Select -hi\";\n\t// menuItem -c \"print (size(`ls -sl`) + \\\" Objects Selected.\\\")\" -l \"Print no of objects selected\";\n\n  \tstring $form_1 = `formLayout -p $win ($ro + \"Form_1\")`;\n\n\tstring $col_1 = `columnLayout -p $form_1 -adj 1 ($ro + \"Col_1\")`;\n\n// \tbutton -l \"Select below\" -c \"selectBelow()\";\n\tbutton -l \"lun make unique => Create Set\" -c \"makeObjsUnique(1)\";\n\tbutton -l \"lun make unique => Rename\" -c \"makeObjsUnique(0)\";\n\tbutton -l \"select all transforms below\" -c \"select -hi;string $f = `itemFilter -byType transform`;select -r `lsThroughFilter -sl $f`;\";\n\tbutton -l \"Run Suffix (without changing #)\" -c \"chiAddSuffix;ap_RenameObjs_Update_Tsl ap_RenameObjs_Tsl_1;\";\n\t\n\tseparator -h 10;\n\t\n\tstring $frm_1 = `frameLayout -p $col_1 -cl 0 -cll 1 -bv 0 -mh 5 -fn \"plainLabelFont\" -li 5 -l \"Rename:\" ($ro + \"Frm_1\")`;\n\t\n\tstring $col_2 = `columnLayout -p $frm_1 -adj 1 ($ro + \"Col_2\")`;\n\n \tstring $row_1 = `rowLayout -p $col_2 -nc 3 -cw3 55 300 55 -adj 2 -cat 1 \"right\" 5 -cat 2 \"both\" 0 -cat 3 \"left\" 5 ($ro + \"Row_1\")`;\n\n\ttext -l \"Prefix\";\n\tstring $txtFld_1 = `textField -cc \"setFocus ap_RenameObjs_But_1\" ($ro + \"Fld_Txt_1\")`;\n\tbutton -c \"ap_RenameObjs_Rename 1\" -l \"Run\" ($ro + \"But_1\");\n\t\n\tstring $pop_1 = `popupMenu -p $txtFld_1 ($ro + \"Pop_1\")`;\n\tpopupMenu -e -pmc (\"ap_RenameObjs_Update_Popup \\\"\" + $pop_1 + \"\\\" \\\"prefix\\\" \\\"\" + $txtFld_1 + \"\\\"\") $pop_1;\n\t\n \tstring $row_2 = `rowLayout -p $col_2 -nc 3 -cw3 55 300 55 -adj 2 -cat 1 \"right\" 5 -cat 2 \"both\" 0 -cat 3 \"left\" 5 ($ro + \"Row_2\")`;\n\n\ttext -l \"Name\";\n\tstring $txtFld_2 = `textField -cc \"setFocus ap_RenameObjs_But_2\" ($ro + \"Fld_Txt_2\")`;\n\tbutton -c \"ap_RenameObjs_Rename 2\" -l \"Run\" ($ro + \"But_2\");\n\n\tstring $row_3 = `rowLayout -p $col_2 -nc 3 -cw3 55 300 55 -adj 2 -cat 1 \"right\" 5 -cat 2 \"both\" 0 -cat 2 \"both\" 0 -cat 3 \"left\" 5 ($ro + \"Row_3\")`;\n\n\ttext -l \"Suffix\";\n\tstring $txtFld_3 = `textField -cc \"setFocus ap_RenameObjs_But_3\" ($ro + \"Fld_Txt_3\")`;\n\tbutton -c \"ap_RenameObjs_Rename 3\" -l \"Run\" ($ro + \"But_3\");\n\n\tstring $pop_2 = `popupMenu -p $txtFld_3 ($ro + \"Pop_2\")`;\n\tpopupMenu -e -pmc (\"ap_RenameObjs_Update_Popup \\\"\" + $pop_2 + \"\\\" \\\"suffix\\\" \\\"\" + $txtFld_3 + \"\\\"\") $pop_2;\n\n\tstring $frm_2 = `frameLayout -p $col_1 -cl 0 -cll 1 -bv 0 -mh 5 -fn \"plainLabelFont\" -li 5 -l \"Replace: [ namespace works too ! ]\" ($ro + \"Frm_2\")`;\n\n\tstring $col_3 = `columnLayout -p $frm_2 -adj 1 ($ro + \"Col_3\")`;\n\tstring $row_4 = `rowLayout -p $col_3 -nc 2 -cw2 55 355 -adj 2 -cat 1 \"right\" 5 -cat 2 \"right\" 20 ($ro + \"Row_4\")`;\n\t\n\ttext -l \"Replace\";\n\tstring $txtFld_4 = `textField ($ro + \"Fld_Txt_4\")`;\n\n\tstring $row_5 = `rowLayout -p $col_3 -nc 2 -cw2 55 355 -adj 2 -cat 1 \"right\" 5 -cat 2 \"right\" 20 ($ro + \"Row_5\")`;\n\n\ttext -l \"With\";\n\tstring $txtFld_5 = `textField ($ro + \"Fld_Txt_5\")`;\n\n\tstring $row_6 = `rowLayout -p $col_3 -nc 2 -cw2 55 355 -adj 2 -cat 1 \"right\" 5 -cal 2 \"center\" -cat 2 \"right\" 20 ($ro + \"Row_6\")`;\n\n\ttext -l \"\";\n\tstring $but_4 = `button -c \"ap_RenameObjs_Rename 4\" -l \"Replace\" ($ro + \"But_4\")`;\n\n\tstring $frm_3 = `frameLayout -p $col_1 -cl 0 -cll 1 -bv 0 -mh 5 -fn \"plainLabelFont\" -li 5 -l \"Append Number:\" ($ro + \"Frm_3\")`;\n\tstring $col_4 = `columnLayout -p $frm_3 -adj 1 ($ro + \"Col_3\")`;\n\t\n\tstring $row_7 = `rowLayout -p $col_4 -nc 2 -cw2 55 355 -adj 2 -cat 1 \"right\" 5 -cat 2 \"right\" 20 ($ro + \"Row_7\")`;\n\n\ttext -l \"Start\";\n\tstring $intFld_1 = `intField -min 0 -v 1 ($ro + \"IntFld_1\")`;\n\n\tstring $row_8 = `rowLayout -p $col_4 -nc 2 -cw2 55 355 -adj 2 -cat 1 \"right\" 5 -cat 2 \"right\" 20 ($ro + \"Row_8\")`;\n\t\n\ttext -l \"Increment\";\n\tstring $intFld_2 = `intField -min 1 -v 1 ($ro + \"IntFld_2\")`;\n\n\tstring $row_9 = `rowLayout -p $col_4 -nc 2 -cw2 55 355 -adj 2 -cat 1 \"right\" 5 -cat 2 \"right\" 20 ($ro + \"Row_9\")`;\n\t\n\ttext -l \"Padding\";\n\tstring $intFld_3 = `intField -min 1 -v 1 ($ro + \"IntFld_3\")`;\n\n\tstring $row_10 = `rowLayout -p $col_4 -nc 2 -cw2 55 355 -adj 2 -cat 1 \"right\" 5 -cat 2 \"right\" 20 ($ro + \"Row_10\")`;\n\n\ttext -l \"\";\n\tstring $but_6 = `button -c \"ap_RenameObjs_Rename 5\" -l \"              Apply Number\" ($ro + \"But_6\")`;\n\n\tstring $frm_4 = `frameLayout -p $form_1 -cl 0 -cll 1 -bv 0 -mh 5 -fn \"plainLabelFont\" -li 5 -l \"Selected Objects:\" ($ro + \"Frm_4\")`;\n\n \tstring $tsl_1 = `textScrollList -p $frm_4 ($ro + \"Tsl_1\")`;\n\n\tframeLayout -e -ec \"ap_RenameObjs_Cll_Tsl ap_RenameObjs_Win ap_RenameObjs_Tsl_1\" $frm_4;\n\tframeLayout -e -cc \"ap_RenameObjs_Cll_Tsl ap_RenameObjs_Win ap_RenameObjs_Tsl_1\" $frm_4;\n\n \tformLayout -e\n\n    \t\t-attachForm $col_1 \"top\" 5\n    \t\t-attachForm $col_1 \"left\" 5\n    \t\t-attachForm $col_1 \"right\" 5\n    \t\t-attachNone $col_1 \"bottom\"\n   \n    \t\t-attachControl $frm_4 \"top\" 0 $col_1\n    \t\t-attachForm $frm_4 \"left\" 5\n    \t\t-attachForm $frm_4 \"right\" 5\n    \t\t-attachForm $frm_4 \"bottom\" 0\n  \t$form_1;\n\n\twindow -e -wh 250 550 -s 1 $win;\n\n\tap_RenameObjs_Update_Tsl $tsl_1;\n\t\t\n\tscriptJob -p $tsl_1 -e SelectionChanged (\"ap_RenameObjs_Update_Tsl \\\"\" + $tsl_1 + \"\\\"\");\n}\n\n//Collapse the object list\n\nglobal proc ap_RenameObjs_Cll_Tsl (string $win, string $tsl_1)\n\n{\n\tstring $frm_4 = \"ap_RenameObjs_Frm_4\";\n\n\tif (`frameLayout -q -cl $frm_4` == 1)\n\n\t{\n\t\t\n\t\tdeleteUI $tsl_1;\n\t}\n\n\telse\n\n\t{\n \t\t$tsl_1 = `textScrollList -p $frm_4 $tsl_1`;\n\t\tscriptJob -p $tsl_1 -e SelectionChanged (\"ap_RenameObjs_Update_Tsl \\\"\" + $tsl_1 + \"\\\"\");\n\n\t\tap_RenameObjs_Update_Tsl $tsl_1;\n\t}\n}\n\nglobal proc ap_RenameObjs_Update_Tsl (string $tsl_1)\n\t\n{\n\tstring $objs[];\n\t\n\tif (`textScrollList -exists $tsl_1`)\n\n\t{\n\t\ttextScrollList -e -ra $tsl_1;\n\n\t\t$objs = `ls -l -sl`;\n\n\t\tif (`size $objs` != 0)\n\t\n\t\t{\n\t\t\tfor ($obj in $objs)\n\t\n\t\t\t{\t\n\t\t\t\tstring $sn = `match \"[^|]*$\" $obj`;\n\t\t\t\ttextScrollList -e -a $sn $tsl_1;\n\t\t\t}\n\t\t}\n\t}\n}\n\nglobal proc ap_RenameObjs_Update_Popup (string $pop, string $type, string $field)\n\n{\n\tint $p = 0;\n\tstring $items[], $itemName, $filePath;\n\n\tpopupMenu -e -dai $pop;\n\n\tif ($type == \"prefix\") $filePath = `optionVar -q \"prefix\"`;\n\telse if ($type == \"suffix\") $filePath = `optionVar -q \"suffix\"`;\n\n\tif ($filePath != 0)\n\n\t{\n\t\tif (`filetest -r $filePath`) $items = `ap_ReadFile $filePath`;\n\t\telse menuItem -p $pop -en 0 -l \"No file set\" ($pop + \"_Item_\" + $p);\n\t}\n\n\telse menuItem -p $pop -en 0 -l \"No file set\" ($pop + \"_Item_\" + $p);\n\n\t$items = `ap_RemoveDuplicates $items`;\n\t$items = `sort $items`;\n\n\tfor ($i in $items)\n\n\t{\n\t\tif ($i != \"\")\n\n\t\t{\n\t\t\t$itemName = `menuItem -p $pop -l $i ($pop + \"_Item_\" + $p)`;\n\t\t\tmenuItem -e -c (\"eval (\\\"textField -e -tx `menuItem -q -l \\\\\\\"\" + $itemName + \"\\\\\\\"` \\\\\\\"\" + $field + \"\\\\\\\"\\\")\") $itemName;\n\t\t\t$p++;\n\t\t}\n\t}\n\n\tif (`popupMenu -q -ni $pop` == 0) menuItem -p $pop -en 0 -l \"None\" ($pop + \"_Item_\" + $p);\n}\n\nglobal proc ap_RenameObjs_ap_RenameObjs_Browse (string $fileType)\n\n{\n\tstring $filePath, $items[];\n\n\tif ($fileType == \"prefix\")\n\n\t{\n\t\t$filePath = `ap_RenameObjs_Browse \".px\"`;\n\n\t\tif ($filePath != \"\")\n\n\t\t{\n\t\t\tif (`optionVar -ex $fileType`) optionVar -rm $fileType;\n\t\n\t\t\toptionVar -sv $fileType $filePath;\n\t\t\n\t\t\tap_RenameObjs_Update_Popup \"ap_RenameObjs_Pop_1\" \"prefix\" \"ap_RenameObjs_Txt_Fld_1\";\n\t\t}\n\t}\n\n\telse if ($fileType == \"suffix\")\n\n\t{\n\t\t$filePath = `ap_RenameObjs_Browse \".sx\"`;\n\n\t\tif ($filePath != \"\")\n\n\t\t{\n\t\t\tif (`optionVar -ex $fileType`) optionVar -rm $fileType;\n\t\n\t\t\toptionVar -sv $fileType $filePath;\n\t\n\t\t\tap_RenameObjs_Update_Popup \"ap_RenameObjs_Pop_2\" \"prefix\" \"ap_RenameObjs_Txt_Fld_3\";\n\t\t}\n\t}\n}\n\nglobal proc ap_RenameObjs_Rename (int $mode)\n\n{\n\t//Retrieve user input\n\n\tstring $p = `textField -q -tx ap_RenameObjs_Fld_Txt_1`;\n\tstring $n = `textField -q -tx ap_RenameObjs_Fld_Txt_2`;\n\tstring $s = `textField -q -tx ap_RenameObjs_Fld_Txt_3`;\n\n\tstring $r = `textField -q -tx ap_RenameObjs_Fld_Txt_4`;\n\tstring $w = `textField -q -tx ap_RenameObjs_Fld_Txt_5`;\t\n\n\t//List objects\n\n\tstring $objs[] = `ls -l -sl`;\n\t\n\t//Sort the list of objects into hierarchial order\n\n\tstring $sorted[] = `ap_SortHierarchy $objs`;\n\n\t//Reverse the list so the lowest children are first in the list\n\n\tstring $reversed[] = `ap_ReverseArray $sorted`;\n\n\t//if (`match \"[0-9]*$\" $name` != \"\") $name += \"_\";\n\n\tfor ($obj in $reversed)\n\n\t{\n\t\tswitch ($mode)\n\n\t\t{\n\t\t\tcase 1:\n\t\t\tstring $sn = `match \"[^|]*$\" $obj`;\n\t\t\t$renameCommand = (\"rename \" + $obj + \" \" + ($p + $sn));\n\t\t\tbreak;\n\n\t\t\tcase 2:\n\t\t\t$renameCommand = (\"rename \" + $obj + \" \" + $n);\n\t\t\tbreak;\n\n\t\t\tcase 3:\n\t\t\tstring $sn = `match \"[^|]*$\" $obj`;\n\t\t\t$sn = `match \".*[^_0-9]\" $sn`;\n\t\t\t$renameCommand = (\"rename \" + $obj + \" \" + ($sn + $s));\n\t\t\tbreak;\n\n\t\t\tcase 4:\n\t\t\tstring $sn = `match \"[^|]*$\" $obj`;\t\n\n\t\t\tif ($r == \"\") error \"\";\n\t\t\t//if ($w == \"\") error \"\";\t\t\n\n\t\t\t$sn = `substitute $r $sn $w`;\n\t\t\t$renameCommand = (\"rename \" + $obj + \" \" + $sn);\n\t\t\tbreak;\n\n\t\t\tcase 5:\n\t\t\tstring $sn = `match \"[^|]*$\" $obj`;\n\t\t\t$sn = `match \".*[^_0-9]\" $sn`;\n\t\t\tstring $numbers[] = `ap_RenameObjs_Number $objs`;\n\n\t\t\tfor ($o = 0; $o < `size $objs`; $o++)\n\n\t\t\t{\n\t\t\t\tif ($objs[$o] == $obj)\n\n\t\t\t\t{\n\t\t\t\t\t$renameCommand = (\"rename \" + $obj + \" \" + ($sn + \"_\" + $numbers[$o]));\n\t\t\t\t\tbreak;\t\t\t\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbreak;\n\t\t}\n\n\t\t//If the rename command generates errors, catch them and continue\t\t\n\n\t\tif (catch (`eval $renameCommand`)) print \"\";\n\t}\n\n\tap_RenameObjs_Update_Tsl ap_RenameObjs_Tsl_1;\n}\n\n\n\nglobal proc string[] ap_RenameObjs_Number (string $objs[])\n\n{\n\tstring $numbers[];\n\tstring $numString;\n\tstring $zeros = \"\";\n\n\tint $numZeros;\n\n\t//Load the values of the intField boxes into variables\n\t\n\tint $start = `intField -q -v ap_RenameObjs_IntFld_1`;\n\tint $inc = `intField -q -v ap_RenameObjs_IntFld_2`;\n\tint $pad = `intField -q -v ap_RenameObjs_IntFld_3`;\n\n\tint $current = $start;\n\n\tif ($pad == 1)\n\n\t{\n\t\tfor ($obj in $objs)\n\n\t\t{\n\t\t\t$numbers[`size $numbers`] = $current;\n\t\t\t$current = $current + $inc;\n\t\t}\n\t}\n\t\n\tif ($pad > 1)\n\n\t{\n\t\tfor ($obj in $objs)\n\n\t\t{\n\t\t\t$numString = $current;\n\n\t\t\tif (`size $numString` < $pad)\n\n\t\t\t{\t\n\t\t\t\t$numZeros = $pad - (`size $numString`);\n\t\t\t\t\t\t\n\t\t\t\tfor ($n = $numZeros; $n > 0; $n--)\n\n\t\t\t\t{\n\t\t\t\t\t$zeros = $zeros + \"0\";\n\t\t\t\t}\n\n\t\t\t\t$numString = $zeros + $numString;\n\t\t\t\t$numbers[`size $numbers`] = $numString;\n\t\t\t}\n\n\t\t\telse $numbers[`size $numbers`] = $current;\n\n\t\t\t$current = $current + $inc;\t\n\t\t\t$zeros = \"\";\n\t\t}\n\t}\n\n\treturn $numbers;\n}\n\nglobal proc string ap_RenameObjs_Browse (string $fileExt)\n\n{\n\tstring $dir, $filePath, $path;\n\n\tswitch ($fileExt)\n\n\t{\n\t\tcase \".px\":\n\n\t\t\t$path = `optionVar -q \"prefix\"`;\n\t\t\t\n\t\t\tif ($path == 0) \n\n\t\t\t{\n\t\t\t\t$filePath = `fileDialog -dm (\"*\" + $fileExt)`;\n\t\t\t}\n\n\t\t\telse\n\n\t\t\t{\n\t\t\t\t$dir = `match \"^.*[/\\\\]\" $path`;\n\t\t\t\t$filePath = `fileDialog -dm ($dir + \"\\*\" + $fileExt)`;\n\t\t\t}\n\t\t\t\t\n\t\t\tbreak;\n\n\t\tcase \".sx\":\n\n\t\t\t$path = `optionVar -q \"suffix\"`;\n\t\t\t\n\t\t\tif ($path == 0) \n\n\t\t\t{\n\t\t\t\t$filePath = `fileDialog -dm (\"*\" + $fileExt)`;\n\t\t\t}\n\n\t\t\telse\n\n\t\t\t{\n\t\t\t\t$dir = `match \"^.*[/\\\\]\" $path`;\n\t\t\t\t$filePath = `fileDialog -dm ($dir + \"\\*\" + $fileExt)`;\n\t\t\t}\n\t\t\t\t\n\t\t\tbreak;\n\t}\n\n\treturn $filePath;\n}\n\nglobal proc string[] ap_SortHierarchy (string $objs[]) {\n\t\n\tstring $levels[];\n\tstring $sorted[];\n\t\n\tint $n;\n\tint $lowest = 0;\n\tint $current = 0;\n\n\tfor ($obj in $objs)\t{\n\t\t$n = (`ap_NumberParents $obj`);\n\n\t\tif ($n != \"\") {\n\t\t\t$levels[`size $levels`] = $n;\n\t\t}\n\t\telse $levels[`size $levels`] = 0;\n\n\t\tif ($n > $lowest) {\n\t\t\t$lowest = $n;\n\t\t}\n\t}\n\n\twhile ($current <= $lowest)\t{\n\t\tfor ($o = 0; $o < `size $objs`; $o++) {\n\t\t\tif ($levels[$o] == $current) {\n\t\t\t\t$sorted[`size $sorted`] = $objs[$o];\n\t\t\t}\n\t\t}\n\t\t$current++;\n\t}\n\n\treturn $sorted;\n}\n/////////////////////////////\nglobal proc string[] ap_ReadFile (string $filePath)\n\n{\n\tint $strip = 1;\n\n\tstring $lines[];\n\tstring $line = \" \";\n\n\tif (`filetest -r $filePath`) {\n\t\t$fileId = `fopen $filePath \"r\"`;\n\n\t\twhile (`size $line` > 0) {\n\t\t\t$line = `fgetline $fileId`;\n\n\t\t\tif (`size $line`) {\n\t\t\t\tif ($strip) $lines[`size $lines`] = `substitute \"\\n\" $line \"\"`;\n\t\t\t\telse $lines[`size $lines`] = $line;\n\t\t\t}\n\t\t}\n\t\tfclose $fileId;\n\t}\n\telse error \"File does not exist or is not readable\";\n\t\n\treturn $lines;\n}\n\n\n\n//////////////////\n\nglobal proc ap_Capitalize ()\n\n{\n\tstring $sn, $renameCommand;\n\tstring $objs[] = `ls -l -sl`;\n\n\tstring $sorted[] = `ap_SortHierarchy $objs`;\n\tstring $reversed[] = `ap_ReverseArray $sorted`;\n\n\tfor ($obj in $reversed)\n\n\t{\n\t\t$sn = `match \"[^|]*$\" $obj`;\n\t\tstring $capsString = `capitalizeString $sn`;\n\t\t\n\t\t$renameCommand = (\"rename \" + $obj + \" \" + $capsString);\n\t\tif (catch (`eval $renameCommand`)) print \"Error in Rename | ap_Capitalize.mel\";\n\t}\n}\n\n\n///////////////\n\n\nglobal proc string ap_ArrayElement (string $array[]) {\n\tstring $element = $array[0];\n\treturn $element;\n}\n\nglobal proc string[] ap_AddArray (string $a[], string $b[]) {\n\tfor ($val in $b) {\n\t\t$a[`size $a`] = $val;\n\t}\n\treturn $a;\n}\n\nglobal proc string[] ap_SubtractArray (string $a[], string $b[]) {\n\tstring $returnArray[];\n\tint $exists;\n\n\tfor($elementA in $a) {\n\t\t$exists = 0;\n\n\t\tfor ($elementB in $b) {\n\t\t\tif ($elementA == $elementB) $exists = 1;\n\t\t}\n\t\t\n\t\tif (!$exists) {\n\t\t\t$returnArray[`size $returnArray`] = $elementA;\n\t\t}\n\t}\n\t\n\treturn $returnArray;\n}\n\nglobal proc int ap_NumberParents (string $obj) {\n\tstring $parentObjs[];\n\tint $p = `tokenize $obj \"|\" $parentObjs`;\n\t$p--;\n\n\treturn $p;\n}\n\nglobal proc string ap_FileName () {\n\tstring $filePath = substitute (\"Mel procedure found in: \", (string) `whatIs \"returnFileName\"`, \"\");\n\treturn $filePath;\n}\n\nglobal proc string[] ap_ReverseArray (string $array[]) {\n\tstring $returnArray[];\n\tint $arraySize = `size $array`;\n\n\tfor ($e = 0; $e < `size $array`; $e++) {\n\t\t$returnArray[$arraySize - 1 - $e] = $array[$e];\n\t}\n\n\treturn $returnArray;\n}\n\n\nap_RenameObjs();" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "global proc ap_RenameObjs ()\n\n{\n\tstring $win = \"ap_RenameObjs_Wi..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "改名2" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "global proc ap_RenameObjs ()\n\n{\n\tstring $win = \"ap_RenameObjs_Win\";\n\n\tif (`window -ex $win`) {\n\t\tdeleteUI $win;\n\t\twindowPref -remove $win;\n\t}\n\n\tap_RenameObjs_Ui $win;\n\tshowWindow $win;\n}\n\n// global proc selectBelow() {\n// \tprint (`listRelatives -ad -type \"transform\"`);\n// }\n\nglobal proc chiAddSuffix() {\n\n\tstring $sel[] = `ls -sl`;\n\tstring $s = \"\";\n\t\n\tstring $suffixStr = `textField -q -tx ap_RenameObjs_Fld_Txt_3`;\n\n\tfor ($s in $sel) {\n\t\trename $s ($s + $suffixStr);\n\t}\n}\n\n//Layout the ui\nglobal proc ap_RenameObjs_Ui (string $win)\n\n{\n\tstring $ro = \"ap_RenameObjs_\";\n\n\twindow -t \"改名工具包（整理）\" -mb 1 -tlb 1 -mnb 1 -s 1 $win;\n\t\n\t//Create menu items\n/*\n\tmenu -p $win -to 1 -l \"Settings\";\n\tmenuItem -c \"ap_RenameObjs_ap_RenameObjs_Browse prefix\" -l \"Prefix File\";\n\tmenuItem -c \"ap_RenameObjs_ap_RenameObjs_Browse suffix\" -l \"Suffix File\";\n*/\n\t// menu -p $win -to 1 -l \"Extra\";\n\t// menuItem -c \"ap_Capitalize; ap_RenameObjs_Update_Tsl ap_RenameObjs_Tsl_1;\" -l \"Capitalize Name\";\n\t// menuItem -c \"select -hi\" -l \"Select -hi\";\n\t// menuItem -c \"print (size(`ls -sl`) + \\\" Objects Selected.\\\")\" -l \"Print no of objects selected\";\n\n  \tstring $form_1 = `formLayout -p $win ($ro + \"Form_1\")`;\n\n\tstring $col_1 = `columnLayout -p $form_1 -adj 1 ($ro + \"Col_1\")`;\n\n// \tbutton -l \"Select below\" -c \"selectBelow()\";\n\tbutton -l \"lun make unique => Create Set\" -c \"makeObjsUnique(1)\";\n\tbutton -l \"lun make unique => Rename\" -c \"makeObjsUnique(0)\";\n\tbutton -l \"select all transforms below\" -c \"select -hi;string $f = `itemFilter -byType transform`;select -r `lsThroughFilter -sl $f`;\";\n\tbutton -l \"Run Suffix (without changing #)\" -c \"chiAddSuffix;ap_RenameObjs_Update_Tsl ap_RenameObjs_Tsl_1;\";\n\t\n\tseparator -h 10;\n\t\n\tstring $frm_1 = `frameLayout -p $col_1 -cl 0 -cll 1 -bv 0 -mh 5 -fn \"plainLabelFont\" -li 5 -l \"Rename:\" ($ro + \"Frm_1\")`;\n\t\n\tstring $col_2 = `columnLayout -p $frm_1 -adj 1 ($ro + \"Col_2\")`;\n\n \tstring $row_1 = `rowLayout -p $col_2 -nc 3 -cw3 55 300 55 -adj 2 -cat 1 \"right\" 5 -cat 2 \"both\" 0 -cat 3 \"left\" 5 ($ro + \"Row_1\")`;\n\n\ttext -l \"Prefix\";\n\tstring $txtFld_1 = `textField -cc \"setFocus ap_RenameObjs_But_1\" ($ro + \"Fld_Txt_1\")`;\n\tbutton -c \"ap_RenameObjs_Rename 1\" -l \"Run\" ($ro + \"But_1\");\n\t\n\tstring $pop_1 = `popupMenu -p $txtFld_1 ($ro + \"Pop_1\")`;\n\tpopupMenu -e -pmc (\"ap_RenameObjs_Update_Popup \\\"\" + $pop_1 + \"\\\" \\\"prefix\\\" \\\"\" + $txtFld_1 + \"\\\"\") $pop_1;\n\t\n \tstring $row_2 = `rowLayout -p $col_2 -nc 3 -cw3 55 300 55 -adj 2 -cat 1 \"right\" 5 -cat 2 \"both\" 0 -cat 3 \"left\" 5 ($ro + \"Row_2\")`;\n\n\ttext -l \"Name\";\n\tstring $txtFld_2 = `textField -cc \"setFocus ap_RenameObjs_But_2\" ($ro + \"Fld_Txt_2\")`;\n\tbutton -c \"ap_RenameObjs_Rename 2\" -l \"Run\" ($ro + \"But_2\");\n\n\tstring $row_3 = `rowLayout -p $col_2 -nc 3 -cw3 55 300 55 -adj 2 -cat 1 \"right\" 5 -cat 2 \"both\" 0 -cat 2 \"both\" 0 -cat 3 \"left\" 5 ($ro + \"Row_3\")`;\n\n\ttext -l \"Suffix\";\n\tstring $txtFld_3 = `textField -cc \"setFocus ap_RenameObjs_But_3\" ($ro + \"Fld_Txt_3\")`;\n\tbutton -c \"ap_RenameObjs_Rename 3\" -l \"Run\" ($ro + \"But_3\");\n\n\tstring $pop_2 = `popupMenu -p $txtFld_3 ($ro + \"Pop_2\")`;\n\tpopupMenu -e -pmc (\"ap_RenameObjs_Update_Popup \\\"\" + $pop_2 + \"\\\" \\\"suffix\\\" \\\"\" + $txtFld_3 + \"\\\"\") $pop_2;\n\n\tstring $frm_2 = `frameLayout -p $col_1 -cl 0 -cll 1 -bv 0 -mh 5 -fn \"plainLabelFont\" -li 5 -l \"Replace: [ namespace works too ! ]\" ($ro + \"Frm_2\")`;\n\n\tstring $col_3 = `columnLayout -p $frm_2 -adj 1 ($ro + \"Col_3\")`;\n\tstring $row_4 = `rowLayout -p $col_3 -nc 2 -cw2 55 355 -adj 2 -cat 1 \"right\" 5 -cat 2 \"right\" 20 ($ro + \"Row_4\")`;\n\t\n\ttext -l \"Replace\";\n\tstring $txtFld_4 = `textField ($ro + \"Fld_Txt_4\")`;\n\n\tstring $row_5 = `rowLayout -p $col_3 -nc 2 -cw2 55 355 -adj 2 -cat 1 \"right\" 5 -cat 2 \"right\" 20 ($ro + \"Row_5\")`;\n\n\ttext -l \"With\";\n\tstring $txtFld_5 = `textField ($ro + \"Fld_Txt_5\")`;\n\n\tstring $row_6 = `rowLayout -p $col_3 -nc 2 -cw2 55 355 -adj 2 -cat 1 \"right\" 5 -cal 2 \"center\" -cat 2 \"right\" 20 ($ro + \"Row_6\")`;\n\n\ttext -l \"\";\n\tstring $but_4 = `button -c \"ap_RenameObjs_Rename 4\" -l \"Replace\" ($ro + \"But_4\")`;\n\n\tstring $frm_3 = `frameLayout -p $col_1 -cl 0 -cll 1 -bv 0 -mh 5 -fn \"plainLabelFont\" -li 5 -l \"Append Number:\" ($ro + \"Frm_3\")`;\n\tstring $col_4 = `columnLayout -p $frm_3 -adj 1 ($ro + \"Col_3\")`;\n\t\n\tstring $row_7 = `rowLayout -p $col_4 -nc 2 -cw2 55 355 -adj 2 -cat 1 \"right\" 5 -cat 2 \"right\" 20 ($ro + \"Row_7\")`;\n\n\ttext -l \"Start\";\n\tstring $intFld_1 = `intField -min 0 -v 1 ($ro + \"IntFld_1\")`;\n\n\tstring $row_8 = `rowLayout -p $col_4 -nc 2 -cw2 55 355 -adj 2 -cat 1 \"right\" 5 -cat 2 \"right\" 20 ($ro + \"Row_8\")`;\n\t\n\ttext -l \"Increment\";\n\tstring $intFld_2 = `intField -min 1 -v 1 ($ro + \"IntFld_2\")`;\n\n\tstring $row_9 = `rowLayout -p $col_4 -nc 2 -cw2 55 355 -adj 2 -cat 1 \"right\" 5 -cat 2 \"right\" 20 ($ro + \"Row_9\")`;\n\t\n\ttext -l \"Padding\";\n\tstring $intFld_3 = `intField -min 1 -v 1 ($ro + \"IntFld_3\")`;\n\n\tstring $row_10 = `rowLayout -p $col_4 -nc 2 -cw2 55 355 -adj 2 -cat 1 \"right\" 5 -cat 2 \"right\" 20 ($ro + \"Row_10\")`;\n\n\ttext -l \"\";\n\tstring $but_6 = `button -c \"ap_RenameObjs_Rename 5\" -l \"              Apply Number\" ($ro + \"But_6\")`;\n\n\tstring $frm_4 = `frameLayout -p $form_1 -cl 0 -cll 1 -bv 0 -mh 5 -fn \"plainLabelFont\" -li 5 -l \"Selected Objects:\" ($ro + \"Frm_4\")`;\n\n \tstring $tsl_1 = `textScrollList -p $frm_4 ($ro + \"Tsl_1\")`;\n\n\tframeLayout -e -ec \"ap_RenameObjs_Cll_Tsl ap_RenameObjs_Win ap_RenameObjs_Tsl_1\" $frm_4;\n\tframeLayout -e -cc \"ap_RenameObjs_Cll_Tsl ap_RenameObjs_Win ap_RenameObjs_Tsl_1\" $frm_4;\n\n \tformLayout -e\n\n    \t\t-attachForm $col_1 \"top\" 5\n    \t\t-attachForm $col_1 \"left\" 5\n    \t\t-attachForm $col_1 \"right\" 5\n    \t\t-attachNone $col_1 \"bottom\"\n   \n    \t\t-attachControl $frm_4 \"top\" 0 $col_1\n    \t\t-attachForm $frm_4 \"left\" 5\n    \t\t-attachForm $frm_4 \"right\" 5\n    \t\t-attachForm $frm_4 \"bottom\" 0\n  \t$form_1;\n\n\twindow -e -wh 250 550 -s 1 $win;\n\n\tap_RenameObjs_Update_Tsl $tsl_1;\n\t\t\n\tscriptJob -p $tsl_1 -e SelectionChanged (\"ap_RenameObjs_Update_Tsl \\\"\" + $tsl_1 + \"\\\"\");\n}\n\n//Collapse the object list\n\nglobal proc ap_RenameObjs_Cll_Tsl (string $win, string $tsl_1)\n\n{\n\tstring $frm_4 = \"ap_RenameObjs_Frm_4\";\n\n\tif (`frameLayout -q -cl $frm_4` == 1)\n\n\t{\n\t\t\n\t\tdeleteUI $tsl_1;\n\t}\n\n\telse\n\n\t{\n \t\t$tsl_1 = `textScrollList -p $frm_4 $tsl_1`;\n\t\tscriptJob -p $tsl_1 -e SelectionChanged (\"ap_RenameObjs_Update_Tsl \\\"\" + $tsl_1 + \"\\\"\");\n\n\t\tap_RenameObjs_Update_Tsl $tsl_1;\n\t}\n}\n\nglobal proc ap_RenameObjs_Update_Tsl (string $tsl_1)\n\t\n{\n\tstring $objs[];\n\t\n\tif (`textScrollList -exists $tsl_1`)\n\n\t{\n\t\ttextScrollList -e -ra $tsl_1;\n\n\t\t$objs = `ls -l -sl`;\n\n\t\tif (`size $objs` != 0)\n\t\n\t\t{\n\t\t\tfor ($obj in $objs)\n\t\n\t\t\t{\t\n\t\t\t\tstring $sn = `match \"[^|]*$\" $obj`;\n\t\t\t\ttextScrollList -e -a $sn $tsl_1;\n\t\t\t}\n\t\t}\n\t}\n}\n\nglobal proc ap_RenameObjs_Update_Popup (string $pop, string $type, string $field)\n\n{\n\tint $p = 0;\n\tstring $items[], $itemName, $filePath;\n\n\tpopupMenu -e -dai $pop;\n\n\tif ($type == \"prefix\") $filePath = `optionVar -q \"prefix\"`;\n\telse if ($type == \"suffix\") $filePath = `optionVar -q \"suffix\"`;\n\n\tif ($filePath != 0)\n\n\t{\n\t\tif (`filetest -r $filePath`) $items = `ap_ReadFile $filePath`;\n\t\telse menuItem -p $pop -en 0 -l \"No file set\" ($pop + \"_Item_\" + $p);\n\t}\n\n\telse menuItem -p $pop -en 0 -l \"No file set\" ($pop + \"_Item_\" + $p);\n\n\t$items = `ap_RemoveDuplicates $items`;\n\t$items = `sort $items`;\n\n\tfor ($i in $items)\n\n\t{\n\t\tif ($i != \"\")\n\n\t\t{\n\t\t\t$itemName = `menuItem -p $pop -l $i ($pop + \"_Item_\" + $p)`;\n\t\t\tmenuItem -e -c (\"eval (\\\"textField -e -tx `menuItem -q -l \\\\\\\"\" + $itemName + \"\\\\\\\"` \\\\\\\"\" + $field + \"\\\\\\\"\\\")\") $itemName;\n\t\t\t$p++;\n\t\t}\n\t}\n\n\tif (`popupMenu -q -ni $pop` == 0) menuItem -p $pop -en 0 -l \"None\" ($pop + \"_Item_\" + $p);\n}\n\nglobal proc ap_RenameObjs_ap_RenameObjs_Browse (string $fileType)\n\n{\n\tstring $filePath, $items[];\n\n\tif ($fileType == \"prefix\")\n\n\t{\n\t\t$filePath = `ap_RenameObjs_Browse \".px\"`;\n\n\t\tif ($filePath != \"\")\n\n\t\t{\n\t\t\tif (`optionVar -ex $fileType`) optionVar -rm $fileType;\n\t\n\t\t\toptionVar -sv $fileType $filePath;\n\t\t\n\t\t\tap_RenameObjs_Update_Popup \"ap_RenameObjs_Pop_1\" \"prefix\" \"ap_RenameObjs_Txt_Fld_1\";\n\t\t}\n\t}\n\n\telse if ($fileType == \"suffix\")\n\n\t{\n\t\t$filePath = `ap_RenameObjs_Browse \".sx\"`;\n\n\t\tif ($filePath != \"\")\n\n\t\t{\n\t\t\tif (`optionVar -ex $fileType`) optionVar -rm $fileType;\n\t\n\t\t\toptionVar -sv $fileType $filePath;\n\t\n\t\t\tap_RenameObjs_Update_Popup \"ap_RenameObjs_Pop_2\" \"prefix\" \"ap_RenameObjs_Txt_Fld_3\";\n\t\t}\n\t}\n}\n\nglobal proc ap_RenameObjs_Rename (int $mode)\n\n{\n\t//Retrieve user input\n\n\tstring $p = `textField -q -tx ap_RenameObjs_Fld_Txt_1`;\n\tstring $n = `textField -q -tx ap_RenameObjs_Fld_Txt_2`;\n\tstring $s = `textField -q -tx ap_RenameObjs_Fld_Txt_3`;\n\n\tstring $r = `textField -q -tx ap_RenameObjs_Fld_Txt_4`;\n\tstring $w = `textField -q -tx ap_RenameObjs_Fld_Txt_5`;\t\n\n\t//List objects\n\n\tstring $objs[] = `ls -l -sl`;\n\t\n\t//Sort the list of objects into hierarchial order\n\n\tstring $sorted[] = `ap_SortHierarchy $objs`;\n\n\t//Reverse the list so the lowest children are first in the list\n\n\tstring $reversed[] = `ap_ReverseArray $sorted`;\n\n\t//if (`match \"[0-9]*$\" $name` != \"\") $name += \"_\";\n\n\tfor ($obj in $reversed)\n\n\t{\n\t\tswitch ($mode)\n\n\t\t{\n\t\t\tcase 1:\n\t\t\tstring $sn = `match \"[^|]*$\" $obj`;\n\t\t\t$renameCommand = (\"rename \" + $obj + \" \" + ($p + $sn));\n\t\t\tbreak;\n\n\t\t\tcase 2:\n\t\t\t$renameCommand = (\"rename \" + $obj + \" \" + $n);\n\t\t\tbreak;\n\n\t\t\tcase 3:\n\t\t\tstring $sn = `match \"[^|]*$\" $obj`;\n\t\t\t$sn = `match \".*[^_0-9]\" $sn`;\n\t\t\t$renameCommand = (\"rename \" + $obj + \" \" + ($sn + $s));\n\t\t\tbreak;\n\n\t\t\tcase 4:\n\t\t\tstring $sn = `match \"[^|]*$\" $obj`;\t\n\n\t\t\tif ($r == \"\") error \"\";\n\t\t\t//if ($w == \"\") error \"\";\t\t\n\n\t\t\t$sn = `substitute $r $sn $w`;\n\t\t\t$renameCommand = (\"rename \" + $obj + \" \" + $sn);\n\t\t\tbreak;\n\n\t\t\tcase 5:\n\t\t\tstring $sn = `match \"[^|]*$\" $obj`;\n\t\t\t$sn = `match \".*[^_0-9]\" $sn`;\n\t\t\tstring $numbers[] = `ap_RenameObjs_Number $objs`;\n\n\t\t\tfor ($o = 0; $o < `size $objs`; $o++)\n\n\t\t\t{\n\t\t\t\tif ($objs[$o] == $obj)\n\n\t\t\t\t{\n\t\t\t\t\t$renameCommand = (\"rename \" + $obj + \" \" + ($sn + \"_\" + $numbers[$o]));\n\t\t\t\t\tbreak;\t\t\t\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbreak;\n\t\t}\n\n\t\t//If the rename command generates errors, catch them and continue\t\t\n\n\t\tif (catch (`eval $renameCommand`)) print \"\";\n\t}\n\n\tap_RenameObjs_Update_Tsl ap_RenameObjs_Tsl_1;\n}\n\n\n\nglobal proc string[] ap_RenameObjs_Number (string $objs[])\n\n{\n\tstring $numbers[];\n\tstring $numString;\n\tstring $zeros = \"\";\n\n\tint $numZeros;\n\n\t//Load the values of the intField boxes into variables\n\t\n\tint $start = `intField -q -v ap_RenameObjs_IntFld_1`;\n\tint $inc = `intField -q -v ap_RenameObjs_IntFld_2`;\n\tint $pad = `intField -q -v ap_RenameObjs_IntFld_3`;\n\n\tint $current = $start;\n\n\tif ($pad == 1)\n\n\t{\n\t\tfor ($obj in $objs)\n\n\t\t{\n\t\t\t$numbers[`size $numbers`] = $current;\n\t\t\t$current = $current + $inc;\n\t\t}\n\t}\n\t\n\tif ($pad > 1)\n\n\t{\n\t\tfor ($obj in $objs)\n\n\t\t{\n\t\t\t$numString = $current;\n\n\t\t\tif (`size $numString` < $pad)\n\n\t\t\t{\t\n\t\t\t\t$numZeros = $pad - (`size $numString`);\n\t\t\t\t\t\t\n\t\t\t\tfor ($n = $numZeros; $n > 0; $n--)\n\n\t\t\t\t{\n\t\t\t\t\t$zeros = $zeros + \"0\";\n\t\t\t\t}\n\n\t\t\t\t$numString = $zeros + $numString;\n\t\t\t\t$numbers[`size $numbers`] = $numString;\n\t\t\t}\n\n\t\t\telse $numbers[`size $numbers`] = $current;\n\n\t\t\t$current = $current + $inc;\t\n\t\t\t$zeros = \"\";\n\t\t}\n\t}\n\n\treturn $numbers;\n}\n\nglobal proc string ap_RenameObjs_Browse (string $fileExt)\n\n{\n\tstring $dir, $filePath, $path;\n\n\tswitch ($fileExt)\n\n\t{\n\t\tcase \".px\":\n\n\t\t\t$path = `optionVar -q \"prefix\"`;\n\t\t\t\n\t\t\tif ($path == 0) \n\n\t\t\t{\n\t\t\t\t$filePath = `fileDialog -dm (\"*\" + $fileExt)`;\n\t\t\t}\n\n\t\t\telse\n\n\t\t\t{\n\t\t\t\t$dir = `match \"^.*[/\\\\]\" $path`;\n\t\t\t\t$filePath = `fileDialog -dm ($dir + \"\\*\" + $fileExt)`;\n\t\t\t}\n\t\t\t\t\n\t\t\tbreak;\n\n\t\tcase \".sx\":\n\n\t\t\t$path = `optionVar -q \"suffix\"`;\n\t\t\t\n\t\t\tif ($path == 0) \n\n\t\t\t{\n\t\t\t\t$filePath = `fileDialog -dm (\"*\" + $fileExt)`;\n\t\t\t}\n\n\t\t\telse\n\n\t\t\t{\n\t\t\t\t$dir = `match \"^.*[/\\\\]\" $path`;\n\t\t\t\t$filePath = `fileDialog -dm ($dir + \"\\*\" + $fileExt)`;\n\t\t\t}\n\t\t\t\t\n\t\t\tbreak;\n\t}\n\n\treturn $filePath;\n}\n\nglobal proc string[] ap_SortHierarchy (string $objs[]) {\n\t\n\tstring $levels[];\n\tstring $sorted[];\n\t\n\tint $n;\n\tint $lowest = 0;\n\tint $current = 0;\n\n\tfor ($obj in $objs)\t{\n\t\t$n = (`ap_NumberParents $obj`);\n\n\t\tif ($n != \"\") {\n\t\t\t$levels[`size $levels`] = $n;\n\t\t}\n\t\telse $levels[`size $levels`] = 0;\n\n\t\tif ($n > $lowest) {\n\t\t\t$lowest = $n;\n\t\t}\n\t}\n\n\twhile ($current <= $lowest)\t{\n\t\tfor ($o = 0; $o < `size $objs`; $o++) {\n\t\t\tif ($levels[$o] == $current) {\n\t\t\t\t$sorted[`size $sorted`] = $objs[$o];\n\t\t\t}\n\t\t}\n\t\t$current++;\n\t}\n\n\treturn $sorted;\n}\n/////////////////////////////\nglobal proc string[] ap_ReadFile (string $filePath)\n\n{\n\tint $strip = 1;\n\n\tstring $lines[];\n\tstring $line = \" \";\n\n\tif (`filetest -r $filePath`) {\n\t\t$fileId = `fopen $filePath \"r\"`;\n\n\t\twhile (`size $line` > 0) {\n\t\t\t$line = `fgetline $fileId`;\n\n\t\t\tif (`size $line`) {\n\t\t\t\tif ($strip) $lines[`size $lines`] = `substitute \"\\n\" $line \"\"`;\n\t\t\t\telse $lines[`size $lines`] = $line;\n\t\t\t}\n\t\t}\n\t\tfclose $fileId;\n\t}\n\telse error \"File does not exist or is not readable\";\n\t\n\treturn $lines;\n}\n\n\n\n//////////////////\n\nglobal proc ap_Capitalize ()\n\n{\n\tstring $sn, $renameCommand;\n\tstring $objs[] = `ls -l -sl`;\n\n\tstring $sorted[] = `ap_SortHierarchy $objs`;\n\tstring $reversed[] = `ap_ReverseArray $sorted`;\n\n\tfor ($obj in $reversed)\n\n\t{\n\t\t$sn = `match \"[^|]*$\" $obj`;\n\t\tstring $capsString = `capitalizeString $sn`;\n\t\t\n\t\t$renameCommand = (\"rename \" + $obj + \" \" + $capsString);\n\t\tif (catch (`eval $renameCommand`)) print \"Error in Rename | ap_Capitalize.mel\";\n\t}\n}\n\n\n///////////////\n\n\nglobal proc string ap_ArrayElement (string $array[]) {\n\tstring $element = $array[0];\n\treturn $element;\n}\n\nglobal proc string[] ap_AddArray (string $a[], string $b[]) {\n\tfor ($val in $b) {\n\t\t$a[`size $a`] = $val;\n\t}\n\treturn $a;\n}\n\nglobal proc string[] ap_SubtractArray (string $a[], string $b[]) {\n\tstring $returnArray[];\n\tint $exists;\n\n\tfor($elementA in $a) {\n\t\t$exists = 0;\n\n\t\tfor ($elementB in $b) {\n\t\t\tif ($elementA == $elementB) $exists = 1;\n\t\t}\n\t\t\n\t\tif (!$exists) {\n\t\t\t$returnArray[`size $returnArray`] = $elementA;\n\t\t}\n\t}\n\t\n\treturn $returnArray;\n}\n\nglobal proc int ap_NumberParents (string $obj) {\n\tstring $parentObjs[];\n\tint $p = `tokenize $obj \"|\" $parentObjs`;\n\t$p--;\n\n\treturn $p;\n}\n\nglobal proc string ap_FileName () {\n\tstring $filePath = substitute (\"Mel procedure found in: \", (string) `whatIs \"returnFileName\"`, \"\");\n\treturn $filePath;\n}\n\nglobal proc string[] ap_ReverseArray (string $array[]) {\n\tstring $returnArray[];\n\tint $arraySize = `size $array`;\n\n\tfor ($e = 0; $e < `size $array`; $e++) {\n\t\t$returnArray[$arraySize - 1 - $e] = $array[$e];\n\t}\n\n\treturn $returnArray;\n}\n\n\nap_RenameObjs();" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "string $nb[]=`ls -sl`;\nfor ($a in $nb)\n{\n    setAttr ($a+\".tx\") (rand(-10,10));\n    setAttr ($a+\".ty\") (rand(-10,10));\n    setAttr ($a+\".tz\") (rand(-10,10));\n    \n    setAttr ($a+\".rx\") (rand(0,360));\n    setAttr ($a+\".ry\") (rand(0,360));\n    setAttr ($a+\".rz\") (rand(0,360));\n    \n    setKeyframe ($a+\".tx\");\n    setKeyframe ($a+\".ty\");\n    setKeyframe ($a+\".tz\");\n    setKeyframe ($a+\".rx\");\n    setKeyframe ($a+\".ry\");\n    setKeyframe ($a+\".rz\");\n\n}\nselect -r $nb;" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "string $nb[]=`ls -sl`;\nfor ($a in $nb)\n{\n    setAttr ($a+\".tx\") ..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "聚散" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "string $nb[]=`ls -sl`;\nfor ($a in $nb)\n{\n    setAttr ($a+\".tx\") (rand(-10,10));\n    setAttr ($a+\".ty\") (rand(-10,10));\n    setAttr ($a+\".tz\") (rand(-10,10));\n    \n    setAttr ($a+\".rx\") (rand(0,360));\n    setAttr ($a+\".ry\") (rand(0,360));\n    setAttr ($a+\".rz\") (rand(0,360));\n    \n    setKeyframe ($a+\".tx\");\n    setKeyframe ($a+\".ty\");\n    setKeyframe ($a+\".tz\");\n    setKeyframe ($a+\".rx\");\n    setKeyframe ($a+\".ry\");\n    setKeyframe ($a+\".rz\");\n\n}\nselect -r $nb;" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "import pw_mGeo\npw_mGeo.show()" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "import pw_mGeo\npw_mGeo.show()" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "pw_mGeo" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "pythonFamily.png" 
        -image1 "pythonFamily.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "import pw_mGeo\npw_mGeo.show()" 
        -sourceType "python" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "MkDir()" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "MkDir()" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "pythonFamily.png" 
        -image1 "pythonFamily.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "import maya.cmds as mc\nimport os\n\ndef MkDir():\n    path = raw_input('请输入路径：\\n')+'\\\\'\n    print(path)\n    numStart = input('请输入起始帧：\\n')\n    print numStart\n    numEnd = input('请输入结束帧：\\n')\n    print numEnd\n    i = 0\n    for i in range(numStart,numEnd+1):\n        s = '%03d' % i\n        temp_name='E11_Sc06_Cam'+str(s)\n        file_name = (path + temp_name)\n        maya_name = (file_name+'/'+temp_name+'.ma')\n        if not os.path.exists(maya_name):\n            mc.sysFile( file_name, makeDir=True )\n            mc.file( rename=maya_name )\n            mc.file(save=True)\n            i+=1\n        else:\n            print(u'文件已存在！！！')\n\nif __name__ == '__main__':\n    MkDir()" 
        -sourceType "python" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "Delete all non-deformer history" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "Non-Deformer History" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "NH" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "menuIconEdit.png" 
        -image1 "menuIconEdit.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "BakeAllNonDefHistory" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "Alembic export options" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "menuItem4457" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "Aeo" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "AlembicExportSelectionOptions" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "Export selection options" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "exportActiveFileOptions" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "Eso" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "menuIconFile.png" 
        -image1 "menuIconFile.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "ExportSelectionOptions" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "#coding:utf-8\nu'''\n#################################\n#\n#  HolyPipe 红鲸影视 版权所有\n#\n#################################\n\n红鲤动画|红鲸影视 的“普天同庆”Maya病毒 查杀工具。\n针对.ma文件进行批量查杀。\n请从红鲤动画官网下载本代码的最新版本运行\nhttp://www.honglianimation.com/res/pttq.zip\n\n此工具更详细的说明，请见红鲤动画公众号文章：\nhttps://mp.weixin.qq.com/s/0Wxru1Flyxn2XRwofETM5A\n'''\n\n__version__ = '20200623.0'\n\nimport sys, os, subprocess, json,time,datetime, glob, tempfile\nimport getpass, platform\nimport shutil\nfrom stat import ST_ATIME,ST_CTIME,ST_MTIME\n__gui__ = 'missing'\ntry:\n    from PySide2 import QtWidgets as qw,  QtCore\n    __gui__ = 'PySide2'\nexcept:\n    from PySide import QtGui as qw, QtCore\n    __gui__ = 'PySide'\n\n\n#region scan core\n#directory 需要扫描的路径//nas/data/PipePrjWork/putiantongqing/最后以斜线结尾\n#tryFix 1是修复，0是不修复\n#recursion 1是递归，0是不递归\n#logPath 扫描\"//nas/data/PipePrjWork/putiantongqing/pan_yao.txt\"\n#skipLog 0是断点续扫，1是重新扫描\ndef Scanner_ErrorFile_Main(directory,tryFix,recursion,logPath,skipLog, \n                                                uiInfoCallback=lambda info:None, \n                                                uiAddVirusCallback=lambda filePath:None):\n    #若重新扫描，删掉log，后改为不删log\n    #if skipLog == 1 and os.path.isfile(logPath):\n    #    os.remove(logPath)\n    timeNow = datetime.datetime.now()\n    timeNowStr = timeNow.strftime(\"%Y-%m-%d %H:%M:%S\")\n    writeLog(logPath,timeNowStr+',scann Folder Path:'+directory+'\\n')\n    allMa = []\n    errFileList = []\n    if recursion:#递归扫描文件夹里的所有ma，并直接扫描，以免服务器根目录递归过程报错无法断点续扫\n        ScanFilesFromFolder(directory,logPath,skipLog,prefix=None,postfix='.ma',  tryFix=tryFix,\n                                    uiInfoCallback=uiInfoCallback,\n                                    uiAddVirusCallback=uiAddVirusCallback)\n    else:#非递归扫描文件夹里的所有ma\n        getAllFile = os.listdir(directory)\n        #断点续扫，读取log里记录的扫过的文件路径信息\n        logInfo = ''\n        if skipLog == 0 and os.path.isfile(logPath):\n            f = open(logPath,'r')\n            logInfo = f.read()\n            f.close()\n        for mm in getAllFile:\n            #若扫描过，则跳过\n            if skipLog == 0 and logInfo and logInfo.count(directory+mm):\n                print(directory+mm+' is already scann\\n')\n                continue\n            if mm.endswith('.ma'):\n                allMa.append(directory+mm)\n        #根据扫描出来的ma文件列表，进行下一步处理\n        for i,mm in enumerate(allMa):\n            uiInfoCallback('scaning (%i/%i): %s'%(i, len(allMa), mm))\n            isErrorFile = DoScanFile(mm,tryFix,logPath,skipLog)\n            if isErrorFile:\n                errFileList.append(mm)\n                uiAddVirusCallback(mm)\n        return errFileList\n\ndef ScanFilesFromFolder(directory,logPath,skipLog,prefix=None,postfix=None, \n                                        uiInfoCallback=lambda info:None, \n                                        uiAddVirusCallback=lambda filePath:None,\n                                        tryFix=False):\n    files_list=[]\n    #logInfo = ''\n    #断点续扫，读取log里记录的扫过的文件信息\n    #log文件记录方式：True d:/.../aa.ma    tryFix  202006221500    1024L\n    fileInLogDic = {}\n    alreadyExaminFiles = []\n    if skipLog == 0 and os.path.isfile(logPath):\n        f = open(logPath,'r')\n        lines = f.readlines()\n        f.close()\n        for mm in range(len(lines)):\n            getLineInfo = lines[mm].decode('utf-8').strip().split('\\t')\n            if len(getLineInfo) == 5:\n                fileInLogDic[getLineInfo[2]] = {'virus':getLineInfo[0],'killed':getLineInfo[1],'mtime':getLineInfo[3],'size':getLineInfo[4]}\n        alreadyExaminFiles = fileInLogDic.keys()\n\n    def appendScanFile(filePath):\n        files_list.append(filePath)\n        uiInfoCallback('scaning (%i): %s'%(len(files_list),  filePath))\n        isErrorFile = DoScanFile(filePath,tryFix,logPath,skipLog, uiAddVirusCallback=uiAddVirusCallback)\n\n    for root, sub_dirs, files in os.walk(directory):\n        uiInfoCallback('gathering files (%i): '% len(files_list)+root+'\\\\')\n        for special_file in files:\n            if not special_file.lower().endswith('.ma'):\n                continue\n            uiInfoCallback('gathering files (%i): '% len(files_list)+os.path.join(root,special_file) )\n            if postfix:\n                if special_file.endswith(postfix):\n                    if alreadyExaminFiles:#非第一次扫描\n                        if alreadyExaminFiles.count(os.path.join(root,special_file)):#文件被扫描过\n                            if time.strftime(\"%Y%m%d%H%M%S\",time.localtime(os.path.getmtime(os.path.join(root,special_file)))) == fileInLogDic.get(os.path.join(root,special_file)).get('mtime'):#文件修改时间和log里记录的上次扫描时的修改时间一致，即本次扫描和上次扫描比，文件没有改动\n                                if fileInLogDic.get(os.path.join(root,special_file)).get('virus') == 'True' and fileInLogDic.get(os.path.join(root,special_file)).get('killed') == 'False':#上次有毒，且只扫没杀，需要重新扫描并杀毒\n                                    appendScanFile(os.path.join(root,special_file))\n                                else:\n                                    continue\n                            else:#虽文件扫描过，但文件有修改，需要重新扫描\n                                appendScanFile(os.path.join(root,special_file))\n                        else:#文件没有被扫描过\n                            appendScanFile(os.path.join(root,special_file))\n                    else:#第一次扫描\n                        appendScanFile(os.path.join(root,special_file))\n            elif prefix:\n                if special_file.startswith(prefix):\n                    if alreadyExaminFiles:#非第一次扫描\n                        if alreadyExaminFiles.count(os.path.join(root,special_file)):#文件被扫描过\n                            if time.strftime(\"%Y%m%d%H%M%S\",time.localtime(os.path.getmtime(os.path.join(root,special_file)))) == fileInLogDic.get(os.path.join(root,special_file)).get('mtime'):#文件修改时间和log里记录的上次扫描时的修改时间一致，即本次扫描和上次扫描比，文件没有改动\n                                if fileInLogDic.get(os.path.join(root,special_file)).get('virus') == 'True' and fileInLogDic.get(os.path.join(root,special_file)).get('killed') == 'False':#上次有毒，且只扫没杀，需要重新扫描并杀毒\n                                    appendScanFile(os.path.join(root,special_file))\n                                else:\n                                    continue\n                            else:#虽文件扫描过，但文件有修改，需要重新扫描\n                                appendScanFile(os.path.join(root,special_file))\n                        else:#文件没有被扫描过\n                            appendScanFile(os.path.join(root,special_file))\n                    else:#第一次扫描\n                        appendScanFile(os.path.join(root,special_file))\n            else:\n                #若扫描过，则跳过\n                if skipLog == 0 and alreadyExaminFiles and alreadyExaminFiles.count(os.path.join(root,special_file)):\n                    print(os.path.join(root,special_file)+' is already scanned\\n')\n                    continue\n                appendScanFile(os.path.join(root,special_file))\n                if alreadyExaminFiles:#非第一次扫描\n                    if alreadyExaminFiles.count(os.path.join(root,special_file)):#文件被扫描过\n                        if time.strftime(\"%Y%m%d%H%M%S\",time.localtime(os.path.getmtime(os.path.join(root,special_file)))) == fileInLogDic.get(os.path.join(root,special_file)).get('mtime'):#文件修改时间和log里记录的上次扫描时的修改时间一致，即本次扫描和上次扫描比，文件没有改动\n                            if fileInLogDic.get(os.path.join(root,special_file)).get('killed') == False and tryFix:#上次只扫没杀，本次若需要杀毒，需要重新扫描并杀毒\n                                appendScanFile(os.path.join(root,special_file))\n                            else:\n                                continue\n                        else:#虽文件扫描过，但文件有修改，需要重新扫描\n                            appendScanFile(os.path.join(root,special_file))\n                    else:#文件没有被扫描过\n                        appendScanFile(os.path.join(root,special_file))\n                else:#第一次扫描\n                    appendScanFile(os.path.join(root,special_file))\n    return files_list\n\ndef DoScanFile(maPath,tryFix,logPath,skipLog, uiAddVirusCallback=lambda filePath:None):\n    try:\n        print('scanning: %s'%maPath)\n        maPath = LongLongFile(maPath)\n        errFile = 0\n        f = open(maPath,'r')\n        lines = f.readlines()\n        lenLines = len(lines)\n        errLine = []\n        for mm in range(lenLines):\n            if lines[mm].count('createNode script -n \"'):\n                #fopen  fprint  fclose同时出现，判断为带毒\n                isFopen = 0\n                isFprint = 0\n                isFclose = 0\n                #print '-------------start---------------'\n                errLine.append(mm)\n                tt = mm + 1\n                while not lines[tt].startswith('createNode ') and not lines[tt].startswith('select ') and not lines[tt].startswith('select ') and not lines[tt].startswith('connectAttr ') :\n                    isError = IsHaveKeyword(lines[tt])\n                    if isError:\n                        errFile = 1\n                    if lines[tt].count('fopen'):\n                        isFopen = 1\n                    if lines[tt].count('fprint'):\n                        isFprint = 1\n                    if lines[tt].count('fclose'):\n                        isFclose = 1\n                    errLine.append(tt)\n                    tt = tt + 1\n                    if tt>=lenLines:\n                        break\n                if errFile == 0:\n                    if isFopen == 1 and isFprint == 1 and isFclose == 1:\n                        print('have fopen  fprint  fclose')\n                        errFile = 1\n        f.close()\n        if tryFix and errFile:\n            if errLine:\n                #修复前先备份为后缀.putiantongqing\n                copyFrom = maPath\n                copyTo = maPath+'.putiantongqing'\n                shutil.copy(copyFrom,copyTo)\n                file_stat = os.stat(copyFrom)\n                os.utime(copyTo, (file_stat[ST_CTIME], file_stat[ST_MTIME]))\n                #os.remove(maPath)\n                with open(maPath, \"w\",) as f:\n                    for mm in range(len(lines)):\n                        if errLine.count(mm):\n                            continue\n                        else:\n                            f.write(lines[mm])\n                f.close()\n        #写入log\n        #获取ma文件的修改时间和大小，写入log\n        tryFixInfo = 'False'\n        if tryFix:\n            tryFixInfo = 'True'\n        mTime= time.strftime(\"%Y%m%d%H%M%S\",time.localtime(os.path.getmtime(maPath)))\n        fileSize = os.path.getsize(maPath)\n        if errFile:\n            writeLog(logPath,'True\\t'+tryFixInfo+'\\t'+maPath+'\\t'+str(mTime)+'\\t'+str(fileSize)+'\\n')\n        else:\n            writeLog(logPath,'False\\t'+tryFixInfo+'\\t'+maPath+'\\t'+str(mTime)+'\\t'+str(fileSize)+'\\n')\n        if errFile:\n            uiAddVirusCallback(maPath)\n        return errFile\n    except:\n        message = traceException(makeError=0)\n        writeLog(logPath+'.except',maPath+'\\n'+message+'\\n')\n\ndef IsHaveKeyword(lineInfo):\n    keyWord = ['UI_Mel_Configuration_think',\n                   'UI_Mel_Configuration_think_a',\n                   'UI_Mel_Configuration_think_b',\n                   'autoUpdateAttrEd_SelectSystem',\n                   'autoUpdatcAttrEd',\n                   'autoUpdatoAttrEnd',\n                   'fuck_All_U',\n                   '$PuTianTongQing']\n    for mm in keyWord:\n        if lineInfo.count(mm):\n            return 1\n    return 0\n\ndef writeLog(logPath,infoStr):\n    f = open(logPath, 'a')\n    f.write(infoStr.encode('utf-8'))\n    f.close()\n\ndef LongLongFile(result):\n    if len(result)>=260:\n        if result[2:3]!='?':\n            if result[:2] in ['\\\\\\\\','//']:\n                result = r'\\\\?\\UNC\\%s'%result[2:].replace('/','\\\\')\n            else:\n                result = r'\\\\?\\%s'%result.replace('/','\\\\')\n        else:\n            result = result.replace('/','\\\\')\n    return result\n\ndef traceException(makeError=0):\n    import traceback, StringIO\n    fp = StringIO.StringIO()\n    traceback.print_exc(file=fp)\n    message = fp.getvalue()\n    if message.split('\\n')[-2][0:len('SystemExit')] != 'SystemExit':\n        if makeError:\n            raise RuntimeError, message\n            pass\n        else:\n            print(message)\n            return message\n# endregion scan core\n\n# region gui\nclass VirusOp():\n    def __init__(self):\n        self.closeExistingWindow()\n        self.show_ui()\n\n    def closeExistingWindow(self):\n        for qt in qw.QApplication.topLevelWidgets():\n            try:\n                if qt.windowTitle() == u'Virus Scan Clean':\n                    qt.close()\n            except:\n                pass\n\n    def getFileDialogText(self):\n        scanPath = self.inputPathDir.getExistingDirectory()\n        self.filePath.setText(scanPath)\n\n    def getLogDialogText(self):\n        savePath = self.logDir.getOpenFileName()\n        self.logPath.setText(savePath)\n\n    def getFilePath(self):\n        curFilePath = self.filePath.text()\n        print('scan path is:')\n        print(curFilePath)\n        print('\\n')\n        return curFilePath + '\\\\'\n\n    def getLogPath(self):\n        curLogPath = self.logPath.text()\n        print('log path is:')\n        print(curLogPath)\n        print('\\n')\n        return curLogPath\n\n    def getScanMode(self):\n        curMode = self.modeCB.currentText()\n        print('scan mode is:')\n        print(curMode)\n        scanMode = 0\n        if curMode == u'重新扫描':\n            scanMode = 1\n        if curMode == u'断点扫描':\n            scanMode = 0\n        print(scanMode)\n        print('\\n')\n        return scanMode\n\n    def getCleanState(self):\n        curState = self.scanCleanBtn.checkState()\n        print('clean state is:')\n        print(curState)\n        cleanState = 0\n        if curState == 0:\n            cleanState = 0\n        else:\n            cleanState = 1\n        print(cleanState)\n        print('\\n')\n        return cleanState\n\n    def getWalkState(self):\n        curState = self.scanWalkBtn.checkState()\n        print('walk state is:')\n        print(curState)\n        walkState = 0\n        if curState == 0:\n            walkState = 0\n        else:\n            walkState = 1\n        print(walkState)\n        print('\\n')\n        return walkState\n\n    def addList(self, virusList):\n        scanModeParam = self.getScanMode()\n        if scanModeParam:\n            self.fileList.clear()\n        for iFile in virusList:\n            self.fileList.addItem(iFile)\n        print('finish adding\\n')\n\n    def getRefState(self, event):\n        refState = 0\n        if self.refBtn1.isChecked():\n            refState = 0\n        if self.refBtn2.isChecked():\n            refState = 1\n        if self.refBtn3.isChecked():\n            refState = 2\n        self.query.close()\n\n        subPaths = []\n        if event.mimeData().hasUrls():\n            event.setDropAction(QtCore.Qt.LinkAction)\n            event.accept()\n            for url in event.mimeData().urls():\n                filePath = unicode(url.toLocalFile())\n                print(filePath)\n                if os.path.isfile(filePath) and filePath.lower().endswith('.ma'):\n                    subPaths.extend([filePath])\n                elif os.path.isdir(filePath):\n                    subPaths.extend([x for x in glob.glob(filePath+'/*') if os.path.isfile(x) and x.lower().endswith('.ma')])\n        elif event.mimeData().hasText():\n            event.setDropAction(QtCore.Qt.LinkAction)\n            event.accept()\n            for text in event.mimeData().text().splitlines():\n                # filePath = text.split('\\t')[-1].replace('\"','')\n                for iPart in text.split('\\t'):\n                    tempPath = iPart.replace('\"','')\n                    if os.path.isfile(tempPath) and tempPath.lower().endswith('.ma'):\n                        subPaths.extend([tempPath])\n                    elif os.path.isdir(tempPath):\n                        subPaths.extend([x for x in glob.glob(tempPath+'/*') if os.path.isfile(x) and x.lower().endswith('.ma')])\n        \n        def recursiveGetRef(fileName, outList=[], cacheDict={}, recursive=True):\n            fileName = os.path.expandvars(fileName).replace('\\\\', '/')\n            if not os.path.isfile(fileName):\n                return\n            if fileName not in cacheDict:\n                cacheDict[fileName] = 1\n                outList.append(fileName)\n                self.fileList.addItem('\\t'+fileName)\n                qw.QApplication.instance().processEvents()\n            curFile = open(u'%s' % fileName, 'rb')\n            curLine = curFile.readline()\n            while curLine:\n                while not curLine.strip().endswith(';'):\n                    curLine += curFile.readline()\n                if 'file -rdi ' in curLine and '.ma' in curLine:\n                    maPath = os.path.expandvars(curLine.split('\\\"')[-2]).replace('\\\\', '/')\n                    if not os.path.isfile(maPath):\n                        maPath = os.path.dirname(fileName)+'/'+os.path.basename(maPath)\n                    if not os.path.isfile(maPath):\n                        print('Referenc path not accessable: %s'%maPath)\n                        curLine = curFile.readline()\n                        continue\n                    if maPath not in cacheDict:\n                        recursiveGetRef(maPath, outList=outList, cacheDict=cacheDict, recursive=True) if recursive else None\n                if 'file -r ' in curLine and '.ma' in curLine:\n                    maPath = os.path.expandvars(curLine.split('\\\"')[-2]).replace('\\\\', '/')\n                    if not os.path.isfile(maPath):\n                        maPath = os.path.dirname(fileName)+'/'+os.path.basename(maPath)\n                    if not os.path.isfile(maPath):\n                        curLine = curFile.readline()\n                        print('Referenc path not accessable: %s'%maPath)\n                        continue\n                    \n                    if maPath not in cacheDict:\n                        recursiveGetRef(maPath, outList=outList, cacheDict=cacheDict, recursive=True) if recursive else None\n\n                if 'requires ' in curLine:\n                    break\n                curLine = curFile.readline()\n            curFile.close()\n\n        listedPathCache = {}\n        if refState == 0:\n            for iSubPath in sorted(list(set(subPaths))):\n                self.fileList.addItem('\\t'+iSubPath)\n                listedPathCache[iSubPath.split('\\t')[-1].replace('\\\\','/')] = 1\n\n        if refState == 1:\n            print(u'one')\n            for i, iSubPath in enumerate(subPaths):\n                recursiveGetRef(iSubPath, outList=subPaths, cacheDict=listedPathCache, recursive=False)\n\n        if refState == 2:\n            print(u'all')\n            for i, iSubPath in enumerate(subPaths):\n                recursiveGetRef(iSubPath, outList=subPaths, cacheDict=listedPathCache, recursive=True)\n\n\n    def refQuery(self, event):\n\n        self.query = qw.QDialog()\n        self.query.setWindowFlags(QtCore.Qt.Window|QtCore.Qt.WindowStaysOnTopHint)\n        self.query.setWindowTitle('Query')\n\n        vLay = qw.QVBoxLayout()\n        self.query.setLayout(vLay)\n\n        scanLabel = qw.QLabel(u'扫描Maya文件中的Reference')\n        vLay.addWidget(scanLabel)\n\n        hLay = qw.QHBoxLayout()\n        vLay.addLayout(hLay)\n\n        self.refBtn1 = qw.QRadioButton(u'不包括Ref')\n        self.refBtn1.setChecked(1)\n        hLay.addWidget(self.refBtn1)\n\n        self.refBtn2 = qw.QRadioButton(u'包括一层Ref')\n        hLay.addWidget(self.refBtn2)\n\n        self.refBtn3 = qw.QRadioButton(u'包含所有Ref')\n        hLay.addWidget(self.refBtn3)\n\n        hLayRecovery = qw.QHBoxLayout()\n        vLay.addLayout(hLayRecovery)\n        hLayRecovery.addStretch()\n\n        recoveryButton = qw.QPushButton(u'   确定   ')\n        recoveryButton.clicked.connect(lambda a=1,e=event: self.getRefState(e))\n        hLayRecovery.addWidget(recoveryButton)\n\n        vLay.addStretch()\n        self.query.exec_()\n\n    def getList(self):\n        itemNum = self.fileList.count()\n        itemList = []\n        self.listDict = {}\n        for i in range(itemNum):\n            curItem = self.fileList.item(i)\n            curItemName = curItem.text()\n            itemList.append(curItemName)\n            self.listDict[curItemName.split('\\t')[-1]] = i\n            print(curItemName)\n        print(itemList)\n        return itemList\n\n    def emptyList(self):\n        removeList = self.fileList.selectedItems()\n        rows = sorted([self.fileList.row(item) for item in removeList])[::-1]\n        for row in rows:\n            removedItem = self.fileList.takeItem(row)\n            print('removed from list:', removedItem.text())\n\n    def scanList(self):\n        print('start to scan list\\n')\n        itemList = self.getList()\n        print(itemList)\n        for iMa in itemList:\n            print('start cleaning\\n')\n            print(iMa)\n            maPath = iMa.split('\\t')[-1]\n            DoScanFile(maPath, 1, self.getLogPath(), self.getScanMode(), uiAddVirusCallback=lambda path:self.updateScanned(path))\n            print('finish cleaning\\n')\n\n    def updateScanned(self,filePath):\n        self.fileList.item(self.listDict[filePath]).setText('cleaned\\t'+filePath)\n\n    def scanFuc(self):\n        print('start to scan')\n\n        filePathParam = self.getFilePath()\n        print('scan path is:')\n        print(filePathParam)\n\n        logPathParam = self.getLogPath()\n        if not os.path.isdir(os.path.dirname(logPathParam)):\n            os.makedirs(os.path.dirname(logPathParam))\n        print('log path is:')\n        print(logPathParam)\n        \n        scanModeParam = self.getScanMode()\n        print('scan mode is:')\n        print(scanModeParam)\n\n        cleanStateParam = self.getCleanState()\n        print('clean state is:')\n        print(cleanStateParam)\n\n        walkStateParam = self.getWalkState()\n        print('walk state is:')\n        print(walkStateParam)\n\n        print('start to scan and clean\\n')\n        virusFileList = Scanner_ErrorFile_Main(filePathParam, cleanStateParam, walkStateParam, logPathParam, scanModeParam, \n                                                                uiInfoCallback=lambda info:self.uiInfo(info),\n                                                                uiAddVirusCallback=lambda filePath, clean=cleanStateParam:self.fileList.addItem(('virus\\t' if not clean else 'cleaned\\t')+filePath))\n        print(virusFileList)\n        print('\\n')\n        print('finish scanning and cleaning\\n')\n\n    def uiInfo(self, info):\n        self.infoLabel.setText(info)\n        qw.QApplication.instance().processEvents()\n\n    def show_ui(self):\n\n        self.ui = qw.QWidget()\n        self.ui.resize(800,500)\n        self.ui.setWindowFlags(QtCore.Qt.Window|QtCore.Qt.WindowStaysOnTopHint)\n        self.ui.setWindowTitle(u'Virus Scan Clean')\n\n        topLay = qw.QVBoxLayout()\n        topLay.setContentsMargins(0,0,0,0)\n        self.ui.setLayout(topLay)\n\n        titlebar = qw.QLabel(u'  Hongli Animation    Ver: %s    GUI: %s    '%(__version__, __gui__))\n        titlebar.setStyleSheet('background-color:rgb(16,128,196); color:white; font-size:16px')\n        titlebar.setFixedHeight(30)\n        topLay.addWidget(titlebar)\n\n        mainLay = qw.QVBoxLayout()\n        mainLay.setContentsMargins(10,0,10,10)\n        topLay.addLayout(mainLay)\n\n        \n        inputLabel = qw.QLabel(u'Input Scan Directory:')\n        mainLay.addWidget(inputLabel)\n\n        pathLay = qw.QHBoxLayout()\n        mainLay.addLayout(pathLay)\n\n        self.filePath = qw.QLineEdit()\n        self.filePath.setMinimumWidth(400)\n        pathLay.addWidget(self.filePath)\n\n        viewButton = qw.QPushButton(u'    浏览    ')\n        pathLay.addWidget(viewButton)\n        viewButton.clicked.connect(lambda *args: self.getFileDialogText())\n\n        self.inputPathDir = qw.QFileDialog()\n\n        user = getpass.getuser()\n        pc = platform.node()\n        print('user is: ' + user)\n        print('pc is: ' + pc)\n        print('\\n')\n        defaultLogPath = '//nas/data/PipePrjWork/__UniPipe_Test/PuTianTongQing_logs/%s_%s_virusScan.log' % (user, pc)\n        if not os.path.isdir('//nas/data/PipePrjWork/__UniPipe_Test'):\n            defaultLogPath = tempfile.gettempdir().replace('\\\\','/')+'/PuTianTongQing_logs/%s_%s_virusScan.log' % (user, pc)\n        print('default log path is: ' + defaultLogPath)\n        print('\\n')\n        \n        logLabel = qw.QLabel(u'Scan Log Path:')\n        mainLay.addWidget(logLabel)\n\n        logLay = qw.QHBoxLayout()\n        mainLay.addLayout(logLay)\n\n        self.logPath = qw.QLineEdit()\n        self.logPath.setMinimumWidth(400)\n        logLay.addWidget(self.logPath)\n        self.logPath.setText(defaultLogPath)\n\n        logButton = qw.QPushButton(u'    浏览    ')\n        logLay.addWidget(logButton)\n        logButton.clicked.connect(lambda *args: self.getLogDialogText())\n\n        self.logDir = qw.QFileDialog()\n        self.logDir.setDirectory('//nas/data/PipePrjWork/__UniPipe_Test')\n\n        modeLay = qw.QHBoxLayout()\n        mainLay.addLayout(modeLay)\n        modeLay.addStretch()\n\n        modeLabel = qw.QLabel(u'扫描模式: ')\n        modeLay.addWidget(modeLabel)\n\n        self.modeCB = qw.QComboBox()\n        modeLay.addWidget(self.modeCB)\n        self.modeCB.setEditable(0)\n        self.modeCB.setMinimumWidth(185)\n        self.modeCB.addItem(u'断点扫描')\n        self.modeCB.addItem(u'重新扫描')\n\n        stateLay = qw.QHBoxLayout()\n        mainLay.addLayout(stateLay)\n        stateLay.addStretch()\n\n        self.scanCleanBtn = qw.QCheckBox(u'扫描到病毒直接清除')\n        stateLay.addWidget(self.scanCleanBtn)\n\n        self.scanWalkBtn = qw.QCheckBox(u'包含所有子文件夹')\n        self.scanWalkBtn.setChecked(1)\n        stateLay.addWidget(self.scanWalkBtn)\n\n        confirmLay = qw.QHBoxLayout()\n        mainLay.addLayout(confirmLay)\n\n        self.infoLabel = qw.QLabel('')\n        confirmLay.addWidget(self.infoLabel)\n        confirmLay.addStretch()\n\n        self.scanBtn = qw.QPushButton(u'    扫描文件A    ')\n        self.scanBtn.setStyleSheet('background-color:rgb(20,196,255); color:white; font-size:16px')\n        self.scanBtn.clicked.connect(lambda *args: [self.scanBtn.setEnabled(0), self.scanFuc(), self.scanBtn.setEnabled(1)])\n        confirmLay.addWidget(self.scanBtn)\n        listLabel = qw.QLabel(u'File List:  (可拖入文件或路径来专杀)')\n        mainLay.addWidget(listLabel)\n\n        self.fileList = qw.QListWidget()\n        self.fileList.setMinimumWidth(400)\n        self.fileList.setAcceptDrops(True)\n        self.fileList.setSelectionMode(qw.QAbstractItemView.ExtendedSelection)\n\n        def dragEnterEvent(item, e):\n            e.accept()\n\n        def dragMoveEvent(item, e):\n            e.accept()\n\n        def dropEvent(item, event):\n            event.accept()\n            self.refQuery(event)\n\n        self.fileList.dragEnterEvent = lambda e: dragEnterEvent(self.fileList, e)\n        self.fileList.dragMoveEvent = lambda e: dragMoveEvent(self.fileList, e)\n        self.fileList.dropEvent = lambda e: dropEvent(self.fileList, e)\n\n        mainLay.addWidget(self.fileList)\n\n\n        cleanLay = qw.QHBoxLayout()\n        self.emptyBtn = qw.QPushButton(u'   清除列表中选择文件  ')\n        self.emptyBtn.clicked.connect(lambda *args: self.emptyList())\n        cleanLay.addWidget(self.emptyBtn)\n\n        mainLay.addLayout(cleanLay)\n        cleanLay.addStretch()\n\n        self.cleanBtn = qw.QPushButton(u'      扫描列表并清除      ')\n        self.cleanBtn.setStyleSheet('background-color:rgb(20,196,255); color:white; font-size:16px')\n        self.cleanBtn.clicked.connect(\n            lambda *args: [self.cleanBtn.setEnabled(0), self.scanList(), self.cleanBtn.setEnabled(1)])\n        cleanLay.addWidget(self.cleanBtn)\n\n        self.ui.show()\n# endregion gui\n\nif __name__ == '__main__':\n    app = qw.QApplication([]) if not qw.QApplication.instance() else None\n    VirusOp()\n    app.exec_() if app else None" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "#coding:utf-8\nu'''\n#################################\n#\n#  HolyPi..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "pythonFamily.png" 
        -image1 "pythonFamily.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "#coding:utf-8\nu'''\n#################################\n#\n#  HolyPipe 红鲸影视 版权所有\n#\n#################################\n\n红鲤动画|红鲸影视 的“普天同庆”Maya病毒 查杀工具。\n针对.ma文件进行批量查杀。\n请从红鲤动画官网下载本代码的最新版本运行\nhttp://www.honglianimation.com/res/pttq.zip\n\n此工具更详细的说明，请见红鲤动画公众号文章：\nhttps://mp.weixin.qq.com/s/0Wxru1Flyxn2XRwofETM5A\n'''\n\n__version__ = '20200623.0'\n\nimport sys, os, subprocess, json,time,datetime, glob, tempfile\nimport getpass, platform\nimport shutil\nfrom stat import ST_ATIME,ST_CTIME,ST_MTIME\n__gui__ = 'missing'\ntry:\n    from PySide2 import QtWidgets as qw,  QtCore\n    __gui__ = 'PySide2'\nexcept:\n    from PySide import QtGui as qw, QtCore\n    __gui__ = 'PySide'\n\n\n#region scan core\n#directory 需要扫描的路径//nas/data/PipePrjWork/putiantongqing/最后以斜线结尾\n#tryFix 1是修复，0是不修复\n#recursion 1是递归，0是不递归\n#logPath 扫描\"//nas/data/PipePrjWork/putiantongqing/pan_yao.txt\"\n#skipLog 0是断点续扫，1是重新扫描\ndef Scanner_ErrorFile_Main(directory,tryFix,recursion,logPath,skipLog, \n                                                uiInfoCallback=lambda info:None, \n                                                uiAddVirusCallback=lambda filePath:None):\n    #若重新扫描，删掉log，后改为不删log\n    #if skipLog == 1 and os.path.isfile(logPath):\n    #    os.remove(logPath)\n    timeNow = datetime.datetime.now()\n    timeNowStr = timeNow.strftime(\"%Y-%m-%d %H:%M:%S\")\n    writeLog(logPath,timeNowStr+',scann Folder Path:'+directory+'\\n')\n    allMa = []\n    errFileList = []\n    if recursion:#递归扫描文件夹里的所有ma，并直接扫描，以免服务器根目录递归过程报错无法断点续扫\n        ScanFilesFromFolder(directory,logPath,skipLog,prefix=None,postfix='.ma',  tryFix=tryFix,\n                                    uiInfoCallback=uiInfoCallback,\n                                    uiAddVirusCallback=uiAddVirusCallback)\n    else:#非递归扫描文件夹里的所有ma\n        getAllFile = os.listdir(directory)\n        #断点续扫，读取log里记录的扫过的文件路径信息\n        logInfo = ''\n        if skipLog == 0 and os.path.isfile(logPath):\n            f = open(logPath,'r')\n            logInfo = f.read()\n            f.close()\n        for mm in getAllFile:\n            #若扫描过，则跳过\n            if skipLog == 0 and logInfo and logInfo.count(directory+mm):\n                print(directory+mm+' is already scann\\n')\n                continue\n            if mm.endswith('.ma'):\n                allMa.append(directory+mm)\n        #根据扫描出来的ma文件列表，进行下一步处理\n        for i,mm in enumerate(allMa):\n            uiInfoCallback('scaning (%i/%i): %s'%(i, len(allMa), mm))\n            isErrorFile = DoScanFile(mm,tryFix,logPath,skipLog)\n            if isErrorFile:\n                errFileList.append(mm)\n                uiAddVirusCallback(mm)\n        return errFileList\n\ndef ScanFilesFromFolder(directory,logPath,skipLog,prefix=None,postfix=None, \n                                        uiInfoCallback=lambda info:None, \n                                        uiAddVirusCallback=lambda filePath:None,\n                                        tryFix=False):\n    files_list=[]\n    #logInfo = ''\n    #断点续扫，读取log里记录的扫过的文件信息\n    #log文件记录方式：True d:/.../aa.ma    tryFix  202006221500    1024L\n    fileInLogDic = {}\n    alreadyExaminFiles = []\n    if skipLog == 0 and os.path.isfile(logPath):\n        f = open(logPath,'r')\n        lines = f.readlines()\n        f.close()\n        for mm in range(len(lines)):\n            getLineInfo = lines[mm].decode('utf-8').strip().split('\\t')\n            if len(getLineInfo) == 5:\n                fileInLogDic[getLineInfo[2]] = {'virus':getLineInfo[0],'killed':getLineInfo[1],'mtime':getLineInfo[3],'size':getLineInfo[4]}\n        alreadyExaminFiles = fileInLogDic.keys()\n\n    def appendScanFile(filePath):\n        files_list.append(filePath)\n        uiInfoCallback('scaning (%i): %s'%(len(files_list),  filePath))\n        isErrorFile = DoScanFile(filePath,tryFix,logPath,skipLog, uiAddVirusCallback=uiAddVirusCallback)\n\n    for root, sub_dirs, files in os.walk(directory):\n        uiInfoCallback('gathering files (%i): '% len(files_list)+root+'\\\\')\n        for special_file in files:\n            if not special_file.lower().endswith('.ma'):\n                continue\n            uiInfoCallback('gathering files (%i): '% len(files_list)+os.path.join(root,special_file) )\n            if postfix:\n                if special_file.endswith(postfix):\n                    if alreadyExaminFiles:#非第一次扫描\n                        if alreadyExaminFiles.count(os.path.join(root,special_file)):#文件被扫描过\n                            if time.strftime(\"%Y%m%d%H%M%S\",time.localtime(os.path.getmtime(os.path.join(root,special_file)))) == fileInLogDic.get(os.path.join(root,special_file)).get('mtime'):#文件修改时间和log里记录的上次扫描时的修改时间一致，即本次扫描和上次扫描比，文件没有改动\n                                if fileInLogDic.get(os.path.join(root,special_file)).get('virus') == 'True' and fileInLogDic.get(os.path.join(root,special_file)).get('killed') == 'False':#上次有毒，且只扫没杀，需要重新扫描并杀毒\n                                    appendScanFile(os.path.join(root,special_file))\n                                else:\n                                    continue\n                            else:#虽文件扫描过，但文件有修改，需要重新扫描\n                                appendScanFile(os.path.join(root,special_file))\n                        else:#文件没有被扫描过\n                            appendScanFile(os.path.join(root,special_file))\n                    else:#第一次扫描\n                        appendScanFile(os.path.join(root,special_file))\n            elif prefix:\n                if special_file.startswith(prefix):\n                    if alreadyExaminFiles:#非第一次扫描\n                        if alreadyExaminFiles.count(os.path.join(root,special_file)):#文件被扫描过\n                            if time.strftime(\"%Y%m%d%H%M%S\",time.localtime(os.path.getmtime(os.path.join(root,special_file)))) == fileInLogDic.get(os.path.join(root,special_file)).get('mtime'):#文件修改时间和log里记录的上次扫描时的修改时间一致，即本次扫描和上次扫描比，文件没有改动\n                                if fileInLogDic.get(os.path.join(root,special_file)).get('virus') == 'True' and fileInLogDic.get(os.path.join(root,special_file)).get('killed') == 'False':#上次有毒，且只扫没杀，需要重新扫描并杀毒\n                                    appendScanFile(os.path.join(root,special_file))\n                                else:\n                                    continue\n                            else:#虽文件扫描过，但文件有修改，需要重新扫描\n                                appendScanFile(os.path.join(root,special_file))\n                        else:#文件没有被扫描过\n                            appendScanFile(os.path.join(root,special_file))\n                    else:#第一次扫描\n                        appendScanFile(os.path.join(root,special_file))\n            else:\n                #若扫描过，则跳过\n                if skipLog == 0 and alreadyExaminFiles and alreadyExaminFiles.count(os.path.join(root,special_file)):\n                    print(os.path.join(root,special_file)+' is already scanned\\n')\n                    continue\n                appendScanFile(os.path.join(root,special_file))\n                if alreadyExaminFiles:#非第一次扫描\n                    if alreadyExaminFiles.count(os.path.join(root,special_file)):#文件被扫描过\n                        if time.strftime(\"%Y%m%d%H%M%S\",time.localtime(os.path.getmtime(os.path.join(root,special_file)))) == fileInLogDic.get(os.path.join(root,special_file)).get('mtime'):#文件修改时间和log里记录的上次扫描时的修改时间一致，即本次扫描和上次扫描比，文件没有改动\n                            if fileInLogDic.get(os.path.join(root,special_file)).get('killed') == False and tryFix:#上次只扫没杀，本次若需要杀毒，需要重新扫描并杀毒\n                                appendScanFile(os.path.join(root,special_file))\n                            else:\n                                continue\n                        else:#虽文件扫描过，但文件有修改，需要重新扫描\n                            appendScanFile(os.path.join(root,special_file))\n                    else:#文件没有被扫描过\n                        appendScanFile(os.path.join(root,special_file))\n                else:#第一次扫描\n                    appendScanFile(os.path.join(root,special_file))\n    return files_list\n\ndef DoScanFile(maPath,tryFix,logPath,skipLog, uiAddVirusCallback=lambda filePath:None):\n    try:\n        print('scanning: %s'%maPath)\n        maPath = LongLongFile(maPath)\n        errFile = 0\n        f = open(maPath,'r')\n        lines = f.readlines()\n        lenLines = len(lines)\n        errLine = []\n        for mm in range(lenLines):\n            if lines[mm].count('createNode script -n \"'):\n                #fopen  fprint  fclose同时出现，判断为带毒\n                isFopen = 0\n                isFprint = 0\n                isFclose = 0\n                #print '-------------start---------------'\n                errLine.append(mm)\n                tt = mm + 1\n                while not lines[tt].startswith('createNode ') and not lines[tt].startswith('select ') and not lines[tt].startswith('select ') and not lines[tt].startswith('connectAttr ') :\n                    isError = IsHaveKeyword(lines[tt])\n                    if isError:\n                        errFile = 1\n                    if lines[tt].count('fopen'):\n                        isFopen = 1\n                    if lines[tt].count('fprint'):\n                        isFprint = 1\n                    if lines[tt].count('fclose'):\n                        isFclose = 1\n                    errLine.append(tt)\n                    tt = tt + 1\n                    if tt>=lenLines:\n                        break\n                if errFile == 0:\n                    if isFopen == 1 and isFprint == 1 and isFclose == 1:\n                        print('have fopen  fprint  fclose')\n                        errFile = 1\n        f.close()\n        if tryFix and errFile:\n            if errLine:\n                #修复前先备份为后缀.putiantongqing\n                copyFrom = maPath\n                copyTo = maPath+'.putiantongqing'\n                shutil.copy(copyFrom,copyTo)\n                file_stat = os.stat(copyFrom)\n                os.utime(copyTo, (file_stat[ST_CTIME], file_stat[ST_MTIME]))\n                #os.remove(maPath)\n                with open(maPath, \"w\",) as f:\n                    for mm in range(len(lines)):\n                        if errLine.count(mm):\n                            continue\n                        else:\n                            f.write(lines[mm])\n                f.close()\n        #写入log\n        #获取ma文件的修改时间和大小，写入log\n        tryFixInfo = 'False'\n        if tryFix:\n            tryFixInfo = 'True'\n        mTime= time.strftime(\"%Y%m%d%H%M%S\",time.localtime(os.path.getmtime(maPath)))\n        fileSize = os.path.getsize(maPath)\n        if errFile:\n            writeLog(logPath,'True\\t'+tryFixInfo+'\\t'+maPath+'\\t'+str(mTime)+'\\t'+str(fileSize)+'\\n')\n        else:\n            writeLog(logPath,'False\\t'+tryFixInfo+'\\t'+maPath+'\\t'+str(mTime)+'\\t'+str(fileSize)+'\\n')\n        if errFile:\n            uiAddVirusCallback(maPath)\n        return errFile\n    except:\n        message = traceException(makeError=0)\n        writeLog(logPath+'.except',maPath+'\\n'+message+'\\n')\n\ndef IsHaveKeyword(lineInfo):\n    keyWord = ['UI_Mel_Configuration_think',\n                   'UI_Mel_Configuration_think_a',\n                   'UI_Mel_Configuration_think_b',\n                   'autoUpdateAttrEd_SelectSystem',\n                   'autoUpdatcAttrEd',\n                   'autoUpdatoAttrEnd',\n                   'fuck_All_U',\n                   '$PuTianTongQing']\n    for mm in keyWord:\n        if lineInfo.count(mm):\n            return 1\n    return 0\n\ndef writeLog(logPath,infoStr):\n    f = open(logPath, 'a')\n    f.write(infoStr.encode('utf-8'))\n    f.close()\n\ndef LongLongFile(result):\n    if len(result)>=260:\n        if result[2:3]!='?':\n            if result[:2] in ['\\\\\\\\','//']:\n                result = r'\\\\?\\UNC\\%s'%result[2:].replace('/','\\\\')\n            else:\n                result = r'\\\\?\\%s'%result.replace('/','\\\\')\n        else:\n            result = result.replace('/','\\\\')\n    return result\n\ndef traceException(makeError=0):\n    import traceback, StringIO\n    fp = StringIO.StringIO()\n    traceback.print_exc(file=fp)\n    message = fp.getvalue()\n    if message.split('\\n')[-2][0:len('SystemExit')] != 'SystemExit':\n        if makeError:\n            raise RuntimeError, message\n            pass\n        else:\n            print(message)\n            return message\n# endregion scan core\n\n# region gui\nclass VirusOp():\n    def __init__(self):\n        self.closeExistingWindow()\n        self.show_ui()\n\n    def closeExistingWindow(self):\n        for qt in qw.QApplication.topLevelWidgets():\n            try:\n                if qt.windowTitle() == u'Virus Scan Clean':\n                    qt.close()\n            except:\n                pass\n\n    def getFileDialogText(self):\n        scanPath = self.inputPathDir.getExistingDirectory()\n        self.filePath.setText(scanPath)\n\n    def getLogDialogText(self):\n        savePath = self.logDir.getOpenFileName()\n        self.logPath.setText(savePath)\n\n    def getFilePath(self):\n        curFilePath = self.filePath.text()\n        print('scan path is:')\n        print(curFilePath)\n        print('\\n')\n        return curFilePath + '\\\\'\n\n    def getLogPath(self):\n        curLogPath = self.logPath.text()\n        print('log path is:')\n        print(curLogPath)\n        print('\\n')\n        return curLogPath\n\n    def getScanMode(self):\n        curMode = self.modeCB.currentText()\n        print('scan mode is:')\n        print(curMode)\n        scanMode = 0\n        if curMode == u'重新扫描':\n            scanMode = 1\n        if curMode == u'断点扫描':\n            scanMode = 0\n        print(scanMode)\n        print('\\n')\n        return scanMode\n\n    def getCleanState(self):\n        curState = self.scanCleanBtn.checkState()\n        print('clean state is:')\n        print(curState)\n        cleanState = 0\n        if curState == 0:\n            cleanState = 0\n        else:\n            cleanState = 1\n        print(cleanState)\n        print('\\n')\n        return cleanState\n\n    def getWalkState(self):\n        curState = self.scanWalkBtn.checkState()\n        print('walk state is:')\n        print(curState)\n        walkState = 0\n        if curState == 0:\n            walkState = 0\n        else:\n            walkState = 1\n        print(walkState)\n        print('\\n')\n        return walkState\n\n    def addList(self, virusList):\n        scanModeParam = self.getScanMode()\n        if scanModeParam:\n            self.fileList.clear()\n        for iFile in virusList:\n            self.fileList.addItem(iFile)\n        print('finish adding\\n')\n\n    def getRefState(self, event):\n        refState = 0\n        if self.refBtn1.isChecked():\n            refState = 0\n        if self.refBtn2.isChecked():\n            refState = 1\n        if self.refBtn3.isChecked():\n            refState = 2\n        self.query.close()\n\n        subPaths = []\n        if event.mimeData().hasUrls():\n            event.setDropAction(QtCore.Qt.LinkAction)\n            event.accept()\n            for url in event.mimeData().urls():\n                filePath = unicode(url.toLocalFile())\n                print(filePath)\n                if os.path.isfile(filePath) and filePath.lower().endswith('.ma'):\n                    subPaths.extend([filePath])\n                elif os.path.isdir(filePath):\n                    subPaths.extend([x for x in glob.glob(filePath+'/*') if os.path.isfile(x) and x.lower().endswith('.ma')])\n        elif event.mimeData().hasText():\n            event.setDropAction(QtCore.Qt.LinkAction)\n            event.accept()\n            for text in event.mimeData().text().splitlines():\n                # filePath = text.split('\\t')[-1].replace('\"','')\n                for iPart in text.split('\\t'):\n                    tempPath = iPart.replace('\"','')\n                    if os.path.isfile(tempPath) and tempPath.lower().endswith('.ma'):\n                        subPaths.extend([tempPath])\n                    elif os.path.isdir(tempPath):\n                        subPaths.extend([x for x in glob.glob(tempPath+'/*') if os.path.isfile(x) and x.lower().endswith('.ma')])\n        \n        def recursiveGetRef(fileName, outList=[], cacheDict={}, recursive=True):\n            fileName = os.path.expandvars(fileName).replace('\\\\', '/')\n            if not os.path.isfile(fileName):\n                return\n            if fileName not in cacheDict:\n                cacheDict[fileName] = 1\n                outList.append(fileName)\n                self.fileList.addItem('\\t'+fileName)\n                qw.QApplication.instance().processEvents()\n            curFile = open(u'%s' % fileName, 'rb')\n            curLine = curFile.readline()\n            while curLine:\n                while not curLine.strip().endswith(';'):\n                    curLine += curFile.readline()\n                if 'file -rdi ' in curLine and '.ma' in curLine:\n                    maPath = os.path.expandvars(curLine.split('\\\"')[-2]).replace('\\\\', '/')\n                    if not os.path.isfile(maPath):\n                        maPath = os.path.dirname(fileName)+'/'+os.path.basename(maPath)\n                    if not os.path.isfile(maPath):\n                        print('Referenc path not accessable: %s'%maPath)\n                        curLine = curFile.readline()\n                        continue\n                    if maPath not in cacheDict:\n                        recursiveGetRef(maPath, outList=outList, cacheDict=cacheDict, recursive=True) if recursive else None\n                if 'file -r ' in curLine and '.ma' in curLine:\n                    maPath = os.path.expandvars(curLine.split('\\\"')[-2]).replace('\\\\', '/')\n                    if not os.path.isfile(maPath):\n                        maPath = os.path.dirname(fileName)+'/'+os.path.basename(maPath)\n                    if not os.path.isfile(maPath):\n                        curLine = curFile.readline()\n                        print('Referenc path not accessable: %s'%maPath)\n                        continue\n                    \n                    if maPath not in cacheDict:\n                        recursiveGetRef(maPath, outList=outList, cacheDict=cacheDict, recursive=True) if recursive else None\n\n                if 'requires ' in curLine:\n                    break\n                curLine = curFile.readline()\n            curFile.close()\n\n        listedPathCache = {}\n        if refState == 0:\n            for iSubPath in sorted(list(set(subPaths))):\n                self.fileList.addItem('\\t'+iSubPath)\n                listedPathCache[iSubPath.split('\\t')[-1].replace('\\\\','/')] = 1\n\n        if refState == 1:\n            print(u'one')\n            for i, iSubPath in enumerate(subPaths):\n                recursiveGetRef(iSubPath, outList=subPaths, cacheDict=listedPathCache, recursive=False)\n\n        if refState == 2:\n            print(u'all')\n            for i, iSubPath in enumerate(subPaths):\n                recursiveGetRef(iSubPath, outList=subPaths, cacheDict=listedPathCache, recursive=True)\n\n\n    def refQuery(self, event):\n\n        self.query = qw.QDialog()\n        self.query.setWindowFlags(QtCore.Qt.Window|QtCore.Qt.WindowStaysOnTopHint)\n        self.query.setWindowTitle('Query')\n\n        vLay = qw.QVBoxLayout()\n        self.query.setLayout(vLay)\n\n        scanLabel = qw.QLabel(u'扫描Maya文件中的Reference')\n        vLay.addWidget(scanLabel)\n\n        hLay = qw.QHBoxLayout()\n        vLay.addLayout(hLay)\n\n        self.refBtn1 = qw.QRadioButton(u'不包括Ref')\n        self.refBtn1.setChecked(1)\n        hLay.addWidget(self.refBtn1)\n\n        self.refBtn2 = qw.QRadioButton(u'包括一层Ref')\n        hLay.addWidget(self.refBtn2)\n\n        self.refBtn3 = qw.QRadioButton(u'包含所有Ref')\n        hLay.addWidget(self.refBtn3)\n\n        hLayRecovery = qw.QHBoxLayout()\n        vLay.addLayout(hLayRecovery)\n        hLayRecovery.addStretch()\n\n        recoveryButton = qw.QPushButton(u'   确定   ')\n        recoveryButton.clicked.connect(lambda a=1,e=event: self.getRefState(e))\n        hLayRecovery.addWidget(recoveryButton)\n\n        vLay.addStretch()\n        self.query.exec_()\n\n    def getList(self):\n        itemNum = self.fileList.count()\n        itemList = []\n        self.listDict = {}\n        for i in range(itemNum):\n            curItem = self.fileList.item(i)\n            curItemName = curItem.text()\n            itemList.append(curItemName)\n            self.listDict[curItemName.split('\\t')[-1]] = i\n            print(curItemName)\n        print(itemList)\n        return itemList\n\n    def emptyList(self):\n        removeList = self.fileList.selectedItems()\n        rows = sorted([self.fileList.row(item) for item in removeList])[::-1]\n        for row in rows:\n            removedItem = self.fileList.takeItem(row)\n            print('removed from list:', removedItem.text())\n\n    def scanList(self):\n        print('start to scan list\\n')\n        itemList = self.getList()\n        print(itemList)\n        for iMa in itemList:\n            print('start cleaning\\n')\n            print(iMa)\n            maPath = iMa.split('\\t')[-1]\n            DoScanFile(maPath, 1, self.getLogPath(), self.getScanMode(), uiAddVirusCallback=lambda path:self.updateScanned(path))\n            print('finish cleaning\\n')\n\n    def updateScanned(self,filePath):\n        self.fileList.item(self.listDict[filePath]).setText('cleaned\\t'+filePath)\n\n    def scanFuc(self):\n        print('start to scan')\n\n        filePathParam = self.getFilePath()\n        print('scan path is:')\n        print(filePathParam)\n\n        logPathParam = self.getLogPath()\n        if not os.path.isdir(os.path.dirname(logPathParam)):\n            os.makedirs(os.path.dirname(logPathParam))\n        print('log path is:')\n        print(logPathParam)\n        \n        scanModeParam = self.getScanMode()\n        print('scan mode is:')\n        print(scanModeParam)\n\n        cleanStateParam = self.getCleanState()\n        print('clean state is:')\n        print(cleanStateParam)\n\n        walkStateParam = self.getWalkState()\n        print('walk state is:')\n        print(walkStateParam)\n\n        print('start to scan and clean\\n')\n        virusFileList = Scanner_ErrorFile_Main(filePathParam, cleanStateParam, walkStateParam, logPathParam, scanModeParam, \n                                                                uiInfoCallback=lambda info:self.uiInfo(info),\n                                                                uiAddVirusCallback=lambda filePath, clean=cleanStateParam:self.fileList.addItem(('virus\\t' if not clean else 'cleaned\\t')+filePath))\n        print(virusFileList)\n        print('\\n')\n        print('finish scanning and cleaning\\n')\n\n    def uiInfo(self, info):\n        self.infoLabel.setText(info)\n        qw.QApplication.instance().processEvents()\n\n    def show_ui(self):\n\n        self.ui = qw.QWidget()\n        self.ui.resize(800,500)\n        self.ui.setWindowFlags(QtCore.Qt.Window|QtCore.Qt.WindowStaysOnTopHint)\n        self.ui.setWindowTitle(u'Virus Scan Clean')\n\n        topLay = qw.QVBoxLayout()\n        topLay.setContentsMargins(0,0,0,0)\n        self.ui.setLayout(topLay)\n\n        titlebar = qw.QLabel(u'  Hongli Animation    Ver: %s    GUI: %s    '%(__version__, __gui__))\n        titlebar.setStyleSheet('background-color:rgb(16,128,196); color:white; font-size:16px')\n        titlebar.setFixedHeight(30)\n        topLay.addWidget(titlebar)\n\n        mainLay = qw.QVBoxLayout()\n        mainLay.setContentsMargins(10,0,10,10)\n        topLay.addLayout(mainLay)\n\n        \n        inputLabel = qw.QLabel(u'Input Scan Directory:')\n        mainLay.addWidget(inputLabel)\n\n        pathLay = qw.QHBoxLayout()\n        mainLay.addLayout(pathLay)\n\n        self.filePath = qw.QLineEdit()\n        self.filePath.setMinimumWidth(400)\n        pathLay.addWidget(self.filePath)\n\n        viewButton = qw.QPushButton(u'    浏览    ')\n        pathLay.addWidget(viewButton)\n        viewButton.clicked.connect(lambda *args: self.getFileDialogText())\n\n        self.inputPathDir = qw.QFileDialog()\n\n        user = getpass.getuser()\n        pc = platform.node()\n        print('user is: ' + user)\n        print('pc is: ' + pc)\n        print('\\n')\n        defaultLogPath = '//nas/data/PipePrjWork/__UniPipe_Test/PuTianTongQing_logs/%s_%s_virusScan.log' % (user, pc)\n        if not os.path.isdir('//nas/data/PipePrjWork/__UniPipe_Test'):\n            defaultLogPath = tempfile.gettempdir().replace('\\\\','/')+'/PuTianTongQing_logs/%s_%s_virusScan.log' % (user, pc)\n        print('default log path is: ' + defaultLogPath)\n        print('\\n')\n        \n        logLabel = qw.QLabel(u'Scan Log Path:')\n        mainLay.addWidget(logLabel)\n\n        logLay = qw.QHBoxLayout()\n        mainLay.addLayout(logLay)\n\n        self.logPath = qw.QLineEdit()\n        self.logPath.setMinimumWidth(400)\n        logLay.addWidget(self.logPath)\n        self.logPath.setText(defaultLogPath)\n\n        logButton = qw.QPushButton(u'    浏览    ')\n        logLay.addWidget(logButton)\n        logButton.clicked.connect(lambda *args: self.getLogDialogText())\n\n        self.logDir = qw.QFileDialog()\n        self.logDir.setDirectory('//nas/data/PipePrjWork/__UniPipe_Test')\n\n        modeLay = qw.QHBoxLayout()\n        mainLay.addLayout(modeLay)\n        modeLay.addStretch()\n\n        modeLabel = qw.QLabel(u'扫描模式: ')\n        modeLay.addWidget(modeLabel)\n\n        self.modeCB = qw.QComboBox()\n        modeLay.addWidget(self.modeCB)\n        self.modeCB.setEditable(0)\n        self.modeCB.setMinimumWidth(185)\n        self.modeCB.addItem(u'断点扫描')\n        self.modeCB.addItem(u'重新扫描')\n\n        stateLay = qw.QHBoxLayout()\n        mainLay.addLayout(stateLay)\n        stateLay.addStretch()\n\n        self.scanCleanBtn = qw.QCheckBox(u'扫描到病毒直接清除')\n        stateLay.addWidget(self.scanCleanBtn)\n\n        self.scanWalkBtn = qw.QCheckBox(u'包含所有子文件夹')\n        self.scanWalkBtn.setChecked(1)\n        stateLay.addWidget(self.scanWalkBtn)\n\n        confirmLay = qw.QHBoxLayout()\n        mainLay.addLayout(confirmLay)\n\n        self.infoLabel = qw.QLabel('')\n        confirmLay.addWidget(self.infoLabel)\n        confirmLay.addStretch()\n\n        self.scanBtn = qw.QPushButton(u'    扫描文件A    ')\n        self.scanBtn.setStyleSheet('background-color:rgb(20,196,255); color:white; font-size:16px')\n        self.scanBtn.clicked.connect(lambda *args: [self.scanBtn.setEnabled(0), self.scanFuc(), self.scanBtn.setEnabled(1)])\n        confirmLay.addWidget(self.scanBtn)\n        listLabel = qw.QLabel(u'File List:  (可拖入文件或路径来专杀)')\n        mainLay.addWidget(listLabel)\n\n        self.fileList = qw.QListWidget()\n        self.fileList.setMinimumWidth(400)\n        self.fileList.setAcceptDrops(True)\n        self.fileList.setSelectionMode(qw.QAbstractItemView.ExtendedSelection)\n\n        def dragEnterEvent(item, e):\n            e.accept()\n\n        def dragMoveEvent(item, e):\n            e.accept()\n\n        def dropEvent(item, event):\n            event.accept()\n            self.refQuery(event)\n\n        self.fileList.dragEnterEvent = lambda e: dragEnterEvent(self.fileList, e)\n        self.fileList.dragMoveEvent = lambda e: dragMoveEvent(self.fileList, e)\n        self.fileList.dropEvent = lambda e: dropEvent(self.fileList, e)\n\n        mainLay.addWidget(self.fileList)\n\n\n        cleanLay = qw.QHBoxLayout()\n        self.emptyBtn = qw.QPushButton(u'   清除列表中选择文件  ')\n        self.emptyBtn.clicked.connect(lambda *args: self.emptyList())\n        cleanLay.addWidget(self.emptyBtn)\n\n        mainLay.addLayout(cleanLay)\n        cleanLay.addStretch()\n\n        self.cleanBtn = qw.QPushButton(u'      扫描列表并清除      ')\n        self.cleanBtn.setStyleSheet('background-color:rgb(20,196,255); color:white; font-size:16px')\n        self.cleanBtn.clicked.connect(\n            lambda *args: [self.cleanBtn.setEnabled(0), self.scanList(), self.cleanBtn.setEnabled(1)])\n        cleanLay.addWidget(self.cleanBtn)\n\n        self.ui.show()\n# endregion gui\n\nif __name__ == '__main__':\n    app = qw.QApplication([]) if not qw.QApplication.instance() else None\n    VirusOp()\n    app.exec_() if app else None" 
        -sourceType "python" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "import maya.cmds as mc\nsel=mc.ls(sl=1)\nRo = '.rotate'\nTs = '.tra..." 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "import maya.cmds as mc\nsel=mc.ls(sl=1)\nRo = '.rotate'\nTs = '.tra..." 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "Mov2" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "pythonFamily.png" 
        -image1 "pythonFamily.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "import maya.cmds as mc\nsel=mc.ls(sl=1)\nRo = '.rotate'\nTs = '.translate'\nTR = ['X','Y','Z']\npc = []\nloc= mc.spaceLocator()[0]\nfor obj in sel:\n    Tran_xform = mc.xform(sel[0],q=True,translation=1)\n    Rota_xform = mc.xform(sel[0],q=True,rotation=1)\n    for Getts in range(0,3):\n        mc.setAttr(loc+Ts+TR[Getts],Tran_xform[Getts])\n    for Getro in range(0,3):\n        mc.setAttr(loc+Ro+TR[Getro],Rota_xform[Getro])\n    Parent_Con = mc.parentConstraint(loc,obj,mo=True)\n    pc.append (Parent_Con)\n    \nfor Getts in range(0,3):\n    mc.setAttr(loc+Ts+TR[Getts],0)\nfor Getro in range(0,3):\n    mc.setAttr(loc+Ro+TR[Getro],0)\nfor par in pc:\n    mc.delete(par)\nmc.delete(loc)" 
        -sourceType "python" 
        -commandRepeatable 1
        -flat 1
    ;
    shelfButton
        -enableCommandRepeat 1
        -flexibleWidthType 3
        -flexibleWidthValue 32
        -enable 1
        -width 35
        -height 34
        -manage 1
        -visible 1
        -preventOverride 0
        -annotation "fixRenderLayerOutAdjustmentErrors" 
        -enableBackground 0
        -backgroundColor 0 0 0 
        -highlightColor 0.321569 0.521569 0.65098 
        -align "center" 
        -label "fixRenderLayerOutAdjustmentErrors" 
        -labelOffset 0
        -rotation 0
        -flipX 0
        -flipY 0
        -useAlpha 1
        -font "plainLabelFont" 
        -imageOverlayLabel "FixLayer" 
        -overlayLabelColor 0.8 0.8 0.8 
        -overlayLabelBackColor 0 0 0 0.5 
        -image "commandButton.png" 
        -image1 "commandButton.png" 
        -style "iconOnly" 
        -marginWidth 1
        -marginHeight 1
        -command "fixRenderLayerOutAdjustmentErrors" 
        -sourceType "mel" 
        -commandRepeatable 1
        -flat 1
    ;

} 
